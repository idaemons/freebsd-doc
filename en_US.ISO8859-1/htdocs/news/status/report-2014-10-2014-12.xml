<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE report PUBLIC "-//FreeBSD//DTD FreeBSD XML Database for
  Status Report//EN"
  "http://www.FreeBSD.org/XML/share/xml/statusreport.dtd" >

<!-- $FreeBSD$ -->

<report>
  <date>
    <month>July-September</month>

    <year>2014</year>
  </date>

  <section>
    <title>Introduction</title>

<!-- <?ignore -->
    <p><strong>This is a draft of the October&ndash;December 2014 status
	report.	 Please check back after it is finalized, and an
	announcement email is sent to the &os;-Announce mailing
	list.</strong></p>
<!-- ?> -->

    <p>This report covers &os;-related projects between October and
      December 2014.  This is the last of four reports planned for
      2014.</p>

    <p>The fourth quarter of 2014... was a very busy and productive
      time</p>

    <p>Thanks to all the reporters for the excellent work!</p>

    <p>The deadline for submissions covering the period from January
      to March 2015 is April 7th, 2015.</p>
  </section>

  <category>
    <name>team</name>

    <description>&os; Team Reports</description>
  </category>

  <category>
    <name>proj</name>

    <description>Projects</description>
  </category>

  <category>
    <name>kern</name>

    <description>Kernel</description>
  </category>

  <category>
    <name>arch</name>

    <description>Architectures</description>
  </category>

  <?ignore
  <category>
    <name>bin</name>

    <description>Userland Programs</description>
  </category>
  ?>

  <category>
    <name>ports</name>

    <description>Ports</description>
  </category>

  <category>
    <name>doc</name>

    <description>Documentation</description>
  </category>

  <category>
    <name>misc</name>

    <description>Miscellaneous</description>
  </category>

  <project cat='misc'>
    <title>&os; Forum Software Migration</title>

    <contact>
      <person>
	<name>&os; Forums Administration Team</name>
	<email>forum-admins@</email>
      </person>
    </contact>

    <body>
      <p>With funding from the &os; Foundation, the &os; forums
	were migrated to XenForo software.  The new software is far more
	capable and easy to use.  While the entire forum team
	contributed, &a.danger; did a particularly excellent job
	importing existing users and messages and bringing back the
	often-requested "Thanks" feature.  The upgrade was completed in
	time to be ready for the influx of new users from the release of
	&os; 10.1, and we have already seen an increase in usage.</p>

      <p>Developers with an @FreeBSD.org address can contact forum
	administrators to obtain the highly-desired "@"	suffix on their
	forum user name along with a Developer flag.</p>

      <p>We want to thank the Foundation for making this possible, and
	the users for their patience and continued presence on the
	forums!</p>
    </body>

    <sponsor>
      The &os; Foundation
    </sponsor>

    <help>
      <task>
 	<p>Encourage more developers and users to try the new forums.</p>
      </task>

      <task>
	<p>Continue getting feedback from users for tuning and
	  improvements.</p>
      </task>
    </help>
  </project>

  <project cat='kern'>
    <title>Process management</title>

    <contact>
      <person>
	<name>
	  <given>Konstantin</given>
	  <common>Belousov</common>
	</name>
	<email>kib@FreeBSD.org</email>
      </person>
      <person>
	<name>
	  <given>Peter</given>
	  <common>Holm</common>
	</name>
	<email>pho@FreeBSD.org</email>
      </person>
    </contact>

    <body>
      <p>There were several improvements made to the FreeBSD process
	management last quarter.</p>

      <p>Reaper. The facility to allow a process to reliably track the
	running and exiting state of the whole subtree of the processes,
	was added.  It is intended to improve tools like timeout(1) or
	poudriere, by making it impossible for the runaway granchild to
	escape the controlling process.  Feature was designed based on
	similar facility in the DragonFlyBSD and Linux, with some
	references to the Solaris contracts.  Committed to HEAD in
	r275800.</p>

      <p>Total stop.  Right now, the FreeBSD suspension code does not
	ensures that the system, both from software and from hardware
	view, is in the steady and consistent state.  One aspect is the
	usermode process activity which is not stopped, continuing to
	making requests to the hardware.  It is not realistic to expect
	drivers to be able to correctly handle the calls after
	SUSPEND_CHILD.</p>

      <p>Together with Peter Holm, we developed a facility to stop
	usermode threads at the safe points, where they are known to not
	own and to not wait for kernel resources, in particular, not
	waiting for device requests finishing.  It is based on the
	existing single-threading code, but extending it to allow external
	thread to put some process into stopped state.  Also, a facility
	to sync filesystems before suspend was added, to ensure that
	consistent metadata and as much as possilbe of the cached user
	data are on stable storage, to minimize damage of failed
	resume.</p>

      <p>The code stressed some parts of the system and lead to
	discovery of the unusual numbers of bugs in the different parts of
	the system, including process management, buffer cache and syscall
	handlers.  The bugs were fixed, fixes and the features commmitted
	by a series culminating in r275745.</p>

      <p>Process spinlock changes. During the work described above, it
	was noted that process spinlock duties are significantly
	overloaded (the same is true for the process lock).  The spinlock
	was split into per-feature lock, see r275121.  Also, as result, it
	was possible to eliminate recursion on it, r275372.</p>
    </body>

    <sponsor>The FreeBSD Foundation</sponsor>

  </project>

</report>
