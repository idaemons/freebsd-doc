<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE report PUBLIC "-//FreeBSD//DTD FreeBSD XML Database for
  Status Report//EN"
  "http://www.FreeBSD.org/XML/share/xml/statusreport.dtd" >

<!-- $FreeBSD$ -->

<report>
  <date>
    <month>July-September</month>

    <year>2014</year>
  </date>

  <section>
    <title>Introduction</title>

<!-- <?ignore -->
    <p><strong>This is a draft of the October&ndash;December 2014 status
	report.	 Please check back after it is finalized, and an
	announcement email is sent to the &os;-Announce mailing
	list.</strong></p>
<!-- ?> -->

    <p>This report covers &os;-related projects between October and
      December 2014.  This is the last of four reports planned for
      2014.</p>

    <p>The fourth quarter of 2014... was a very busy and productive
      time</p>

    <p>Thanks to all the reporters for the excellent work!</p>

    <p>The deadline for submissions covering the period from January
      to March 2015 is April 7th, 2015.</p>
  </section>

  <category>
    <name>team</name>

    <description>&os; Team Reports</description>
  </category>

  <category>
    <name>proj</name>

    <description>Projects</description>
  </category>

  <category>
    <name>kern</name>

    <description>Kernel</description>
  </category>

  <category>
    <name>arch</name>

    <description>Architectures</description>
  </category>

  <?ignore
  <category>
    <name>bin</name>

    <description>Userland Programs</description>
  </category>
  ?>

  <category>
    <name>ports</name>

    <description>Ports</description>
  </category>

  <category>
    <name>doc</name>

    <description>Documentation</description>
  </category>

  <category>
    <name>misc</name>

    <description>Miscellaneous</description>
  </category>

  <project cat='misc'>
    <title>&os; Forum Software Migration</title>

    <contact>
      <person>
	<name>&os; Forums Administration Team</name>
	<email>forum-admins@</email>
      </person>
    </contact>

    <body>
      <p>With funding from the &os; Foundation, the &os; forums
	were migrated to XenForo software.  The new software is far more
	capable and easy to use.  While the entire forum team
	contributed, &a.danger; did a particularly excellent job
	importing existing users and messages and bringing back the
	often-requested "Thanks" feature.  The upgrade was completed in
	time to be ready for the influx of new users from the release of
	&os; 10.1, and we have already seen an increase in usage.</p>

      <p>Developers with an @FreeBSD.org address can contact forum
	administrators to obtain the highly-desired "@"	suffix on their
	forum user name along with a Developer flag.</p>

      <p>We want to thank the Foundation for making this possible, and
	the users for their patience and continued presence on the
	forums!</p>
    </body>

    <sponsor>
      The &os; Foundation
    </sponsor>

    <help>
      <task>
 	<p>Encourage more developers and users to try the new forums.</p>
      </task>

      <task>
	<p>Continue getting feedback from users for tuning and
	  improvements.</p>
      </task>
    </help>
  </project>

  <project cat='kern'>
    <title>Process management</title>

    <contact>
      <person>
	<name>
	  <given>Konstantin</given>
	  <common>Belousov</common>
	</name>
	<email>kib@FreeBSD.org</email>
      </person>
      <person>
	<name>
	  <given>Peter</given>
	  <common>Holm</common>
	</name>
	<email>pho@FreeBSD.org</email>
      </person>
    </contact>

    <body>
      <p>There were several improvements made to the FreeBSD process
	management last quarter.</p>

      <p>Reaper. The facility to allow a process to reliably track the
	running and exiting state of the whole subtree of the processes,
	was added.  It is intended to improve tools like timeout(1) or
	poudriere, by making it impossible for the runaway granchild to
	escape the controlling process.  Feature was designed based on
	similar facility in the DragonFlyBSD and Linux, with some
	references to the Solaris contracts.  Committed to HEAD in
	r275800.</p>

      <p>Total stop.  Right now, the FreeBSD suspension code does not
	ensures that the system, both from software and from hardware
	view, is in the steady and consistent state.  One aspect is the
	usermode process activity which is not stopped, continuing to
	making requests to the hardware.  It is not realistic to expect
	drivers to be able to correctly handle the calls after
	SUSPEND_CHILD.</p>

      <p>Together with Peter Holm, we developed a facility to stop
	usermode threads at the safe points, where they are known to not
	own and to not wait for kernel resources, in particular, not
	waiting for device requests finishing.  It is based on the
	existing single-threading code, but extending it to allow external
	thread to put some process into stopped state.  Also, a facility
	to sync filesystems before suspend was added, to ensure that
	consistent metadata and as much as possilbe of the cached user
	data are on stable storage, to minimize damage of failed
	resume.</p>

      <p>The code stressed some parts of the system and lead to
	discovery of the unusual numbers of bugs in the different parts of
	the system, including process management, buffer cache and syscall
	handlers.  The bugs were fixed, fixes and the features commmitted
	by a series culminating in r275745.</p>

      <p>Process spinlock changes. During the work described above, it
	was noted that process spinlock duties are significantly
	overloaded (the same is true for the process lock).  The spinlock
	was split into per-feature lock, see r275121.  Also, as result, it
	was possible to eliminate recursion on it, r275372.</p>
    </body>

    <sponsor>The FreeBSD Foundation</sponsor>

  </project>

  <project cat='proj'>
    <title>FreeBSD on the Acer C720 Chromebook</title>

    <contact>
      <person>
	<name>
	  <given>Michael</given>
	  <common>Gmelin</common>
	</name>
	<email>freebsd@grem.de</email>
      </person>
    </contact>

    <links>
      <url href="http://blog.grem.de/pages/c720.html" />
    </links>

    <body>
      <p>Most system features work, including keyboard, WiFi, sound,
	VESA graphics, touchpad, USB and decent battery life (5 to 6 hours).</p>
    </body>

    <help>
      <task>
	<p>Streamline patches and merge them into HEAD.</p>
      </task>

      <task>
	<p>Make suspend/resume work (depends on Haswell support).</p>
      </task>
    </help>
  </project>

  <project cat='misc'>
    <title>Creating Vagrant images with Packer</title>

    <contact>
      <person>
	<name>
	  <given>Brad</given>
	  <common>Davis</common>
	</name>
	<email>brd@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="http://blogs.freebsdish.org/brd/2014/12/22/freebsd-packer-vagrant/">Blog Announcement</url>
      <url href="https://github.com/so14k/packer-freebsd">Git Repo</url>
    </links>

    <body>
      <p>We have developed a recipe to use Packer to create FreeBSD
	Vagrant images to run on VMware and VirtualBox.</p>

      <p><a href="https://www.packer.io/">Packer</a> is a tool for
	creating identical machine images for multiple platforms from a
	single source configuration.</p>

      <p><a href="https://www.vagrantup.com/">Vagrant</a> is a tool to
	create and configure lightweight, reproducible, and portable
	development environments.</p>

      <p>To get started clone the Git repo and follow the directions in
	the README.  More information is available from the Packer and
	Vagrant websites.</p>
    </body>
  </project>

  <project cat="proj">
    <title>pkg(8)</title>

    <contact>
      <person>
	<name>The pkg team</name>

	<email>pkg@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://github.com/freebsd/pkg"/>
    </links>

    <body>
      <p>The package development team has released <tt>pkg(8)</tt> 1.4.
	This release fixes lots of bugs and adds some new features:
	<ul>
	  <li>Stricter checking of the path passed via the plist</li>
	  <li>Change in the ABI to be closer to MACHINE_ARCH</li>
	  <li>Add three-way merge functionnality</li>
	  <li>Add conservative upgrade support for multi repository configurations</li>
	  <li>Multirepository priority</li>
        </ul>
      </p>

      <p>An important part of the development direction for the 1.4
	release has been done on stabilizing the existing features, and
	improving the <tt>pkg(8)</tt> experience on small/embedded
	machines (reduce memory usage, speed up operations).</p>

      <p><tt>pkg(8)</tt> is not only the &os; Package Manager, but the
	Package Manager for DragonflyBSD.  Additionally support has been
	added to build <tt>pkg(8)</tt> on OS X and Linux.  This work
	will allow other Operating Systems the option of adopting
	<tt>pkg(8)</tt> to manage their packages and bring new
	developers into the project.</p>
    </body>

    <help>
       <task>Add more regression tests</task>
       <task>Package FreeBSD base</task>
       <task>Allow using mtree as a plist when creating a package</task>
       <task>Implement flexible dependencies</task>
       <task>Test the developement branch</task>
       <task>More developers are needed, check the Issues on Github</task>
    </help>
  </project>
</report>
