<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE report PUBLIC "-//FreeBSD//DTD FreeBSD XML Database for
  Status Report//EN"
  "http://www.FreeBSD.org/XML/share/xml/statusreport.dtd" >

<!-- $FreeBSD$ -->

<report>
  <date>
    <month>April-June</month>

    <year>2015</year>
  </date>

  <section>
    <title>Introduction</title>

    <p><strong>This is a draft of the April&ndash;June 2015
      status report.  Please check back after it is finalized, and
      an announcement email is sent to the &os;-Announce mailing
      list.</strong></p>

    <?ignore
    <p>This report covers &os;-related projects between April and
      June 2015.  This is the second of four reports planned for
      2015.</p>

    <p>Another productive quarter for the &os; project and community
      has passed.  BSDCan was held in Ottawa in June, and both it and
      the preceding Developer Summit allowed developers to plan for
      the future and discover what others have already
      accomplished.</p>

    <p>Thanks to all the reporters for the excellent work!</p>

    <p>The deadline for submissions covering the period from July
      to September 2015 is October 1, 2015.</p>
    ?>
  </section>

  <category>
    <name>team</name>

    <description>&os; Team Reports</description>
  </category>

  <category>
    <name>proj</name>

    <description>Projects</description>
  </category>

  <category>
    <name>kern</name>

    <description>Kernel</description>
  </category>

  <category>
    <name>arch</name>

    <description>Architectures</description>
  </category>

  <category>
    <name>bin</name>

    <description>Userland Programs</description>
  </category>

  <category>
    <name>ports</name>

    <description>Ports</description>
  </category>

  <category>
    <name>doc</name>

    <description>Documentation</description>
  </category>

  <category>
    <name>misc</name>

    <description>Miscellaneous</description>
  </category>

  <project cat='doc'>
    <title>New Documentation Committers</title>

    <contact>
      <person>
	<name>&os; Documentation Engineering Team</name>
	<email>doceng@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://www.freebsd.org/doc/en_US.ISO8859-1/books/porters-handbook/">&os; Porter's Handbook</url>
      <url href="https://www.freebsd.org/">&os; Web Site</url>
      <url href="https://www.freebsdfoundation.org/">&os; Foundation Web Site</url>
    </links>

    <body>
      <p>Two new documentation committers were added to the team in
	the second quarter of 2015.</p>

      <p>Mathieu Arnold is a member of the &os; Ports Management Team.
	Over the past year, he has worked on many large and complex
	updates to keep the Porter's Handbook current, and
	continues to update this important document.</p>

      <p>Anne Dickison is Marketing Director for the &os; Foundation.
	She will focus on updating and improving the &os; main web
	site.</p>

      <p>We welcome both new committers and look forward to their
	additional contributions!</p>
    </body>
  </project>

  <project cat='doc'>
    <title>Documentation Working Group at BSDCan</title>

    <contact>
      <person>
	<name>&os; Documentation Team</name>
	<email>freebsd-doc@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="http://www.bsdcan.org/">BSDCan</url>
      <url href="http://docutils.sourceforge.net/rst.html">reStructured Text</url>
      <url href="http://daringfireball.net/projects/markdown/">Markdown</url>
      <url href="http://asciidoc.org/">AsciiDoc</url>
      <url href="https://wiki.freebsd.org/">&os; Wiki</url>
      <url href="https://www.freebsd.org/">&os; Web Site</url>
      <url href="http://annotatorjs.org/">Annotator</url>
      <url href="https://github.com/openannotation/annotator/wiki#backend-stores">Annotator Backend Stores</url>
    </links>

    <body>
      <p>During the Developer Summit held in the two days before
	BSDCan, a documentation working group meeting was held.  We
	discussed some of the biggest opportunities available to the
	documentation team.</p>

      <p>Modernizing our translation system was, again, a major topic.
	Making it easier for translators to do their work is vitally
	important.  Translations make &os; much more accessible for
	non-English speakers, and those people and the translators
	themselves often become valuable technical contributors in
	other areas.  Progress was made in this area, and we hope to
	have more news soon.</p>

      <p>Methods of making it easier for people to contribute to
	documentation was another major topic.  At present, we use
	DocBook XML for articles and books, and mdoc(7) for man pages.
	These markup languages are not very welcoming for new users.
	There are simpler documentation markup languages like RST,
	Markdown, and AsciiDoc that take less time to learn and use.
	In fact, these markup systems are all similar to each other.
	These systems tend to be more oriented towards visual
	appearance rather than the semantic markup of our present
	systems, there might be ways to work around that.</p>

      <p>Following the theme of making contributing easier, we also
	discussed giving easier access so users can make additions to
	the &os; Wiki.  Like any other useful web resource, it was
	horribly abused by spammers and access was limited to prevent
	that abuse.  It is tricky to allow submissions yet keep the
	quality of submitted information usefully high.</p>

      <p>Due to the markup systems used, it is difficult to review
	documents for the quality of their information.  Annotator is
	a Javascript system that allows adding notes to an existing
	web page.  This would allow us to hold content-only reviews of
	documentation web pages.  Reviewers would not see markup, so
	they could concentrate only on whether the information was
	accurate and complete.  To use this as desired, we need some
	help with ports and testing.</p>
    </body>

    <help>
      <task>
	<p>Complete a port for the backend storage component of
	  Annotator.  Preferably this would be the lowest overhead and
	  most open-licensed version available.  Assistance from those
	  familiar with Python and Javascript web development is
	  welcome.</p>
      </task>
    </help>
  </project>

  <project cat='misc'>
    <title>&os; Support in <tt>pkgsrc</tt></title>

    <contact>
      <person>
	<name>
	  <given>Sevan</given>
	  <common>Janiyan</common>
	</name>
	<email>venture37@geeklan.co.uk</email>
      </person>
    </contact>

    <links>
      <url href="https://www.pkgsrc.org">pkgsrc home page</url>
      <url href="http://bulktracker.appspot.com">BulkTracker - Track bulk build status</url>
      <url href="https://www.geeklan.co.uk/?tag=pkgsrc">My blog posts on pkgsrc</url>
    </links>

    <body>
      <p><tt>pkgsrc</tt> is a fork of &os; ports from the NetBSD
	project with a focus on portability and multi platform
	support.  At present, pkgsrc supports building packages on 23
	different platforms from a single tree, including &os;</p>

      <p>While <tt>pkgsrc</tt> is not a replacement for ports in most
	use cases, it holds a unique position in mixed platform
	environments where software ideally needs to be the same
	version across the board and should built in a consistent
	manner, saving the user from having to resort to manually
	building programs or re-implementing a mechanism to do so.</p>

      <p>With the recent
	<a href="http://mail-index.netbsd.org/pkgsrc-users/2015/07/06/msg021778.html">2015Q2 release</a>
	earlier this month, it is now possible to generate over 14000
	packages on FreeBSD 10.1-RELEASE (up from 12800 last
	quarter).</p>

      <p>Work is in progress to add
	<a href="https://vimeo.com/132766052">pkgng support to pkgsrc.</a></p>
    </body>

    <help>
      <task>
	<p>Improve platform support to skip libusb on &os; where
	libusb is bundled in base.  This is causing the biggest
	breakage at the moment.</p>
      </task>

      <task>
	<p>Expand the effort to -STABLE and -CURRENT branches and, if
	  possible, architectures other than AMD64.  Shell access
	  welcome (without privilege is sufficient).</p>
      </task>
    </help>
  </project>

  <project cat='misc'>
    <title>ZFS Support for UEFI Boot/Loader</title>

    <contact>
      <person>
	<name>
	  <given>Eric</given>
	  <common>McCorkle</common>
	</name>
	<email>emc2@metricspace.net</email>
      </person>
    </contact>

    <body>
      <p>UEFI-enabled <tt>boot1.efi</tt> and <tt>loader.efi</tt> have
	been modified to support loading and booting from a ZFS
	filesystem.  The patch currently works with
	<tt>buildworld</tt>, and successfully boots on a test machine
	with a ZFS partition.  In addition, the ZFS-enabled
	<tt>loader.efi</tt> can be treated as a chainloader using
	ZFS-enabled GRUB.</p>

      <p>The work on <tt>boot1.efi</tt> also reorganizes the code
	somewhat, splitting out the filesystem-specific parts into a
	modular framework.</p>
    </body>

    <help>
      <task>
	<p>More testing needed for the following uses: ZFS with
	  GRUB+<tt>loader.efi</tt>, ZFS with
	  <tt>boot1</tt>+<tt>loader.efi</tt>, UFS with
	  <tt>boot1</tt>+<tt>loader.efi</tt> (test modularization of
	  <tt>boot1.efi</tt>)</p>
      </task>

      <task>
	<p>Have <tt>boot1.efi</tt> check partition type GUIDs before
	  probing for filesystems.</p>
      </task>

      <task>
	<p>Get patch accepted upstream and committed.</p>
      </task>
    </help>
  </project>

  <project cat='ports'>
    <title>Xfce on FreeBSD</title>

    <contact>
      <person>
	<name>
	  <given>&os; Xfce Team</given>
	</name>
	<email>xfce@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://wiki.freebsd.org/Xfce" />
      <url href="https://www.assembla.com/code/xfce4/subversion/nodes" />
    </links>

    <body>
      <p><tt>Xfce</tt> is a free software desktop environment for Unix
	and Unix-like platforms, such as &os;.  It aims to be fast and
	lightweight, while still being visually appealing and easy to
	use.</p>

      <p>During this quarter, the team has kept these applications
	up-to-date:</p>

      <ul>
	<li><tt>audio/xfce4-pulseaudio-plugin</tt> 0.2.3</li>
	<li><tt>deskutils/orage</tt> 4.12.1</li>
	<li><tt>deskutils/xfce4-notes-plugin</tt> 1.8.1</li>
	<li><tt>misc/xfce4-weather-plugin</tt> 0.8.6</li>
	<li><tt>science/xfce4-equake-plugin</tt> 1.3.7</li>
	<li><tt>sysutils/xfburn</tt> 0.5.4</li>
	<li><tt>sysutils/xfce4-power-manager</tt> 1.5.0 (committed to
	  ports), 1.5.2 (committed to devel repository)</li>
	<li><tt>x11/libexo</tt> 0.10.6</li>
	<li><tt>x11/xfce4-dashboard</tt> 0.4.2</li>
	<li><tt>x11-fm/thunar</tt> 1.6.10</li>
	<li><tt>x11-wm/xfce4-desktop</tt> 4.12.2</li>
	<li><tt>x11-wm/xfce4-wm</tt> 4.12.3</li>
	<li><tt>www/midori</tt> 0.5.10</li>
      </ul>

      <p>Mathieu Arnold (<tt>mat@</tt>) committed
	<a href=" https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=197878">PR197878</a>,
	updating the Xfce section in the Porter's Handbook.</p>

      <p>We also follow the unstable releases (available in our
	experimental repository) of:</p>

      <ul>
	<li><tt>sysutils/garcon</tt> 0.5.0 (supports both GTK2 and
	  GTK3 toolkits)</li>
	<li><tt>x11/xfce4-dashboard</tt> 0.5.0</li>
	<li><tt>x11/xfce4-hotcorner-plugin</tt> 0.0.2 (new
	  plugin)</li>
      </ul>
    </body>

    <help>
      <task>
	<p>Create documentation about usage of
	  <tt>sysutils/xfce4-power-manager</tt> (it needs some love,
	  <a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=199166">PR199166</a>).</p>

	<p>Some hidden features were introduced in the 1.5.1 release,
	  and as we also support ConsoleKit2 (fork of
	  <tt>sysutils/consolekit</tt>), help for users is
	  required.</p>
      </task>
    </help>
  </project>

  <project cat='doc'>
    <title>FreeBSD Mastery: ZFS Now Available</title>

    <contact>
      <person>
	<name>
	  <given>Michael</given>
	  <common>Lucas</common>
	</name>
	<email>mwlucas@michaelwlucas.com</email>
      </person>
    </contact>

    <links>
      <url href="http://www.zfsbook.com" />
      <url href="https://www.michaelwlucas.com" />
    </links>

    <body>
      <p>The first ZFS book is now available at your favorite
	bookstore.  Find a whole bunch of links at
	<a href="http://www.zfsbook.com"><tt>zfsbook.com</tt></a>.</p>

      <p>Work is proceeding apace on "FreeBSD Mastery: Advanced ZFS"
	and "FreeBSD Mastery: Specialty Filesystems."  Lucas hopes to
	have FMAZ complete and available before the next status
	report.</p>
    </body>
  </project>

  <project cat='doc'>
    <title>The FreeBSD German Documentation Project</title>

    <contact>
      <person>
	<name>
	  <given>Bj&ouml;rn</given>
	  <common>Heidotting</common>
	</name>
	<email>bhd@FreeBSD.org</email>
      </person>

      <person>
	<name>
	  <given>Johann</given>
	  <common>Kois</common>
	</name>
	<email>jkois@FreeBSD.org</email>
      </person>

      <person>
	<name>
	  <given>Benedict</given>
	  <common>Reuschling</common>
	</name>
	<email>bcr@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://www.freebsd.org/de/docs.html">Main German Documentation Project page</url>
      <url href="https://people.freebsd.org/~jkois/FreeBSDde/de/">How you can help with german translations</url>
    </links>

    <body>
      <p>The &os; German Documentation project maintains the German
	translations of &os;'s documents such as the Handbook and the
	website.</p>

      <p>In the second quarter of 2015, we managed to catch up with
	the translation work of the Handbook.  Two chapters are now
	back in sync with their English reference chapters:
	filesystems and ZFS.  The former was mainly done by Bj&ouml;rn
	Heidotting as part of his mentee process.  The latter was done
	by Benedict Reuschling, which valuable corrections by
	Bj&ouml;rn.</p>

      <p>Additionally, we updated many of our translation markers from
	pre-SVN times.  This will help us get an overview of the
	outstanding work in each chapter.  We are working on
	integrating this into our website using a script, so people
	can see which chapters need the most work or are most
	up-to-date.</p>

      <p>Johann made efforts to update the &os; Documentation Project
	Primer as well, so that translators willing to help us can
	read the information in German.  He also made efforts to
	revive the Documentation Project website, which was previously
	hosted elsewhere, but disappeared.  Now, it is tied into the
	German FreeBSD.org website again and has the same look and
	feel.</p>

      <p>Occasionally, people contact us and offer their help with the
	translation effort.  We are happy to help newcomers get to
	know everything about the translation process and look forward
	to more contributions.  Even small updates make a big
	difference and if you are considering to help, please contact
	us.</p>
    </body>

    <help>
      <task>
	<p>Continue translating the Handbook and website into
	  German.</p>
      </task>

      <task>
	<p>Integrate a script that shows outstanding work into the
	  German documentation webpages.</p>
      </task>
    </help>
  </project>

  <project cat='proj'>
    <title>Multiqueue Testing</title>

    <contact>
      <person>
	<name>
	  <given>Tiwei</given>
	  <common>Bie</common>
	</name>
	<email>btw@FreeBSD.org</email>
      </person>

      <person>
	<name>
	  <given>Hiren</given>
	  <common>Panchasara</common>
	</name>
	<email>hiren@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://wiki.freebsd.org/SummerOfCode2015/MultiqueueTestingProject" />
    </links>

    <body>
      <p>The aim of this project is to design and implement a
	infrastructure to validate that a number of the network
	stack's multiqueue behaviours are as expected.</p>

      <p>It mainly consists of extending <tt>tap(4)</tt> to provide
	the same RSS behaviours with the hardware multiqueue network
	cards, developing simple test applications using multiqueue
	<tt>tap(4)</tt> and <tt>socket(2)</tt>, adding hooks in each
	layer of the network stack to collect the per-ring per-cpu
	per-layer statistics, and extending <tt>netstat(1)</tt> to
	report these statistics.</p>

      <p>At present, most parts of this project have been implemented.
	The focus is on the code review, and API/KPI freeze.</p>
    </body>

    <sponsor>
      Google Summer Of Code 2015
    </sponsor>
  </project>

  <project cat='team'>
    <title>&os; Release Engineering Team</title>

    <contact>
      <person>
	<name>&os;&nbsp;Release Engineering Team</name>
	<email>re@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://www.freebsd.org/releases/10.2R/schedule.html">&os;&nbsp;10.2-RELEASE schedule</url>
      <url href="http://ftp.freebsd.org/pub/FreeBSD/snapshots/ISO-IMAGES/">&os; development snapshots</url>
      <url href="https://lists.freebsd.org/pipermail/freebsd-snapshots/">&os; development snapshots announcements list</url>
    </links>

    <body>
      <p>The &os; Release Engineering Team is responsible for setting
	and publishing release schedules for official project releases
	of &os;, announcing code freezes and maintaining the
	respective branches, among other things.</p>

      <p>The &os;&nbsp;10.2-RELEASE cycle began in mid-June, with the
	final release expected to be available in late August, and as
	this quarterly status update shows, &os;&nbsp;10.2-RELEASE is
	going to be a very exciting release.</p>

      <p>The &os; Release Engineering Team has been extremely busy
	this quarter, with much of the focus targeted at adding
	support for additional hardware and integration with
	third-party hosting providers (aka &quot;cloud&quot;
	hosting).</p>

      <p>In follow-up with the work done by &a.andrew; to port &os; to
	the ARM64 (aarch64) architecture, the Release Engineering
	build tools were updated to produce &os;/aarch64 memory stick
	images and virtual machine images for use with Qemu
	(<tt>emulators/qemu-devel</tt>).  At present, the Qemu virtual
	machine images require an external EFI file to boot.  Details
	on how to boot &os;/aarch64 virtual machine images are
	available in the &os; development snapshot announcement email
	archives linked below.</p>

      <p>Last quarter, several parts of the build tools were rewritten
	to allow greater extensibility and granularity, which has
	simplified the code required for new virtual machine
	images.</p>

      <p>In collaboration with several developers, the Release
	Engineering build tools were updated to provide new support
	for several hosting providers, as well as provide mechanisms
	to automatically upload (and publish, where possible) &os;
	virtual machine images.</p>

      <p>This quarter, in addition to the existing support for the
	Microsoft Azure platform, the build tools also natively
	support:</p>

      <ul>
	<li>Amazon EC2 (thanks to &a.cperciva;)</li>
	<li>Google Compute Engine (thanks to &a.swills;)</li>
	<li>Vagrant/Hashicorp Atlas (thanks to &a.brd;)</li>
      </ul>

      <p>The &os; Release Engineering Team would like to thank these
	developers for all of the work that went into making this
	possible, and would like to especially thank &a.marcel; for
	all of his work on the <tt>mkimg(1)</tt> utility, especially
	for adding support for the various file formats requested.</p>

      <p>In addition to the enhancements to the virtual machine build
	tools, a significant amount of work went into refactoring the
	build code used to produce &os;/arm images.</p>

      <p>With much of the logic resembling how the <tt>Crochet</tt>
	utility (written by &a.kientzle;) works, and a significant
	amount of work, input, and advice from &a.ian;, &a.imp;,
	&a.andrew;, &a.loos;, and a large number of contributors on
	the <tt>freebsd-arm@FreeBSD.org</tt> mailing list, the &os;
	Release Engineering tools now natively support producing
	&os;/arm images without external build tools.</p>

      <p>At present, the build tools are support building &os;/arm
	images for:</p>

      <ul>
	<li><tt>BEAGLEBONE</tt></li>
	<li><tt>CUBOX/HUMMINGBOARD</tt></li>
	<li><tt>GUMSTIX</tt></li>
	<li><tt>RPI-B</tt></li>
	<li><tt>RPI2</tt> (&os;-CURRENT only)</li>
	<li><tt>PANDABOARD</tt></li>
	<li><tt>WANDBOARD</tt></li>
      </ul>

      <p>The &os; Release Engineering Team would like to thank each
	of these people for their support and input, and would like to
	especially thank &a.kientzle; for his work on
	<tt>Crochet</tt>.  Without it, we might not have been able to
	produce images of the various boards that we are able to
	now.</p>

      <p>For more information on what else has changed in &os; since
	10.1-RELEASE, see the
	<a href="https://www.freebsd.org/relnotes/10-STABLE/relnotes/article.html">&os;&nbsp;10.1-STABLE release notes</a>
	(which will become the release notes for 10.2-RELEASE).</p>

      <p>Additionally, &a.gjb; would like to thank Jim Thompson for
	providing a BeagleBone Black board (replacing one that no
	longer worked), and Benjamin Perrault for providing
	a PandaBoard ES, both of which are used for locally testing
	the images produced by the build tools.</p>

      <p>Last, and certainly not least, &a.gjb; would also like to
	thank the &os;&nbsp;Foundation for their support, and for
	providing the resources (time and hardware) required to make
	all of the items mentioned in this status report possible.</p>
    </body>

    <sponsor>
      The &os; Foundation
    </sponsor>
  </project>

  <project cat='misc'>
    <title>BSDCan 2015</title>

    <contact>
      <person>
	<name>
	  <given>Dan</given>
	  <common>Langille</common>
	</name>
	<email>dvl@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="http://www.bsdcan.org/2015/" />
      <url href="https://www.youtube.com/playlist?list=PLWW0CjV-TafY0NqFDvD4k31CtnX-CGn8f" />
    </links>

    <body>
      <p>BSDCan, a conference for people working on and with
	4.4BSD-based operating systems and related projects, was held
	in Ottawa, Ontario on June 12 and 13.  A two-day &os;
	developer summit event preceded it on June 10 and 11.</p>

      <p>This was the largest BSDCan ever, with over 280 attendees, up
	by more than 40 people over the 2014 event.  There were a
	record number of speakers and talks.  An additional room and
	"track" was added to provide even more choices for concurrent
	talks on both days of the conference.  Social media response
	to the whole conference has been very positive.</p>

      <p>The keynote talk by Stephen Bourne was very popular.  So
	popular, in fact, that the main conference room could not hold
	all the attendees.  An overflow room with live video was set
	up to hold the extra people.  The
	<a href="https://www.youtube.com/watch?v=2kEJoWfobpA">video</a>
	of the presentation has had over 6300 views in the first
	twelve days.</p>

      <p>Andrew Tanenbaum's talk on
	<a href="https://www.youtube.com/watch?v=0pebP891V0c">reimplementing NetBSD using a MicroKernel</a>
	was so well-attended it was standing room only.</p>

      <p>There were many other excellent talks, and we recommend
	browsing through the playlist in the links above.</p>

      <p>Activity was not limited to the talks.  Each night, the
	"Hacker Lounge" was used by developers to cooperate and
	interact on projects.  Embedded projects were popular this
	year, as FreeBSD was installed directly on wireless
	routers.</p>

      <p>The very successful and well-attended closing event, held
	at the Lowerton Brewery, provided an elegant closure to the
	whole conference.</p>

      <p>We would like to thank everyone who made BSDCan 2015 such a
	success, and look forward to next year!</p>
    </body>
  </project>

  <project cat='kern'>
    <title>Adding PCIe Hot-plug Support</title>

    <contact>
      <person>
	<name>
	  <given>John-Mark</given>
	  <common>Gurney</common>
	</name>
	<email>jmg@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="http://p4db.freebsd.org/depotTreeBrowser.cgi?FSPC=//depot/projects/pciehotplug">PCIe Hot-plug P4 Branch</url>
      <url href="https://svnweb.freebsd.org/changeset/base/r281874">Commit adding bridge save/restore.</url>
      <url href="https://github.com/FreeBSDFoundation/freebsd/tree/pciehp">Github branch with patches</url>
    </links>

    <body>
      <p>PCI Express (PCIe) hot-plug is used on both laptops and
	servers to allow peripheral devices to be added or removed
	while the system is running.  Laptops commonly include a
	hot-pluggable PCIe as either an ExpressCard slot or
	Thunderbolt interface.  ExpressCard has built in USB support
	that is already supported by &os;, but ExpressCard PCIe
	devices like Gigabit Ethernet adapters and eSATA cards are
	only supported when they are present at boot, and removal may
	cause &os; to crash.</p>

      <p>The goal of this project is to allow these devices to be
	inserted and removed while &os; is running.  The work will
	provide the basic infrastructure to support adding and
	removing devices, though it is expected that additional work
	will be needed to update individual drivers to support
	hot-plug.</p>

      <p>Current testing is focused on getting a simple UART device
	functional.  Basic hot swap is functional.</p>

      <p>A set of the patches is now available on github.com.</p>
    </body>

    <sponsor>
      The FreeBSD Foundation
    </sponsor>

    <help>
      <task>
	<p>Get suspend/resume functional by save/restoring necessary
	  registers.  This should be addressed by r281874.</p>
      </task>

      <task>
	<p>Make sure that upon suspend, devices are removed so we
	  are not fooled if they are replaced while the machine is
	  suspended.</p>
      </task>

      <task>
	<p>Improve how state transitions are handled, possibly by
	  using a proper state machine.</p>
      </task>
    </help>
  </project>

  <project cat='doc'>
    <title>Leap Seconds Article</title>

    <contact>
      <person>
	<name>
	  <given>Warren</given>
	  <common>Block</common>
	</name>
	<email>wblock@@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://www.freebsd.org/doc/en_US.ISO8859-1/articles/leap-seconds/article.html" />
    </links>

    <body>
      <p>As the leap second scheduled for the end of June approached,
	Bartek Rutkowski and others raised questions about how &os;
	handled leap seconds.  Leap seconds have caused serious
	problems for other operating systems in the last few years,
	and there was understandable concern.</p>

      <p>It was reasonably pointed out that &os; had encountered leap
	seconds before, and would be fine this time also.  Still, the
	absence of reported problems is not really a substitute for a
	description of what to expect and how to know if a system is
	prepared.</p>

      <p>To address concerns and also provide a resource for future
	leap seconds, several experts were harrassed relentlessly,
	with the results compiled into a short article.  Beyond merely
	allaying fears about what might happen, this article received
	positive responses on the web for how it demonstrated &os;'s
	maturity and preparedness.</p>

      <p>Great thanks for their patience and expertise are owed to
	Peter Jeremy, Poul-Henning Kamp, Ian Lepore, Xin LI, Warner
	Losh, and George Neville-Neil.</p>
    </body>

    <help>
      <task>
	<p>Compile other short articles on things that &os; does
	  really well.  Of particular interest are features that make
	  life easier for sysadmins, or how problems on other systems
	  are dealt with or even made non-problems on &os;.</p>
      </task>
    </help>
  </project>

  <project cat='team'>
    <title>The &os; Core Team</title>

    <contact>
      <person>
	<name>&os; Core Team</name>
	<email>core@FreeBSD.org</email>
      </person>
    </contact>

    <body>
      <p>The &os; Core Team constitutes the project's "Board of
	Directors", responsible for deciding the project's overall
	goals and direction as well as managing specific areas of the
	&os; project landscape.</p>

      <p>In order to help attract fresh developer talent to &os;, Core
	has a general policy to make available an up-to-the-minute
	suite of developer tools and services.  Core has long been
	encouraging &os; committers to make full use of the project's
	Phabricator instance at
	<a href="https://reviews.FreeBSD.org/">https://reviews.FreeBSD.org</a>,
	and now has supported the Phabricator admins in opening access
	to anyone interested enough to sign up for an account.</p>

      <p>Further developments under consideration include setting up a
	FreeBSD.org oauth2 provider and permitting oauth-style Single
	Sign-On access to most FreeBSD web-based services.  Developers
	and members of the public would additionally be able to use
	credentials from other providers such as GitHub, Twitter, or
	Google to authenticate themselves to &os; web services.</p>

      <p>Mark Murray raised a problem he has been having for some time
	with getting adequate security review of his proposed changes
	to <tt>random(9)</tt>.  This is an extremely security
	sensitive area of the kernel where errors can have disastrous
	consequences.  Core has been able to drum up a number of
	reviewers and they have made significant progress in
	simplifying the design, eliminating some difficult portions of
	code, and reducing any potential attack surface.  Work is
	still ongoing and Core remains open to the idea of bringing in
	external reviewers with specialist cryptographic
	knowledge.</p>

      <p>Dag-Erling Sm&oslash;rgrav resigned as Security Officer
	towards the end of May.  Core was sorry to see him step down,
	but unanimously pleased to welcome his nominee and former
	deputy, Xin Li, as his successor.  Xin has since appointed
	Gleb Smirnoff (who also happens to be a current member of
	core) as his new deputy.  Between them and Core they have some
	fairly radical ideas under discussion about how to improve the
	project's responsiveness to security issues.</p>

      <p>Shortly after BSDCan in mid-June, Warner Losh proposed a
	change to <tt>style(9)</tt> which resulted in some lively
	discussion.  An informal poll was conducted via Phabricator
	and the change was committed within a couple of days.
	Unfortunately, this did not meet with universal approval and
	Core was called upon to arbitrate.  Warner backed out the
	change, recognizing that there had not been enough time
	allowed for proper discussion.  Many people were still in
	transit from BSDCan, and the voting arrangements did not suit
	everyone.  A new poll has since been held, with votes either
	by e-mail or the Slowvote facility of Phabricator.  This
	resulted in approval of the change by a wide margin.</p>

      <p>During this period we had two new commit bits awarded, and
	one taken in for safekeeping.  Welcome aboard to Chris Torek
	and Mariusz Zeborski, and we were very sorry indeed to see
	Steve Kargl decide to call it a day.</p>
    </body>
  </project>

  <project cat='kern'>
    <title>CloudABI: Capability-Based Runtime Environment</title>

    <contact>
      <person>
	<name>
	  <given>Ed</given>
	  <common>Schouten</common>
	</name>
	<email>ed@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://github.com/NuxiNL/cloudlibc">CloudABI on GitHub</url>
      <url href="https://github.com/NuxiNL/freebsd">FreeBSD patchset on GitHub</url>
    </links>

    <body>
      <p>CloudABI is a compact UNIX-like runtime environment that is
	purely based on capability-based security (Capsicum).  All
	features that are incompatible with this model have been
	removed.  Advantages of using a pure capability-based
	environment include improved security, testability, and
	reusability.  CloudABI should make it possible to run
	arbitrary third-party executables directly on top of &os;
	without any impact on system security, making it a good
	building block for a cluster/cloud computing setup.  See
	<a href="https://github.com/NuxiNL/cloudlibc">the project on GitHub</a>
	for a more detailed explanation.</p>

      <p>Last month I added a number of packages for the &os; Ports
	tree.  We now have a full C/C++ cross compiler that can be
	installed very easily
	(<a href="http://www.freshports.org/devel/cloudabi-toolchain">devel/cloudabi-toolchain</a>).
	I also imported a tool called <tt>cloudabi-run</tt> that can
	be used to start programs safely, only granting access to
	files and network sockets listed in the program's
	configuration file
	(<a href="http://www.freshports.org/sysutils/cloudabi-utils">sysutils/cloudabi-utils</a>).</p>

      <p>I have also imported some kernelspace modifications into the
	&os; source tree for executing CloudABI programs.  After all
	of these changes have been imported, just loading a kernel
	module will allow executing CloudABI programs.  Right now, the
	"cloudabi" branch on GitHub is still required.</p>
    </body>

    <sponsor>
      Nuxi, the Netherlands
    </sponsor>

    <help>
      <task>
	<p>Polish up the kernelspace modifications and send them out
	  for review.</p>
      </task>

      <task>
	<p>Complete the Linux and NetBSD kernel patchsets and send
	  those out to the respective maintainers.</p>
      </task>
    </help>
  </project>

  <project cat='kern'>
    <title>Sleep States Enhancements on <tt>x86</tt></title>

    <contact>
      <person>
	<name>
	  <given>Konstantin</given>
	  <common>Belousov</common>
	</name>
	<email>kib@FreeBSD.org</email>
      </person>
    </contact>

    <links>
      <url href="https://svnweb.freebsd.org/base?view=revision&amp;revision=282678" />
    </links>

    <body>
      <p>The ACPI specication defines CPU Cx states, which are idle
	states.  Methods to enter the state and miscellaneous
	information like state leave latency are returned by the _CST
	ACPI method.  To save energy and reduce useless heating, the
	operating system enters the Cx state when the CPU has no work
	to do.  C0 is the non-idle state, while C1, C2, and C3
	(defined by ACPI) each represent an idle state with
	sequentially more energy saving, but also with higher latency
	of leave and possibly greater secondary costs.  For example,
	C1 is entered by executing the HLT instruction and has no
	architecturally visible side effects, while entering C3 drops
	the CPU cache and usually requires special chipset programming
	to correctly handle requests from I/O devices to the CPU.  Do
	not confuse Cx, Px and Sx: Cx states are only meaningful when
	the system is in fully operational state S0; Px states are
	only meaningful when the system is not in the idle state,
	C0.</p>

      <p>Modern Intel CPUs enter Cx (x &gt;= 1) states with the
	dedicated instruction MWAIT, which enters a specified
	low-power state until a specific write is observed by the CPU
	bus logic.  There is a complimentary MONITOR instruction to
	set the monitored bus address.  The legacy port I/O method of
	entering Cx state is emulated by CPU microcode, which
	intercepts the port I/O and executes MWAIT internally.  Using
	MWAIT as the method of entering Cx requires following
	processor-specific procedures, which are communicated to the
	operating system by the vendor-specific extensions in _CST.
	The operating system must indicate readiness to support MWAIT
	when calling _CST. Claimed benefits of using MWAIT are reduced
	latencies of leaving the idle state, and visibility of more
	deep states than defined by the common ACPI specification.
	Still, modern Intel platforms report deep states as C2 to
	avoid the not needed bus-mastering avoidance.</p>

      <p>The new code asks ACPI for the Intel vendor-specific _CST
	extensions, parses them, and uses MWAIT Cx entrance methods
	when available.  The change was committed as r282678 to
	HEAD.</p>

      <p>For Linux, Intel provides a driver which does not depend on
	the ACPI tables to use MWAIT for entering Cx states.  For all
	Intel CPUs after Core2, the driver contains the description of
	the Cx mode latencies and quirks, eliminating dependency on
	the correct BIOS information, which is often incorrect.  The
	approach of porting the Linux driver was considered by several
	people, but all evaluators independently concluded that the
	project cannot maintain such an approach without direct
	involvement from Intel.</p>

      <p>During the work, around 500 lines of identical code between
	the i386 and amd64 version of the idle handling were moved to
	the common location <tt>x86/x86/cpu_machdep.c</tt>.  Now the
	i386 and amd64 <tt>machdep.c</tt> files contain only unique
	machine-dependent routines.  This advance depended on John
	Baldwin's elimination of the unmaintained Xen PVM i386
	port.</p>
    </body>

    <sponsor>
      The FreeBSD Foundation
    </sponsor>
  </project>

  <project cat='kern'>
    <title>Rewritten PCID Support</title>

    <contact>
      <person>
	<name>
	  <given>Konstantin</given>
	  <common>Belousov</common>
	</name>
	<email>kib@FreeBSD.org</email>
      </person>
    </contact>

    <body>
      <p>Process-Context Identifiers (PCIDs) is a feature of the TLB
	on Intel processors, existing since the Sandy Bridge
	micro-architecture introduction.  It allows the TLB to
	simultaneously cache translation information for several
	address spaces, and gives an opportunity for the operating
	system context switch code to avoid flushing the TLB on the
	process switch.  Each cached translation is tagged with some
	context identifier, and at context switch time, the operating
	system instructs the processor which context is becoming
	active.  The feature slightly reduces context switch time by
	avoiding flush, and more importantly, it reduces the warm-up
	period for the thread after a context switch.</p>

      <p>&os; already used PCID, but the existing implementation
	had several shortcomings.  The <tt>amd64</tt> pmap (the
	machine-dependent portion of the virtual memory subsystem)
	maintained a bitmap of all CPUs which ever loaded a
	translation for the given address space, and avoided TLB flush
	on the context switch.  The bitmap was used to direct
	Inter-Processor Interrupts to the marked CPU when the
	operating system needed to perform TLB invalidation.  The most
	important deficiency of the implementation is the increase of
	TLB invalidation IPIs since the bitmap could only grow until
	full TLB shootdown is performed.  It increases the TLB rate,
	which negated the positive effects of avoiding TLB flushes on
	large machines.  Secondarily, the bitmap maintenance in both
	the pmap and the context code was quite complicated, leading
	to bugs.  These issues resulted in the PCID feature being
	disabled by default.</p>

      <p>The new PCID implementation uses an algorithm described in
	the U. Vahalia book "UNIX Internals: The New Frontiers".  The
	algorithm is already used, for example, by the MIPS pmap for
	assigning the ASIDs to software-managed TLB entries.  The pmap
	maintains a per-CPU generation count, which is assigned to the
	next unused PCID when the context is activated on CPU.  TLB
	invalidation includes resetting the generation count, which
	causes reallocation of PCID when a context switch is
	performed.  As result, the new implementation issues exactly
	the same amount of shootdown IPIs as pmap which does not
	utilize PCID.</p>
    </body>
  </project>
</report>
