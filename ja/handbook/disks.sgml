<!-- This is an SGML document in the linuxdoc DTD describing
     Disks and FreeBSD.  By David O'Brien, 1998.

     $Id: disks.sgml,v 1.2 1998-07-20 05:02:58 hanai Exp $
     Original revision: 1.3

     The FreeBSD Documentation Project

<!DOCTYPE linuxdoc PUBLIC "-//FreeBSD//DTD linuxdoc//EN">

  <article>
      <title> Disks and FreeBSD
      <author> David O'Brien <tt/obrien@cs.ucdavis.edu/
      <date> 26 April 1998, (c) 1998

      <abstract> このドキュメントは FreeBSD でのディスク管理方法
      について書かれています. どのようにしてディスクの設定を行い
      動作させるかを説明します.
      </abstract>

    <toc>
-->

  <chapt><heading>ディスク<label id="disks"></heading>

    <p><em>原作 &a.obrien;<newline>26 April 1998</em>
    <p><em>訳: &a.yoshiaki;. 19 July 1998. </em>

	<p>1台だけディスクのあるマシンに新しい SCSI ディスクを追加する
	場合について述べましょう. まず, コンピュータの電源を切り, 
	コンピュータにコントローラとドライブを接続します. これには
	様々な手順がありえるため詳細についてはこのドキュメントの範囲外
	です.

	<p><it>root</it>ユーザとして login します. ドライブを接続した
	あとで <tt>/var/run/dmesg.boot</tt> を調べて, 新しいドライブが
	認識されたことを確認します. 以下の例では, あたらしく加える
	ドライブは <tt>sd1</tt> で <tt>/1</tt> へマウントしたいとします.
	(IDE ドライブを加える場合は<tt>sd</tt> の代りに <tt>wd</tt>を
	使います)

	<p>FreeBSD は IBM-PC 互換コンピュータで動作しますので, (訳注: 
	通常の場合では)
	ディスクは PC BIOS パーティションに属しなければなりません.
	これは伝統的な BSD パーティションとは異なります. PC のディスク 
	は最大4までのエントリを持ちます. もしディスク全体を FreeBSD に
	わりあてるのであれば, 「ディスク全体を使用」を選ぶことが
	できます. そうでないなら PC BIOS パーティションの一つに 
	FreeBSD を入れることになります. FreeBSD では PC BIOS 
	パーティションのことを <it>slices</it> と呼びます. 伝統的な
	BSD パーティションと混同するのを防ぐためです. FreeBSD のために
	つくったスライスをつかうこともできますし, ほかの OS を
	インストールしてあるスライスをつかうこともできます.
	これは他のオペレーティングシステムの <tt>fdisk</tt>
	ユーティリティの混乱を引き起こしません.

	<p>スライスをつかう場合, ドライブは <tt>/dev/sd1s1e</tt> のよう
	な形で加えられます. これは, SCSI ディスクの, ユニット番号1 
	(2台目の SCSI ディスク), スライス1 (PC BIOS パーティション1), 
	 <tt>e</tt> BSD パーティションという意味です.
	 全体を割り当てる場合は, ドライブは  <tt>/dev/sd1e</tt>
	 という単純な形になります.

    <sect><heading>sysinstall を利用する</heading>
	<p><tt>/stand/sysinstall</tt>を利用すると, 新しいディスクの
	パーティションやディスクラベルの設定をメニューから簡単に
	行うことができます.  <it>root</it>ユーザで login するか
	<tt>su</tt> コマンドを使います.  <tt>/stand/sysinstall</tt> 
	を動かし,  <it>カスタム</it> メニューに入ります.
	<tt>カスタムメニュー</tt> で <it>パーティション</it>
	を選びます. そうするとシステムに接続されているハードディスクの
	リストがあらわれるでしょう. <tt>sd1</tt>がリストに無い場合は
	接続と<tt>/var/run/dmesg.boot</tt> にある dmesg の出力を
	チェックする必要があります.

	<p><tt>sd1</tt>を選び, <tt>FDISK パーティションエディタ</tt>
	に入ります. ディスク全体を FreeBSD でつかうのであれば <tt>A</tt>
	を選びます. 
	``正しいパーティションエントリを保持して、このドライブには
	将来的に他のオペレーティングシステムを同居させる余地を残しますか?''
	と聞かれますので, そうしたい場合は<it>YES</it>を選んでください.
	変更をディスクに書き込むには<it>W</it>コマンドを使います.
	FDISK エディタを終了するには<it>q</it>コマンドを使います.

	FDISK エディタを終了すると Master Boot Record について質問されます.
	すでに動いているシステムにディスクを追加するのですから 
	<it>None</it> を選びます.

	<p>次に <it>ディスクラベルエディタ</it>に入ります. ここで
	BSD の伝統的パーティションをつくります. ディスクには a から h 
	までのラベルがついた 8区画のパーティションをつくることができます.
	一部のパーティションのラベルについては特別に扱われます.
	<it>a</it> パーティションは root パーティション (/) に
	使われます. したがって, システムディスク(すなわち ブートを行う
	ディスク)に 1つだけ<it>a</it> パーティションをつくるべきです.
	<it>b</it> パーティションは swap パーティションとして使われ
	ます. swap パーティションは複数のディスク上につくっても
	かまいません. <it>c</it>パーティションは「ディスク全体を使用」
	としている場合はディスク全体をさします. スライスを利用している
	場合は FreeBSD のスライス全体をさします. そのほかの
	パーティションは一般的な目的に利用します.

	<p> sysinstall のラベルエディタは root や swap 以外の
	パーティションでは <it>e</it> をつかうように勧めます。
	ラベルエディタでは単一のファイルシステムを作成するには 
	<it>C</it> コマンドをつかいます. 
	FS (ファイルシステム) か swap かを聞いてきますので ``FS'' を
	選びマウントポイントを入力(<tt>/mnt</tt>のように)します.
	インストール後の設定のモードではディスクの追加をするときに,
	sysinstall は <tt>/etc/fstab</tt> にエントリを作成しません.
	したがってここでのマウントポイントの入力は重要ではありません.

	<p>これでディスクへのディスクラベルの書き込みと
	ファイルシステムの作成の準備ができました. <it>W</it> を
	押してください. sysinstall が新しいパーティションがマウント
	できないことについてエラーを出しますが無視してください.
	ラベルエディタから抜けて sysinstall を終了してください.

	<p>最後のステップは <tt>/etc/fstab</tt> の編集で, 新しい
	ディスクのエントリを追加します.

    <sect><heading> コマンドラインユーティリティの利用</heading>

    <sect1><heading> * スライスを利用する</heading>

    <sect1><heading>ディスク全体を利用する</heading>
	<p> 新しいドライブを別のオペレーティングシステムで共有しない
	場合, ディスク全体を利用 (<it>dedicated)</it> mode) することも
	できます. このモードではダメージが与えられるということは
	ありませんが Microsoft のオペレーティングシステムが混乱する
	ということを覚えておいてください. 
	IBM の OS/2 では認識できない場合, すべて占有されていると
	解釈します.

    <tscreen><verb>
	dd if=/dev/zero of=/dev/rsd1 bs=1k count=1
	disklabel -Brw sd1 auto
	disklabel -e sd1				# `e' パーティションの作成
	newfs -d0 /dev/rsd1e
	mkdir -p /1
	vi /etc/fstab					# /dev/sd1e のエントリ
	mount /1
    </verb></tscreen>

	別の方法は:
	
    <tscreen><verb>
	dd if=/dev/zero of=/dev/rsd1 count=2
	disklabel /dev/rsd1 | disklabel -BrR sd1 /dev/stdin
	newfs /dev/rsd1e
	mkdir -p /1
	vi /etc/fstab					# /dev/sd1e のエントリ
	mount /1
    </verb></tscreen>


    <sect><heading> * 伝統的なものとは異なるドライブ</heading>
    <sect1><heading> * Zip ドライブ</heading>
    <sect1><heading> * Jazz ドライブ</heading>
    <sect1><heading> * Sequest ドライブ</heading>

