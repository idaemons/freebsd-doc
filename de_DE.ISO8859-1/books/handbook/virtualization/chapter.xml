<?xml version="1.0" encoding="iso-8859-1"?>
<!--
     The FreeBSD Documentation Project
     The FreeBSD German Documentation Project

     $FreeBSD$
     $FreeBSDde: de-docproj/books/handbook/virtualization/chapter.xml,v 1.14 2010/07/03 14:29:30 jkois Exp $
     basiert auf: r44406
-->
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="virtualization">
  <info><title>Virtualisierung</title>
    <authorgroup>
      <author><personname><firstname>Murray</firstname><surname>Stokely</surname></personname><contrib>Beigetragen von </contrib></author>
    </authorgroup>
    <authorgroup>
      <author>
	<personname>
	  <firstname>Allan</firstname>
	  <surname>Jude</surname>
	</personname>
	<contrib>bhyve Abschnitt beigetragen von </contrib>
      </author>
    </authorgroup>
    <authorgroup>
      <author><personname><firstname>Oliver</firstname><surname>Peter</surname></personname><contrib>Übersetzt von </contrib></author>
    </authorgroup>
  </info>

  <sect1 xml:id="virtualization-synopsis">
    <title>Übersicht</title>

    <para>Virtualisierungssoftware erlaubt es, mehrere Betriebssysteme
      gleichzeitig auf dem selben Computer laufen zu lassen.  Derartige
      Softwaresysteme für PCs setzen in der Regel ein
      Host-Betriebssystem voraus, auf dem die
      Virtualisierungssoftware läuft und unterstützen eine
      nahezu beliebige Anzahl von Gast-Betriebssystemen.</para>

    <para>Nachdem Sie dieses Kapitel gelesen haben,</para>

    <itemizedlist>
      <listitem>
	<para>Kennen Sie den Unterscheid zwischen einem
	  Host-Betriebssystem und einem Gast-Betriebssystem.</para>
      </listitem>

      <listitem>
	<para>Können Sie &os; auf einem &intel;-basierenden
	  &apple; &mac; installieren.</para>
      </listitem>

<!--
    Note:  There is no working/end-user ready Xen support for FreeBSD as of 07-2010.
           Hide all information regarding Xen under FreeBSD.

      <listitem>
	<para>Wissen Sie, wie man &os; unter Linux mit
	  <application>&xen;</application> installiert.</para>
      </listitem>
-->
      <listitem>
	<para>Können Sie &os; unter &microsoft.windows;
	  und <application>Virtual PC</application> installieren.</para>
      </listitem>

      <listitem>
	<para>Wissen Sie, wie man ein virtualisiertes &os;-System
	  für optimale Leistung konfiguriert.</para>
      </listitem>
    </itemizedlist>

    <para>Bevor Sie dieses Kapitel lesen, sollten Sie</para>

    <itemizedlist>
      <listitem>
	<para>Die <link linkend="basics">Grundlagen von &unix; und
	    &os;</link> verstehen.</para>
      </listitem>

      <listitem>
	<para>Wissen, wie Sie <link linkend="install">&os;
	    installieren</link> können.</para>
      </listitem>

      <listitem>
	<para>Wissen, wie Sie eine <link
	    linkend="advanced-networking">Netzwerkverbindung
	    konfigurieren</link>.</para>
      </listitem>

      <listitem>
	<para>Wissen, wie Sie <link linkend="ports">zusätzliche
	    Software installieren</link> können.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 xml:id="virtualization-guest">
    <title>&os; als Gast-Betriebssystem</title>

    <sect2 xml:id="virtualization-guest-parallels">
      <title><application>Parallels</application> unter
	&macos; X</title>

      <para><application>Parallels Desktop</application> für &mac;
	ist ein kommerzielles Softwareprodukt, welches für
	&intel;-basierende &apple; &mac;-Computer mit
	&macos;&nbsp;X&nbsp;10.4.6
	oder höher verfügbar ist.  &os; wird von diesem
	Softwarepaket als Gast-Betriebssystem vollständig
	unterstützt.  Nach der Installation von
	<application>Parallels</application> auf &macos;&nbsp;X
	konfigurieren Sie als erstes eine virtuelle Maschine,
	in der Sie danach das gewünschte Gast-Betriebssystem (in
	unserem Fall &os;) installieren.</para>

      <sect3 xml:id="virtualization-guest-parallels-install">
	<title>Installation von &os; unter
	  Parallels/&macos;&nbsp;X</title>

	<para>Der erste Schritt bei der Installation von &os; unter
	  <application>Parallels</application> ist es,
	  eine virtuelle Maschine zu konfigurieren, in der Sie
	  &os; installieren können.  Dazu wählen Sie bei
	  der Frage nach dem <guimenu>Guest OS Type</guimenu>
	  <guimenuitem>&os;</guimenuitem> aus:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd1"/>
	  </imageobject>
	</mediaobject>

	<para>Legen Sie geeignete Größen für
	  Festplatten- und Arbeitsspeicher für die zu erstellende
	  &os;-Instanz fest.  4&nbsp;GB Plattenplatz sowie
	  512&nbsp;MB RAM sind in der Regel für die Arbeit unter
	  <application>Parallels</application> ausreichend:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd2"/>
	  </imageobject>
	</mediaobject>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd3"/>
	  </imageobject>
	</mediaobject>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd4"/>
	  </imageobject>
	</mediaobject>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd5"/>
	  </imageobject>
	</mediaobject>

	<para>Wählen Sie den gewünschten Netzwerktyp
	  aus und konfigurieren Sie Ihre Netzwerkverbindung:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd6"/>
	  </imageobject>
	</mediaobject>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd7"/>
	  </imageobject>
	</mediaobject>

	<para>Speichern Sie Ihre Eingaben, um die Konfiguration
	  abzuschließen:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd8"/>
	  </imageobject>
	</mediaobject>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd9"/>
	  </imageobject>
	</mediaobject>

	<para>Nachdem Sie die virtuelle Maschine erstellt haben,
	  installieren Sie im nächsten Schritt &os; in dieser
	  virtuellen Maschine.  Dazu verwenden Sie am besten eine
	  offizielle &os;-CDROM oder Sie laden von einem offiziellen
	  FTP-Server ein ISO-Abbild auf Ihren &mac; herunter.  Danach
	  klicken Sie auf das Laufwerksymbol in der rechten unteren
	  Ecke des <application>Parallels</application>-Fensters, um
	  das virtuelles Laufwerk mit dem ISO-Abbild oder mit dem
	  physikalischen CD-ROM-Laufwerk des Computers zu
	  verknüpfen.</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd11"/>
	  </imageobject>
	</mediaobject>

	<para>Nachdem Sie diese Verknüpfung hergestellt haben,
	  starten sie die virtuelle &os;-Maschine neu, indem Sie
	  auf das Symbol <quote>Neustarten</quote> klicken.
	  <application>Parallels</application> startet nun ein
	  Spezial-BIOS, das zuerst prüft, ob eine CD-ROM eingelegt
	  wurde.</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd10"/>
	  </imageobject>
	</mediaobject>

	<para>In diesem Fall findet das BIOS ein
	  &os;-Installationsmedium und beginnt eine normale
	  Installation.  Versuchen Sie jetzt noch nicht
	  <application>&xorg;</application> zu konfigurieren.</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd12"/>
	  </imageobject>
	</mediaobject>

	<para>Nachdem die Installation abgeschlossen ist, können
	  Sie die virtuelle &os;-Maschine starten.</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/parallels-freebsd13"/>
	  </imageobject>
	</mediaobject>
      </sect3>

      <sect3 xml:id="virtualization-guest-parallels-configure">
	<title>&os; für den Einsatz unter
	  <application>Parallels</application> konfigurieren</title>

	<para>Nachdem &os; erfolgreich unter &macos;&nbsp;X mit
	  <application>Parallels</application> installiert wurde,
	  sollten Sie das virtuelles &os;-System für virtualisierte
	  Operationen optimieren:</para>

	<procedure>
	  <step>
	    <title>Setzen der Bootloader-Variablen</title>

	    <para>Die wichtigste Änderung ist es, die Variable
	      <option>kern.hz</option> zu verkleinern, um so die
	      CPU-Auslastung in der
	      <application>Parallels</application>-Umgebung zu
	      verringern.</para>

	    <programlisting>kern.hz=100</programlisting>

	    <para>Ohne diese Einstellung kann ein unbeschäftigtes
	      &os; unter <application>Parallels</application> trotzdem
	      rund 15 Prozent der CPU-Leistung eines Single Prozessor
	      &imac;'s verbrauchen.  Nach dieser Änderung reduziert
	      sich dieser Wert auf etwa 5 Prozent.</para>
	  </step>

	  <step>
	    <title>Erstellen einer neuen Kernelkonfigurationsdatei</title>

	    <para>Sie können alle SCSI-, FireWire- und
	      USB-Laufwerks-Treiber entfernen.
	      <application>Parallels</application> stellt einen
	      virtuellen Netzwerkadapter bereit, der den
	      &man.ed.4;-Treiber verwendet.  Daher können alle
	      Netzwerkgeräte bis auf &man.ed.4; und
	      &man.miibus.4; aus dem Kernel entfernt werden.</para>
	  </step>

	  <step>
	    <title>Netzwerkbetrieb einrichten</title>

	    <para>Die einfachste Netzwerkkonfiguration ist der Einsatz
	      von DHCP, um die virtuelle Maschine mit dem gleichen
	      lokalen Netzwerk, in dem sich der Host-&mac; befindet, zu
	      verbinden.  Dazu fügen Sie die Zeile
	      <literal>ifconfig_ed0="DHCP"</literal> in
	      <filename>/etc/rc.conf</filename> ein.  Weitere
	      Informationen zur Konfiguration des Netzwerks unter
	      &os; finden Sie im
	      <xref linkend="advanced-networking"/>.</para>
	  </step>
        </procedure>
      </sect3>
    </sect2>

<!--
  	 Deactive/hide this section as the instruction in there do NOT work anyore:
  	 - FreeBSD 7.0 has reached its EOL a long time ago.
  	 - The needed files from www.fsmware.com are not available anymore, as the
  	   server is dead.  So it is impossible to follow the instructions in here.

  	 jkois@FreeBSD.org, 2010-06-18

    <sect2 id="virtualization-guest-xen">
      <sect2info>
	<authorgroup>
	  <author>
	    <firstname>Fukang</firstname>
	    <surname>Chen (Loader)</surname>
	    <contrib>Beigetragen von </contrib>
	  </author>
	</authorgroup>
      </sect2info>

      <title>&os; mit &xen; unter Linux einsetzen</title>

      <para>Der <application>&xen;</application> Hypervisor ist ein
	als Open Source verfügbares Para-Virtualisierungsprodukt,
	das von der kommerziellen Firma XenSource unterstützt wird.
	Gast-Betriebssysteme werden dabei als domU-Domains,
	Host-Betriebssysteme hingegen als dom0 bezeichnet.  Um eine
	virtuelle &os;-Instanz unter Linux auszuführen,
	müssen Sie zuerst <application>&xen;</application>
	für Linux dom0 installieren.  Als Host-Betriebssystem
	wird im folgenden Beispiel die Distribution Slackware
	verwendet.</para>

      <sect3 id="xen-slackware-dom0">
	<title>&xen;&nbsp;3 unter Linux dom0</title>

	<procedure>
	  <step>
	    <title>&xen; 3.0 von XenSource herunterladen</title>

	    <para>Laden Sie die Datei <ulink
	      url="http://bits.xensource.com/oss-xen/release/3.0.4-1/src.tgz/xen-3.0.4_1-src.tgz">xen-3.0.4_1-src.tgz</ulink>
	      von <ulink url="http://www.xensource.com/"></ulink>
	      herunter.</para>
	  </step>

	  <step>
	    <title>Den Tarball entpacken</title>

	    <screen>&prompt.root; <userinput>cd xen-3.0.4_1-src</userinput>
&prompt.root; <userinput>KERNELS="linux-2.6-xen0 linux-2.6-xenU" make world</userinput>
&prompt.root; <userinput>make install</userinput></screen>

	    <note>
	      <para>Den dom0-Kernel neu kompilieren:</para>

	      <screen>&prompt.root; <userinput>cd xen-3.0.4_1-src/linux-2.6.16.33-xen0</userinput>
&prompt.root; <userinput>make menuconfig</userinput>
&prompt.root; <userinput>make</userinput>
&prompt.root; <userinput>make install</userinput></screen>

	      <para>Ältere Versionen von
		<application>&xen;</application> müssen
		gegebenenfalls mit
		<command>make ARCH=xen menuconfig</command> näher
		spezifiziert werden.</para>
	    </note>
	  </step>

	  <step>
	    <title>Einen Menü-Eintrag in die menu.lst von Grub
	      aufnehmen</title>

	    <para>Editieren Sie <filename>/boot/grub/menu.lst</filename>
	      und fügen Sie die folgenden Zeilen hinzu:</para>

	    <programlisting>title Xen-3.0.4
root (hd0,0)
kernel /boot/xen-3.0.4-1.gz dom0_mem=262144
module /boot/vmlinuz-2.6.16.33-xen0 root=/dev/hda1 ro</programlisting>
	  </step>

	  <step>
	    <title>Starten Sie Ihren Computer neu, um &xen; zu
	      aktivieren</title>

	    <para>Anschließend editieren Sie
	      <filename>/etc/xen/xend-config.sxp</filename> und
	      fügen die folgenden Zeilen hinzu:</para>

	    <programlisting>(network-script 'network-bridge netdev=eth0')</programlisting>

	    <para>Danach kann <application>&xen;</application>
	      gestartet werden:</para>

	    <screen>&prompt.root; <userinput>/etc/init.d/xend start</userinput>
&prompt.root; <userinput>/etc/init.d/xendomains start</userinput></screen>

	    <para>Damit ist dom0 gestartet:</para>

	    <screen>&prompt.root; <userinput>xm list</userinput>
Name                                      ID   Mem VCPUs      State   Time(s)
Domain-0                                   0   256     1     r&ndash;&ndash;&ndash;&ndash;&ndash;  54452.9</screen>
	  </step>
	</procedure>
      </sect3>

      <sect3>
	<title>&os;&nbsp;7-CURRENT als domU verwenden</title>

	<para>Laden Sie den &os;-domU-Kernel für
	  <application>&xen; 3.0</application> sowie
	  das Festplattenabbild von <ulink
          url="http://www.fsmware.com/">http://www.fsmware.com/</ulink>
	  herunter:</para>

	<itemizedlist>
	  <listitem>
	    <para><ulink url="http://www.fsmware.com/xenofreebsd/7.0/download/kernel-current">kernel-current</ulink></para>
	  </listitem>

	  <listitem>
	    <para><ulink url="http://www.fsmware.com/xenofreebsd/7.0/download/mdroot-7.0.bz2">mdroot-7.0.bz2</ulink></para>
	  </listitem>

	  <listitem>
	  <para><ulink url="http://www.fsmware.com/xenofreebsd/7.0/download/config/xmexample1.bsd">xmexample1.bsd</ulink></para>
	  </listitem>
	</itemizedlist>

	<para>Kopieren Sie <filename>xmexample1.bsd</filename>
	  nach <filename>/etc/xen/</filename> und passen Sie
	  die Einträge für Kernel und Festplattenabbild an
	  Ihre Konfiguration an.  Ihre Konfiguration sollte
	  ähnlich dem folgenden Beispiel aussehen:</para>

	<programlisting>kernel = "/opt/kernel-current"
memory = 256
name = "freebsd"
vif = [ '' ]
disk = [ 'file:/opt/mdroot-7.0,hda1,w' ]
#on_crash    = 'preserve'
extra = "boot_verbose"
extra += ",boot_single"
extra += ",kern.hz=100"
extra += ",vfs.root.mountfrom=ufs:/dev/xbd769a"</programlisting>

	<para>Die Datei <filename>mdroot-7.0.bz2</filename> sollte
	  unkomprimiert sein.</para>

	<para>Als Nächstes muss der __xen_guest-Abschnitt in
	  <filename>kernel-current</filename> verändert und das
	  von <application>&xen; 3.0.3</application> benötigte
	  VIRT_BASE hinzugefügt werden:</para>

	<screen>&prompt.root; <userinput>objcopy kernel-current -R __xen_guest</userinput>
&prompt.root; <userinput>perl -e 'print "LOADER=generic,GUEST_OS=freebsd,GUEST_VER=7.0,XEN_VER=xen-3.0,BSD_SYMTAB,VIRT_BASE=0xC0000000\x00"' &gt; tmp</userinput>
&prompt.root; <userinput>objcopy kernel-current &ndash;&ndash;add-section __xen_guest=tmp</userinput></screen>

	<screen>&prompt.root; <userinput>objdump -j __xen_guest -s kernel-current</userinput>

kernel-current:     file format elf32-i386

Contents of section __xen_guest:
 0000 4c4f4144 45523d67 656e6572 69632c47  LOADER=generic,G
 0010 55455354 5f4f533d 66726565 6273642c  UEST_OS=freebsd,
 0020 47554553 545f5645 523d372e 302c5845  GUEST_VER=7.0,XE
 0030 4e5f5645 523d7865 6e2d332e 302c4253  N_VER=xen-3.0,BS
 0040 445f5359 4d544142 2c564952 545f4241  D_SYMTAB,VIRT_BA
 0050 53453d30 78433030 30303030 3000      SE=0xC0000000. </screen>

	<para>Nun kann die domU erstellt und gestartet werden:</para>

	<screen>&prompt.root; <userinput>xm create /etc/xen/xmexample1.bsd -c</userinput>
Using config file "/etc/xen/xmexample1.bsd".
Started domain freebsd
WARNING: loader(8) metadata is missing!
Copyright (c) 1992-2006 The FreeBSD Project.
Copyright (c) 1979, 1980, 1983, 1986, 1988, 1989, 1991, 1992, 1993, 1994
The Regents of the University of California. All rights reserved.
FreeBSD 7.0-CURRENT #113: Wed Jan  4 06:25:43 UTC 2006
    kmacy@freebsd7.gateway.2wire.net:/usr/home/kmacy/p4/freebsd7_xen3/src/sys/i386-xen/compile/XENCONF
WARNING: DIAGNOSTIC option enabled, expect reduced performance.
Xen reported: 1796.927 MHz processor.
Timecounter "ixen" frequency 1796927000 Hz quality 0
CPU: Intel(R) Pentium(R) 4 CPU 1.80GHz (1796.93-MHz 686-class CPU)
  Origin = "GenuineIntel"  Id = 0xf29  Stepping = 9
  Features=0xbfebfbff&lt;FPU,VME,DE,PSE,TSC,MSR,PAE,MCE,CX8,APIC,SEP,MTRR,PGE,MCA,CMOV,PAT,PSE36,CLFLUSH,
  DTS,ACPI,MMX,FXSR,SSE,SSE2,SS,HTT,TM,PBE&gt;
  Features2=0x4400&lt;CNTX-ID,&lt;b14&gt;&gt;
real memory  = 265244672 (252 MB)
avail memory = 255963136 (244 MB)
xc0: &lt;Xen Console&gt; on motherboard
cpu0 on motherboard
Timecounters tick every 10.000 msec
[XEN] Initialising virtual ethernet driver.
xn0: Ethernet address: 00:16:3e:6b:de:3a
[XEN]
Trying to mount root from ufs:/dev/xbd769a
WARNING: / was not properly dismounted
Loading configuration files.
No suitable dump device was found.
Entropy harvesting: interrupts ethernet point_to_point kickstart.
Starting file system checks:
/dev/xbd769a: 18859 files, 140370 used, 113473 free (10769 frags, 12838 blocks, 4.2% fragmentation)
Setting hostname: demo.freebsd.org.
lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384
	  inet6 ::1 prefixlen 128
	  inet6 fe80::1%lo0 prefixlen 64 scopeid 0x2
	  inet 127.0.0.1 netmask 0xff000000
Additional routing options:.
Mounting NFS file systems:.
Starting syslogd.
/etc/rc: WARNING: Dump device does not exist.  Savecore not run.
ELF ldconfig path: /lib /usr/lib /usr/lib/compat /usr/X11R6/lib /usr/local/lib
a.out ldconfig path: /usr/lib/aout /usr/lib/compat/aout /usr/X11R6/lib/aout
Starting usbd.
usb: Kernel module not available: No such file or directory
Starting local daemons:.
Updating motd.
Starting sshd.
Initial i386 initialization:.
Additional ABI support: linux.
Starting cron.
Local package initialization:.
Additional TCP options:.
Starting background file system checks in 60 seconds.

Sun Apr  1 02:11:43 UTC 2007

FreeBSD/i386 (demo.freebsd.org) (xc0)

login: </screen>

	<para>Die domU sollte nun den
	  &os;&nbsp;7.0-CURRENT-Kernel ausführen:</para>

	<screen>&prompt.root; <userinput>uname -a</userinput>
FreeBSD demo.freebsd.org 7.0-CURRENT FreeBSD 7.0-CURRENT #113: Wed Jan  4 06:25:43 UTC 2006
kmacy@freebsd7.gateway.2wire.net:/usr/home/kmacy/p4/freebsd7_xen3/src/sys/i386-xen/compile/XENCONF  i386</screen>

	<para>Das Netzwerk kann nun unter der domU konfiguriert werden.
	  Die &os;-domU wird ein spezielles Gerät namens
	  <devicename>xn0</devicename> verwenden:</para>

	<screen>&prompt.root; <userinput>ifconfig xn0 10.10.10.200 netmask 255.0.0.0</userinput>
&prompt.root; <userinput>ifconfig</userinput>
xn0: flags=843&lt;UP,BROADCAST,RUNNING,SIMPLEX&gt; mtu 1500
    inet 10.10.10.200 netmask 0xff000000 broadcast 10.255.255.255
    ether 00:16:3e:6b:de:3a
lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384
      inet6 ::1 prefixlen 128
      inet6 fe80::1%lo0 prefixlen 64 scopeid 0x2
      inet 127.0.0.1 netmask 0xff000000 </screen>

	<para>Unter der Slackware-dom0 sollten einige
	  <application>&xen;</application>-spezifische
	  Netzwerkgeräte erscheinen:</para>

	<screen>&prompt.root; <userinput>ifconfig</userinput>
eth0      Link encap:Ethernet  HWaddr 00:07:E9:A0:02:C2
          inet addr:10.10.10.130  Bcast:0.0.0.0  Mask:255.0.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:815 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1400 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:204857 (200.0 KiB)  TX bytes:129915 (126.8 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:99 errors:0 dropped:0 overruns:0 frame:0
          TX packets:99 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:9744 (9.5 KiB)  TX bytes:9744 (9.5 KiB)

peth0     Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:1853349 errors:0 dropped:0 overruns:0 frame:0
          TX packets:952923 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:2432115831 (2.2 GiB)  TX bytes:86528526 (82.5 MiB)
          Base address:0xc000 Memory:ef020000-ef040000

vif0.1    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:1400 errors:0 dropped:0 overruns:0 frame:0
          TX packets:815 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:129915 (126.8 KiB)  TX bytes:204857 (200.0 KiB)

vif1.0    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:3 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2 errors:0 dropped:157 overruns:0 carrier:0
          collisions:0 txqueuelen:1
          RX bytes:140 (140.0 b)  TX bytes:158 (158.0 b)

xenbr1    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:4 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:112 (112.0 b)  TX bytes:0 (0.0 b)</screen>

	<screen>&prompt.root; <userinput>brctl show</userinput>
bridge name     bridge id           STP enabled         interfaces
xenbr1          8000.feffffffffff   no                  vif0.1
                                                        peth0
                                                        vif1.0</screen>
      </sect3>
    </sect2>
-->
    <sect2 xml:id="virtualization-guest-virtualpc">
        <info>
	  <title><application>Virtual PC</application> unter
	    &windows;</title>

          <authorgroup>
            <author><personname><firstname>Johann</firstname><surname>Kois</surname></personname><contrib>Übersetzt von </contrib></author>
          </authorgroup>
        </info>

      <para><application>Virtual PC</application> für &windows; wird
	von &microsoft; kostenlos zum Download angeboten.  Die
	Systemanforderungen für dieses Programm finden Sie <link
	  xlink:href="http://www.microsoft.com/windows/downloads/virtualpc/sysreq.mspx">
	  hier</link>.  Nachdem <application>Virtual PC</application>
	unter &microsoft.windows; installiert wurde, muss eine
	virtuelle Maschine konfiguriert und das gewünschte
	Betriebssystem installiert werden.</para>

	<sect3 xml:id="virtualization-guest-virtualpc-install">
	  <title>&os; in <application>Virtual PC</application>
	    installieren</title>

	  <para>Der erste Schritt zur Installation von &os; in
	    <application>Virtual PC</application> ist es, eine neue
	    virtuelle Maschine zu erstellen, in die Sie &os;
	    installieren können.  Dazu wählen Sie die Option
	    <guimenuitem>Create a virtual machine</guimenuitem>,
	    wenn Sie danach gefragt werden:</para>

	  <mediaobject>
            <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd1"/>
            </imageobject>
          </mediaobject>

	  <mediaobject>
            <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd2"/>
            </imageobject>
          </mediaobject>

	  <para>Bei der Frage nach dem
	    <guimenuitem>Operating system</guimenuitem> wählen Sie
	    <guimenuitem>Other</guimenuitem>:</para>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd3"/>
	    </imageobject>
	  </mediaobject>

	  <para>Danach müssen Sie den gewünschten Plattenplatz sowie
	    die Größe des Hauptspeichers angeben.  4&nbsp;GB
	    Plattenplatz sowie 512&nbsp;MB RAM sollten für die
	    Installation von &os; in
	    <application>Virtual PC</application> ausreichend
	    sein:</para>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd4"/>
	    </imageobject>
	  </mediaobject>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd5"/>
	    </imageobject>
	  </mediaobject>

	  <para>Speichern Sie die Eingaben und beenden Sie die
	    Konfiguration:</para>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd6"/>
	    </imageobject>
	  </mediaobject>

	  <para>Wählen Sie nun die für &os; erstellte
	    virtuelle Maschine aus und klicken Sie auf
	    <guimenu>Settings</guimenu>, um das Netzwerk zu
	    konfigurieren:</para>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd7"/>
	    </imageobject>
	  </mediaobject>

	  <mediaobject>
            <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd8"/>
            </imageobject>
          </mediaobject>

	  <para>Nachdem die virtuelle Maschine erstellt wurde, können
	    Sie &os; installieren.  Dazu verwenden Sie am besten eine
	    offizielle &os;-CD-ROM oder ein ISO-Image, das Sie von einem offiziellen
	    &os;-FTP-Server heruntergeladen haben.  Wenn Sie ein
	    ISO-Image auf der Festplatte gespeichert haben, oder
	    eine &os;-CD-ROM in das CD-Laufwerk eingelegt haben,
	    doppelklicken Sie auf die virtuelle Maschine, die Sie
	    für &os; angelegt haben.  Danach klicken Sie
	    auf <guimenu>CD</guimenu> und wählen die Option
	    <guimenu>Capture ISO Image...</guimenu> im
	    <application>Virtual PC</application>-Fenster.  Danach
	    können Sie im folgenden Fenster das CD-Laufwerk
	    mit dem physikalischen CD-Laufwerk oder mit dem
	    ISO-Image verknüpfen.</para>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd9"/>
	    </imageobject>
	  </mediaobject>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd10"/>
	    </imageobject>
	  </mediaobject>

	  <para>Danach starten Sie die virtuelle Maschine neu, indem
	    Sie zuerst auf <guimenu>Action</guimenu> und danach auf
	    <guimenu>Reset</guimenu> klicken.
	    <application>Virtual PC</application> startet die
	    virtuelle Maschine nun neu und prüft zuerst, ob
	    die virtuelle Maschine über ein CD-Laufwerk
	    verfügt.</para>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd11"/>
	    </imageobject>
	  </mediaobject>

	  <para>Da dies hier der Fall ist, beginnt nun eine normale
	    &os;-Installation.  Sie können &os; nun installieren, aber
	    verzichten Sie an dieser Stelle unbedingt auf die
	    <application>&xorg;</application>-Konfiguration.</para>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd12"/>
	    </imageobject>
	  </mediaobject>

	  <para>Nachdem die Installation abgeschlossen ist, entfernen
	    Sie die CD-ROM aus dem Laufwerk (oder lösen die
	    Verknüpfung zum ISO-Image).  Danach starten Sie die
	    virtuelle Maschine neu, um &os; zu starten.</para>

	  <mediaobject>
	    <imageobject>
	      <imagedata fileref="virtualization/virtualpc-freebsd13"/>
	    </imageobject>
	  </mediaobject>
      </sect3>

      <sect3 xml:id="virtualization-guest-virtualpc-configure">
	<title>&os; in <application>Virtual PC</application>
	  konfigurieren</title>

	<para>Nachdem &os; auf &microsoft.windows; mit
	  <application>Virtual PC</application> erfolgreich
	  installiert wurde, sollten Sie das virtuelles &os; noch
	  anpassen, um eine optimale Funktion zu
	  gewährleisten.</para>

        <procedure>
	  <step>
	    <title>Setzen der Bootloader-Variablen</title>

	    <para>Die wichtigste Änderung ist es, die Variable
	      <option>kern.hz</option> zu verkleinern, um so die
	      CPU-Auslastung in der
	      <application>Virtual PC</application>-Umgebung zu
	      verringern.  Dazu fügen Sie die folgende Zeile
	      in <filename>/boot/loader.conf</filename>
	      ein:</para>

	    <programlisting>kern.hz=100</programlisting>

	    <para>Ohne diese Einstellung kann ein unbeschäftigtes
	      &os; unter <application>Virutal PC</application>
	      trotzdem rund 40 Prozent der CPU-Leistung eines
	      Ein-Prozessor-Systems verbrauchen.  Nach dieser
	      Änderung reduziert sich dieser Wert auf etwa
	      3 Prozent.</para>
	  </step>

	  <step>
	    <title>Erstellen einer neuen
	      Kernelkonfigurationsdatei</title>

	    <para>Alle SCSI-, FireWire- und USB-Laufwerks-Treiber
	      können aus der Kernelkonfigurationsdatei entfernt
	      werden.  <application>Virtual PC</application> stellt
	      einen virtuellen Netzwerkadapter bereit, der den
	      &man.de.4;-Treiber verwendet.  Daher können alle
	      Netzwerkgeräte bis auf &man.de.4; und
	      &man.miibus.4; aus dem Kernel entfernt werden.</para>
	  </step>

	  <step>
	    <title>Das Netzwerk einrichten</title>

	    <para>Die einfachste Netzwerkkonfiguration nutzt
	      von DHCP, um die virtuelle Maschine mit dem gleichen
	      lokalen Netzwerk, in dem sich der
	      Host-&microsoft.windows; befindet, zu verbinden.  Dazu
	      fügen Sie die Zeile
	      <literal>ifconfig_de0="DHCP"</literal> in
	      <filename>/etc/rc.conf</filename> ein.  Weitere
	      Informationen zur Konfiguration des Netzwerks unter
	      &os; finden Sie in  <link
		linkend="advanced-networking"/>.</para>
	  </step>
        </procedure>
      </sect3>
    </sect2>

    <sect2 xml:id="virtualization-guest-vmware">
        <info>
	  <title><application>VMware Fusion</application> unter
	    &macos;</title>

          <authorgroup>
            <author><personname><firstname>Johann</firstname><surname>Kois</surname></personname><contrib>Übersetzt von </contrib></author>
          </authorgroup>
        </info>

      <para><application>VMware Fusion</application> für &mac;
	ist ein kommerzielles Programm, das für
	&intel; basierte &apple; &mac;-Computer mit
	&macos; 10.4.9 oder neuer erhältlich ist.  &os; wird
	von diesem Produkt vollständig als Gast-Betriebssystem
	unterstützt.  Nachdem Sie
	<application>VMware Fusion</application> unter &macos; X
	installiert haben, können Sie eine virtuelle Maschine
	konfigurieren und das gewünschte Gastbetriebssystem
	installieren.</para>

      <sect3 xml:id="virtualization-guest-vmware-install">
	<title>&os; in <application>VMware Fusion</application>
	  installieren</title>

	<para>Zuerst müssen Sie <application>VMware
	    Fusion</application> starten, um eine
	  virtuelle Maschine zu erstellen.  Dazu wählen Sie die
	  Option <guimenuitem>New</guimenuitem>:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd01"/>
	  </imageobject>
	</mediaobject>

	<para>Dadurch wird ein Assistent gestartet, der bei der
	  Erzeugung einer neuen virtuellen Maschine behilflich ist.
	  Klicken Sie auf <guimenuitem>Continue</guimenuitem>, um den
	  Prozess zu starten:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd02"/>
	  </imageobject>
	</mediaobject>

	<para>Wählen Sie <guimenuitem>Other</guimenuitem> als das
	  <guimenuitem>Operating System</guimenuitem>, danach
	  <guimenuitem>&os;</guimenuitem> oder
	  <guimenuitem>&os; 64-bit</guimenuitem>, je nach dem,
	  welche Version Sie installieren wollen, wenn Sie nach
	  der zu installierenden <guimenu>Version</guimenu>
	  gefragt werden:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd03"/>
	  </imageobject>
	</mediaobject>

	<para>Vergeben Sie einen Namen für die virtuelle Maschine
	  und legen Sie den Speicherort fest:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd04"/>
	  </imageobject>
	</mediaobject>

	<para>Legen Sie die Größe der virtuellen Festplatte für die
	  virtuelle Maschine fest:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd05"/>
	  </imageobject>
	</mediaobject>

	<para>Wählen Sie die Installationsmethode für die virtuelle
	  Maschine.  Entweder von einem ISO-Abbild oder von einer
	  CD/DVD:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd06"/>
	  </imageobject>
	</mediaobject>

	<para>Nachdem Sie auf <guimenuitem>Finish</guimenuitem>
	  geklickt haben, wird die virtuelle Maschine
	  gestartet:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd07"/>
	  </imageobject>
	</mediaobject>

	<para>Nun können Sie &os; wie gewohnt installieren:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd08"/>
	  </imageobject>
	</mediaobject>

	<para>Nachdem die Installation abgeschlossen ist, können
	  noch verschiedene Parameter der virtuellen Maschine, wie
	  etwa der Speicherverbrauch, konfiguriert werden:</para>

	<note>
	  <para>Die Hardware der virtuellen Maschine kann nicht
	    geändert werden, solange die virtuelle Maschine
	    läuft.</para>
        </note>

	<mediaobject>
          <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd09"/>
          </imageobject>
        </mediaobject>

	<para>Die Anzahl der CPUs der virtuellen Maschine:</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd10"/>
	  </imageobject>
	</mediaobject>

	<para>Den Status des CD-Laufwerks.  Sie können die
	  CD/DVD/ISO von der virtuellen Maschine lösen, wenn
	  Sie es nicht benötigen.</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd11"/>
	  </imageobject>
	</mediaobject>

	<para>Zuletzt sollten Sie noch festlegen, wie sich die
	  virtuelle Maschine mit dem Netzwerk verbinden soll.  Sollen
	  neben dem Gastsystem auch andere Rechner auf die virtuelle
	  Maschine zugreifen können, muss die Option
	  <guimenuitem>Connect directly to the physical network
	  (Bridged)</guimenuitem> gewählt werden.  Ist dies nicht der
	  Fall, sollte die Option <guimenuitem>Share the
	  host's internet connection (NAT)</guimenuitem> gewählt
	  werden.  In dieser Einstellung kann die virtuelle Maschine
	  zwar auf auf das Internet zugreifen, andere Rechner dürfen
	  aber nicht auf die virtuelle Maschine zugreifen.</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="virtualization/vmware-freebsd12"/>
	  </imageobject>
	</mediaobject>

	<para>Nachdem die Konfiguration abgeschlossen ist, kann &os;
	  gestartet werden.</para>
      </sect3>

      <sect3 xml:id="virtualization-guest-vmware-configure">
	<title>&os; unter <application>VMware Fusion</application>
	  konfigurieren</title>

	<para>Nachdem Sie &os; erfolgreich unter
	  <application>VMware Fusion</application> installiert haben,
	  sollten Sie das virtuelles &os; noch anpassen, um eine
	  optimale Funktion zu gewährleisten.</para>

        <procedure>
	  <step>
	    <para>Die wichtigste Änderung ist es, die Variable
	      <option>kern.hz</option> zu verkleinern, um so die
	      CPU-Auslastung in der
	      <application>VMware Fusion</application>-Umgebung zu
	      verringern.</para>

	    <programlisting>kern.hz=100</programlisting>

	    <para>Ohne diese Einstellung kann ein unbeschäftigtes
	      &os; unter <application>VMware Fusion</application> trotzdem
	      rund 15 Prozent der CPU-Leistung eines Single Prozessor
	      &imac;'s verbrauchen.  Nach dieser Änderung reduziert
	      sich dieser Wert auf etwa 5 Prozent.</para>
	  </step>

	  <step>
	    <title>Erstellen einer neuen Kernelkonfigurationsdatei</title>

	    <para>Alle FireWire- und USB-Laufwerks-Treiber können aus
	      der Kernelkonfigurationsdatei entfernt werden.
	      <application>VMware Fusion</application> stellt einen
	      virtuellen Netzwerkadapter bereit, der den
	      &man.em.4;-Treiber verwendet.  Daher können alle
	      Netzwerkgeräte bis auf &man.em.4; und
	      &man.miibus.4; aus dem Kernel entfernt werden.</para>
	  </step>

	  <step>
	    <title>Netzwerkbetrieb einrichten</title>

	    <para>Die einfachste Netzwerkkonfiguration verwendet DHCP,
	      um die virtuelle Maschine mit dem gleichen lokalen
	      Netzwerk, in dem sich der Host-&mac; befindet, zu
	      verbinden.  Dazu fügen Sie die Zeile
	      <literal>ifconfig_em0="DHCP"</literal> in
	      <filename>/etc/rc.conf</filename> ein.  Weitere
	      Informationen zur Konfiguration des Netzwerks unter
	      &os; finden Sie im  <xref
		linkend="advanced-networking"/>.</para>
	  </step>
        </procedure>
      </sect3>
    </sect2>

    <sect2 xml:id="virtualization-guest-virtualbox-guest-additions">
      <title>&virtualbox; Gasterweiterungen auf einem &os;
	Gast</title>

      <para>Die &virtualbox; Gasterweiterungen bieten Unterstützung
	für:</para>

      <itemizedlist>
	<listitem>
	  <para>Gemeinsame Zwischenablage.</para>
	</listitem>

	<listitem>
	  <para>Mauszeiger-Integration.</para>
	</listitem>

	<listitem>
	  <para>Zeitsynchronisation mit dem Host.</para>
	</listitem>

	<listitem>
	  <para>Skalierung von Fenstern.</para>
	</listitem>

	<listitem>
	  <para>Nahtloser Modus.</para>
	</listitem>
      </itemizedlist>

      <note>
	<para>Die folgenden Kommandos werden im &os; Gastsystem
	  ausgeführt.</para>
      </note>

      <para>Installieren Sie das Paket oder den Port
	<package>emulators/virtualbox-ose-additions</package> in das
	&os; Gastsystem.  Dieses Beispiel installiert den Port:</para>

      <screen>&prompt.root; <userinput>cd /usr/ports/emulators/virtualbox-ose-additions</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

      <para>Fügen Sie folgende Einträge in
	<filename>/etc/rc.conf</filename> hinzu:</para>

      <programlisting>vboxguest_enable="YES"
vboxservice_enable="YES"</programlisting>

      <para>Wenn &man.ntpd.8; oder &man.ntpdate.8; verwendet wird um
	die Uhrzeit zu synchronisieren, dann deaktivieren Sie die
	Synchronisierung mit dem Host:</para>

      <programlisting>vboxservice_flags"--disable-timesync"</programlisting>

      <para>Der <literal>vboxvideo_drv</literal>-Treiber sollte von
	<command>Xorg -configure</command> automatisch erkannt werden.
	Alternativ kann auch manuell ein entsprechender Eintrag in
	<filename>/etc/X11/xorg.conf</filename> hinzugefügt
	werden:</para>

      <programlisting>Section "Device"
	  Identifier "Card0"
	  Driver "vboxvideo"
	  VendorName "InnoTek Systemberatung GmbH"
	  BoardName "VirtualBox Graphics Adapter"
EndSection</programlisting>

      <para>Um den <literal>vboxmouse_drv</literal>-Treiber zu
      verwenden, muss <filename>/etc/X11/xorg.conf</filename>
      ebenfalls angepasst werden:</para>

      <programlisting>Section "InputDevice"
	  Identifier "Mouse0"
	  Driver "vboxmouse"
EndSection</programlisting>

      <para>Benutzer von <acronym>HAL</acronym> sollten die Datei
	<filename>/usr/local/etc/hal/fdi/policy/90-vboxguest.fdi</filename>
	erstellen oder sie aus
	<filename>/usr/local/share/hal/fdi/policy/10osvendor/90-vboxguest.fdi</filename>
	kopieren:</para>

      <programlisting>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;!--
# Sun VirtualBox
# Hal driver description for the vboxmouse driver
# $Id: chapter.xml,v 1.33 2012-03-17 04:53:52 eadler Exp $

	Copyright (C) 2008-2009 Sun Microsystems, Inc.

	This file is part of VirtualBox Open Source Edition (OSE, as
	available from http://www.virtualbox.org. This file is free software;
	you can redistribute it and/or modify it under the terms of the GNU
	General Public License (GPL) as published by the Free Software
	Foundation, in version 2 as it comes in the "COPYING" file of the
	VirtualBox OSE distribution. VirtualBox OSE is distributed in the
	hope that it will be useful, but WITHOUT ANY WARRANTY of any kind.

	Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa
	Clara, CA 95054 USA or visit http://www.sun.com if you need
	additional information or have any questions.
--&gt;
&lt;deviceinfo version="0.2"&gt;
  &lt;device&gt;
    &lt;match key="info.subsystem" string="pci"&gt;
      &lt;match key="info.product" string="VirtualBox guest Service"&gt;
	&lt;append key="info.capabilities" type="strlist"&gt;input&lt;/append&gt;
	&lt;append key="info.capabilities" type="strlist"&gt;input.mouse&lt;/append&gt;
	&lt;merge key="input.x11_driver" type="string"&gt;vboxmouse&lt;/merge&gt;
	&lt;merge key="input.device" type="string"&gt;/dev/vboxguest&lt;/merge&gt;
      &lt;/match&gt;
    &lt;/match&gt;
  &lt;/device&gt;
&lt;/deviceinfo&gt;</programlisting>
    </sect2>
  </sect1>

  <sect1 xml:id="virtualization-host-virtualbox">
    <info><title>&os; als Host mit
      <application>Virtualbox</application></title>

      <authorgroup>
        <author><personname><firstname>Benedict</firstname><surname>Reuschling</surname></personname><contrib>Übersetzt von </contrib></author>
        <author><personname><firstname>Christoph</firstname><surname>Sold</surname></personname></author>
      </authorgroup>
    </info>

    <para><application>&virtualbox;</application> ist ein vollständiges
      Virtualisierungspaket, das aktiv weiterentwickelt wird und für die
      meisten Betriebssysteme einschliesslich &windows;, &macos;, &linux; und
      &os; zur Verfügung steht.  Es kann sowohl &windows; als auch
      &unix;-ähnliche Gastsysteme betreiben.  Es wird als
      Open Source Software veröffentlicht, jedoch mit
      Closed-Source-Komponenten in einem separaten Erweiterungspaket.
      Zu diesen Komponenten gehört Unterstützung für
      <acronym>USB</acronym>&nbsp;2.0-Geräte.  Weitere Informationen
      finden Sie auf der <link
	xlink:href="http://www.virtualbox.org/wiki/Downloads">
	<quote>Downloads</quote>-Seite im
	<application>&virtualbox;</application> Wiki</link>.  Derzeit
      sind diese Erweiterungen für &os; nicht verfügbar.</para>

    <sect2 xml:id="virtualization-virtualbox-install">
      <title>&virtualbox; installieren</title>

      <para><application>&virtualbox;</application> steht als
	Paket oder Port in <package>emulators/virtualbox-ose</package>
	bereit.  Der Port kann mit folgendem Kommando installiert
	werden:</para>

      <screen>&prompt.root; <userinput>cd /usr/ports/emulators/virtualbox-ose</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

      <para>Eine nützliche Option im Konfigurationsdialog ist die
        <literal>GuestAdditions</literal>-Programmsammlung.  Diese stellen
        eine Reihe von nützlichen Eigenschaften in den
        Gastbetriebssystemen zur Verfügung, wie beispielsweise
        Mauszeigerintegration (was es ermöglicht, die Maus zwischen
        dem Host und dem Gast zu teilen ohne eine spezielle Tastenkombination
        für diesen Wechsel zu drücken), sowie schnelleres Rendern
        von Videos, besonders in &windows; Gästen.  Diese Gastzusätze
        sind im <guimenu>Devices</guimenu>-Menü zu finden, nachdem die
        Installation des Gastbetriebssystem abgeschlossen ist.</para>

      <para>Ein paar Konfigurationsänderungen sind notwendig, bevor
        <application>&virtualbox;</application> das erste Mal gestartet wird.
        Der Port installiert ein Kernelmodul in <filename>/boot/modules</filename>, das in den laufenden
        Kernel geladen werden muss:</para>

      <screen>&prompt.root; <userinput>kldload vboxdrv</userinput></screen>

      <para>Um sicherzustellen, dass das Modul immer nach einem Neustart
        geladen wird, fügen Sie die folgende Zeile in die Datei
        <filename>/boot/loader.conf</filename> ein:</para>

      <programlisting>vboxdrv_load="YES"</programlisting>

      <para>Um die Kernelmodule für die Unterstützung von
	Netzwerkbrücken oder
	<foreignphrase>Host-Only</foreignphrase>
	Netzwerken zu laden, fügen Sie folgendes in
	<filename>/etc/rc.conf</filename> ein und starten Sie den
	Computer neu:</para>

      <programlisting>vboxnet_enable="YES"</programlisting>

      <para>Die Gruppe <systemitem
	  class="groupname">vboxusers</systemitem> wird während der
	Installation von <application>&virtualbox;</application>
	angelegt.  Alle Benutzer, die Zugriff auf
	<application>&virtualbox;</application> haben sollen, müssen
	in diese Gruppe aufgenommen werden.  <command>pw</command>
	kann benutzt werden, um neue Mitglieder hinzuzufügen:</para>

      <screen>&prompt.root; <userinput>pw groupmod vboxusers -m <replaceable>yourusername</replaceable></userinput></screen>

      <para>Damit Netzwerkbrücken funktionieren, müssen die in der
	Voreinstellung eingeschränkten Berechtigungen für
	<filename>/dev/vboxnetctl</filename> angepasst werden:</para>

      <screen>&prompt.root; <userinput>chown root:vboxusers /dev/vboxnetctl</userinput>
&prompt.root; <userinput>chmod 0600 /dev/vboxnetctl</userinput></screen>

      <para>Um diese Berechtigungen dauerhaft zu speichern, fügen Sie
	folgende Einträge in <filename>/etc/devfs.conf</filename>
	hinzu:</para>

      <programlisting>own     vboxnetctl root:vboxusers
perm    vboxnetctl 0600</programlisting>

      <para>Um <application>&virtualbox;</application> zu starten,
	geben Sie folgenden Befehl in der
	<application>&xorg;</application>-Sitzung ein:</para>

      <screen>&prompt.user; <userinput>VirtualBox</userinput></screen>

      <para>Besuchen Sie die offizielle Webseite von
        <application>&virtualbox;</application> unter <uri
	  xlink:href="http://www.virtualbox.org">
	  http://www.virtualbox.org</uri>, um weitere Informationen
	zur Konfiguration und Verwendung zu erhalten.
	&os;-spezifische Informationen und Anleitungen zur
	Fehlerbehebung finden Sie auf der entsprechenden Seite im
	&os;-Wiki unter <uri
	  xlink:href="http://wiki.FreeBSD.org/VirtualBox">
	  http://wiki.FreeBSD.org/VirtualBox</uri>.</para>
    </sect2>

    <sect2 xml:id="virtualization-virtualbox-usb-support">
      <title>USB Unterstützung für &virtualbox;</title>

      <para>Um auf <acronym>USB</acronym>-Geräte lesend und schreibend
	zuzugreifen, müssen Benutzer Mitglied der Gruppe
	<systemitem class="groupname">operator</systemitem>
	sein:</para>

      <screen>&prompt.root; <userinput>pw groupmod operator -m <replaceable>jerry</replaceable></userinput></screen>

      <para>Fügen Sie dann folgenden Eintrag in
	<filename>/etc/devfs.rules</filename> hinzu. Erstellen Sie die
	Datei, wenn sie nicht bereits existiert:</para>

      <programlisting>[system=10]
add path 'usb/*' mode 0660 group operator</programlisting>

      <para>Um diese neuen Regeln zu laden, fügen Sie folgenden
	Eintrag in <filename>/etc/rc.conf</filename> hinzu:</para>

      <programlisting>devfs_system_ruleset="system"</programlisting>

      <para>Danach starten Sie devfs neu:</para>

      <screen>&prompt.root; <userinput>service devfs restart</userinput></screen>

      <para><acronym>USB</acronym> kann nun im Gastsystem aktiviert
	werden.  Die <acronym>USB</acronym>-Geräte sollten nun in den
	&virtualbox; Einstellungen sichtbar sein.</para>
    </sect2>

    <sect2 xml:id="virtualbox-virtualization-host-dvd-cd-access">
      <title>Host <acronym>CD</acronym>/<acronym>DVD</acronym>-Zugriff
	in &virtualbox;</title>

      <para>Ein Gastsystem kann auf die
	<acronym>DVD</acronym>/<acronym>CD</acronym>-Laufwerke des
	Hosts zugreifen.  Der Zugriff für die virtuellen Maschinen
	wird in den Einstellungen von &virtualbox; konfiguriert.
	Falls erforderlich, erstellen Sie zunächst ein leeres
	<acronym>IDE</acronym>
	<acronym>DVD</acronym>/<acronym>CD</acronym>-Gerät und wählen
	Sie dann ein entsprechendes Medium für dieses Laufwerk aus.
	Das Kontrollkästchen <literal>Passthrough</literal> besagt,
	dass die virtuelle Maschine die Hardware direkt verwenden
	kann.  Audio-<acronym>CD</acronym>s und Brenner funktionieren
	nur, wenn diese Option ausgewählt ist.</para>

      <para>Damit die
	<acronym>CD</acronym>/<acronym>DVD</acronym>-Funktionen von
	&virtualbox; funktionieren, muss <acronym>HAL</acronym> in
	<filename>/etc/rc.conf</filename> aktiviert und anschließend
	gestartet werden:</para>

      <programlisting>hald_enable="YES"</programlisting>

      <screen>&prompt.root; <userinput>service hald start</userinput></screen>

      <para>Damit die
	<acronym>CD</acronym>/<acronym>DVD</acronym>-Funktionen von
	Benutzern verwendet werden können, benötigen diese Zugriff auf
	<filename>/dev/xpt0</filename>,
	<filename>/dev/cd<replaceable>N</replaceable></filename> und
	<filename>/dev/pass<replaceable>N</replaceable></filename>.
	Dies wird in der Regel dadurch erreicht, den Benutzer zum
	Mitglied der Gruppe <systemitem
	  class="groupname">operator</systemitem> zu machen.  Die
	Berechtigungen für diese Geräte werden mit folgenden Zeilen
	in <filename>/etc/devfs.conf</filename> konfiguriert:</para>

      <programlisting>perm cd* 0660
perm xpt0 0660
perm pass* 0660</programlisting>

      <screen>&prompt.root; <userinput>service devfs restart</userinput></screen>
    </sect2>
  </sect1>

  <sect1 xml:id="virtualization-host-bhyve">
    <info>
      <title>&os; als Host mit
	<application>bhyve</application></title>

      <authorgroup>
	<author>
	  <personname>
	    <firstname>Björn</firstname>
	    <surname>Heidotting</surname>
	  </personname>
	  <contrib>Übersetzt von </contrib>
	</author>
      </authorgroup>
    </info>

    <para>Beginnend mit &os; 10.0-RELEASE ist
      <application>bhyve</application>, ein
      <acronym>BSD</acronym>-lizensierter Hypervisor, Teil des
      Basissystems.  Dieser Hypervisor unterstützt eine Reihe von
      Gastbetriebssystemen, darunter &os;, OpenBSD und viele &linux;
      Distributionen.  Derzeit unterstützt
      <application>bhyve</application> nur eine serielle Konsole und
      kann keine graphische Konsole emulieren.
      <application>bhyve</application> verwendet Offload-Funktionen
      von neueren <acronym>CPU</acronym>s, um manuelle
      Speicherzuordnungen und Anweisungen zu vermeiden.</para>

    <para>Das Design von <application>bhyve</application> erfordert
      einen Prozessor, der &intel; Extended Page Tables
      (<acronym>EPT</acronym>), &amd; Rapid Vitualization
      Indexing (<acronym>RVI</acronym>) oder Nested Page Tables
      (<acronym>NPT</acronym>) unterstützt.  &os;- oder
      &linux;-Gastsysteme mit mehr als einer <acronym>vCPU</acronym>
      benötigen <acronym>VMX</acronym> unrestricted mode support
      (<acronym>UG</acronym>).  Die meisten neueren Prozessoren,
      speziell &intel;&nbsp;&core; i3/i5/i7 und &intel;&nbsp;&xeon;
      E3/E5/E7, unterstützen diese Funktionen.  Unterstützung für
      <acronym>UG</acronym> wurde mit Intel's Westmere
      Mikroarchitektur eingeführt.  Eine vollständige Liste der
      &intel;-Prozessoren mit <acronym>EPT</acronym>-Unterstützung
      finden Sie unter <link
	xlink:href="http://ark.intel.com/search/advanced?s=t&amp;ExtendedPageTables=true"/>.
      <acronym>RVI</acronym> wird seit der dritten Generation der
      &amd.opteron;-Prozessoren (Barcelona) unterstützt.  Um zu sehen
      ob der Prozessor <application>bhyve</application> unterstützt,
      prüfen Sie die Ausgabe von <command>dmesg</command> oder
      <filename>/var/run/dmesg.boot</filename>.  Für &amd;-Prozessoren
      suchen Sie in der Zeile <literal>Features2</literal> nach
      <literal>POPCNT</literal>.  Für &intel;-Prozessoren suchen Sie
      in der Zeile <literal>VT-x</literal> nach <literal>EPT</literal>
      und <literal>UG</literal>.</para>

    <sect2 xml:id="virtualization-bhyve-prep">
      <title>Vorbereitung des Hosts</title>

      <para>Der erste Schritt bei der Erstellung einer virtuellen
	Maschine in <application>bhyve</application> ist die
	Konfiguration des Host-Systems.  Laden Sie zunächst das
	<application>bhyve</application> Kernelmodul:</para>

      <screen>&prompt.root; <userinput>kldload vmm</userinput></screen>

      <para>Erstellen Sie ein <filename>tap</filename>-Gerät, um
	dieses mit der Netzwerk-Schnittstelle der virtuellen Maschine
	zu verbinden.  Damit sich die Schnittstelle mit dem
	Netzwerk verbinden kann, müssen Sie zusätzlich eine
	Bridge-Schnittstelle erzeugen, bestehend aus dem
	<filename>tap</filename>-Gerät und der physikalischen
	Schnittstelle.  In diesem Beispiel wird die physikalische
	Schnittstelle <filename>igb0</filename> verwendet:</para>

      <screen>&prompt.root; <userinput>ifconfig <replaceable>tap0</replaceable> create</userinput>
&prompt.root; <userinput>sysctl net.link.tap.up_on_open=1</userinput>
net.link.tap.up_on_open: 0 -> 1
&prompt.root; <userinput>ifconfig <replaceable>bridge0</replaceable> create</userinput>
&prompt.root; <userinput>ifconfig <replaceable>bridge0</replaceable> addm <replaceable>igb0</replaceable> addm <replaceable>tap0</replaceable></userinput>
&prompt.root; <userinput>ifconfig <replaceable>bridge0</replaceable> up</userinput></screen>
    </sect2>

    <sect2 xml:id="virtualization-bhyve-freebsd">
      <title>Ein &os;-Gastsystem erstellen</title>

      <para>Erzeugen Sie eine Datei, die als virtuelle Festplatte
	für das Gastsystem verwendet wird.  Geben Sie die Größe und
	den Namen der virtuellen Festplatte an:</para>

      <screen>&prompt.root; <userinput>truncate -s <replaceable>16G</replaceable> <replaceable>guest.img</replaceable></userinput></screen>

      <para>Laden Sie ein Installationsabbild von &os;:</para>

      <screen>&prompt.root; <userinput>fetch <replaceable>ftp://ftp.freebsd.org/pub/FreeBSD/releases/ISO-IMAGES/10.2/FreeBSD-10.2-RELEASE-amd64-bootonly.iso</replaceable></userinput>
FreeBSD-10.2-RELEASE-amd64-bootonly.iso       100% of  230 MB  570 kBps 06m17s</screen>

      <para>&os; enthält ein Beispielskript um eine virtuelle Maschine
	in <application>bhyve</application> auszuführen.  Das Skript
	wird die virtuelle Maschine starten und sie in einer Schleife
	ausführen.  Sollte die virtuelle Maschine abstürzen, wird sie
	vom Skript automatisch neu gestartet.  Das Skript akzeptiert
	einige Optionen, um die Konfiguration der virtuellen Maschine
	zu kontrollieren: <option>-c</option> bestimmt die Anzahl der
	virtuellen <acronym>CPU</acronym>s, <option>-m</option>
	begrenzt den verfügbaren Speicher des Gastsystems,
	<option>-t</option> bestimmt das verwendete
	<filename>tap</filename>-Gerät, <option>-d</option> gibt das
	zu benutzende Festplattenabbild an, <option>-i</option> sagt
	<application>bhyve</application> dass es von
	<acronym>CD</acronym> booten soll und <option>-I</option>
	bestimmt das <acronym>CD</acronym>-Abbild.  Der letzte
	Parameter ist der Name der virtuellen Maschine.  Dieses
	Beispiel startet die virtuelle Maschine im
	Installationsmodus:</para>

      <screen>&prompt.root; <userinput>sh /usr/share/examples/bhyve/vmrun.sh -c <replaceable>4</replaceable> -m <replaceable>1024M</replaceable> -t <replaceable>tap0</replaceable> -d <replaceable>guest.img</replaceable> -i -I <replaceable>FreeBSD-10.0-RELEASE-amd64-bootonly.iso</replaceable> <replaceable>guestname</replaceable></userinput></screen>

      <para>Die virtuelle Maschine wird starten und das
	Installationsprogramm ausführen.  Nachdem das System in der
	virtuellen Maschine installiert ist, werden Sie gefragt, ob
	eine Shell gestartet werden soll. Wählen Sie
	<guibutton>Yes</guibutton>.  Es muss noch eine kleine Änderung
	vorgenommen werden, damit das System mit einer seriellen
	Konsole startet.  Bearbeiten Sie
	<filename>/etc/ttys</filename> und ersetzen Sie die vorhandene
	<literal>ttyu0</literal>-Zeile durch:</para>

      <programlisting>ttyu0   "/usr/libexec/getty 3wire"   xterm  on secure</programlisting>

      <note>
	<para>Beginnend mit &os;&nbsp;9.3-RELEASE und 10.1-RELEASE
	  wird die Konsole automatisch konfiguriert.</para>
      </note>

      <para>Starten Sie die virtuelle Maschine neu.  Ein Neustart der
	virtuellen Maschine wird <application>bhyve</application>
	beenden, aber da das <filename>vmrun.sh</filename>-Skript in
	einer Schleife läuft, wird <application>bhyve</application>
	automatisch neu gestartet.  Wenn dies passiert, wählen Sie die
	Option <literal>Reboot</literal> im Bootloader-Menü, um die
	Schleife zu unterbrechen.  Anschließend kann das Gastsystem
	von der virtuellen Festplatte gestartet werden:</para>

      <screen>&prompt.root; <userinput>sh /usr/share/examples/bhyve/vmrun.sh -c <replaceable>4</replaceable> -m <replaceable>1024M</replaceable> -t <replaceable>tap0</replaceable> -d <replaceable>guest.img</replaceable> <replaceable>guestname</replaceable></userinput></screen>
    </sect2>

    <sect2 xml:id="virtualization-bhyve-linux">
      <title>Ein &linux;-Gastsystem erstellen</title>

      <para>Um andere Betriebssysteme als &os; zu booten, muss
	zunächst der Port <package>sysutils/grub2-bhyve</package>
	installiert werden.</para>

      <para>Als nächstes erzeugen Sie eine Datei, die das Gastsystem
	als virtuelle Festplatte verwenden kann:</para>

      <screen>&prompt.root; <userinput>truncate -s <replaceable>16G</replaceable> <replaceable>linux.img</replaceable></userinput></screen>

      <para>Der Start einer virtuellen Maschine mit
	<application>bhyve</application> ist ein zweistufiger Prozess.
	Zuerst muss ein Kernel geladen werden, dann kann das
	Gastsystem gestartet werden.  Der &linux;-Kernel wird mit
	<package>sysutils/grub2-bhyve</package> geladen.  Erstellen
	Sie eine <filename>device.map</filename>, damit
	<application>grub</application> die virtuellen Geräte den
	Dateien auf dem Hostsystem zuordnen kann:</para>

      <programlisting>(hd0) ./linux.img
(cd0) ./somelinux.iso</programlisting>

      <para>Benutzen Sie <package>sysutils/grub2-bhyve</package> um
	den &linux;-Kernel vom <acronym>ISO</acronym>-Abbild zu
	laden:</para>

      <screen>&prompt.root; <userinput>grub-bhyve -m device.map -r cd0 -M <replaceable>1024M</replaceable> <replaceable>linuxguest</replaceable></userinput></screen>

      <para>Damit wird <application>grub</application> gestartet.
	Wenn die Installations-<acronym>CD</acronym> eine Datei namens
	<filename>grub.cfg</filename> enthält, wird ein Menü
	angezeigt.  Wenn nicht, müssen die Dateien
	<filename>vmlinuz</filename> und <filename>initrd</filename>
	manuell geladen werden:</para>

      <screen>grub> <userinput>ls</userinput>
(hd0) (cd0) (cd0,msdos1) (host)
grub> <userinput>ls (cd0)/isolinux</userinput>
boot.cat boot.msg grub.conf initrd.img isolinux.bin isolinux.cfg memtest
splash.jpg TRANS.TBL vesamenu.c32 vmlinuz
grub> <userinput>linux (cd0)/isolinux/vmlinuz</userinput>
grub> <userinput>initrd (cd0)/isolinux/initrd.img</userinput>
grub> <userinput>boot</userinput></screen>

      <para>Nun, da der &linux;-Kernel geladen ist, kann das
	Gastsystem gestartet werden:</para>

      <screen>&prompt.root; <userinput>bhyve -A -H -P -s 0:0,hostbridge -s 1:0,lpc -s 2:0,virtio-net,<replaceable>tap1</replaceable> -s 3:0,virtio-blk,<replaceable>./linux.img</replaceable> \
    -s 4:0,ahci-cd,<replaceable>./somelinux.iso</replaceable> -l com1,stdio -c <replaceable>4</replaceable> -m <replaceable>1024M</replaceable> <replaceable>linuxguest</replaceable></userinput></screen>

      <para>Das System wird booten und das Installtionsprogramm
	starten.  Starten Sie die virtuelle Maschine nach der
	Installation des Betriebssystems neu.  Dies führt auch dazu,
	dass <application>bhyve</application> beendet wird.  Die
	Instanz der virtuellen Maschine muss zerstört werden, bevor
	sie erneut in Betrieb genommen werden kann:</para>

      <screen>&prompt.root; <userinput>bhyvectl --destroy --vm=<replaceable>linuxguest</replaceable></userinput></screen>

      <para>Nun kann das Gastsystem direkt von der virtuellen
	Festplatte gestartet werden.  Laden Sie den Kernel:</para>

      <screen>&prompt.root; <userinput>grub-bhyve -m device.map -r hd0,msdos1 -M <replaceable>1024M</replaceable> <replaceable>linuxguest</replaceable></userinput>
grub> <userinput>ls</userinput>
(hd0) (hd0,msdos2) (hd0,msdos1) (cd0) (cd0,msdos1) (host)
(lvm/VolGroup-lv_swap) (lvm/VolGroup-lv_root)
grub> <userinput>ls (hd0,msdos1)/</userinput>
lost+found/ grub/ efi/ System.map-2.6.32-431.el6.x86_64 config-2.6.32-431.el6.x
86_64 symvers-2.6.32-431.el6.x86_64.gz vmlinuz-2.6.32-431.el6.x86_64
initramfs-2.6.32-431.el6.x86_64.img
grub> <userinput>linux (hd0,msdos1)/vmlinuz-2.6.32-431.el6.x86_64 root=/dev/mapper/VolGroup-lv_root</userinput>
grub> <userinput>initrd (hd0,msdos1)/initramfs-2.6.32-431.el6.x86_64.img</userinput>
grub> <userinput>boot</userinput></screen>

      <para>Starten Sie die virtuelle Maschine:</para>

      <screen>&prompt.root; <userinput>bhyve -A -H -P -s 0:0,hostbridge -s 1:0,lpc -s 2:0,virtio-net,<replaceable>tap1</replaceable> \$    -s 3:0,virtio-blk,<replaceable>./linux.img</replaceable> -l com1,stdio -c <replaceable>4</replaceable> -m <replaceable>1024M</replaceable> <replaceable>linuxguest</replaceable></userinput></screen>

      <para>&linux; wird jetzt in der virtuellen Maschine gestartet
	und präsentiert Ihnen vielleicht einen Anmeldeprompt.  Sie
	können sich anmelden und die virtuelle Maschine benutzen.
	Wenn Sie fertig sind, starten Sie die virtuelle Maschine neu,
	um <application>bhyve</application> zu verlassen.
	Anschließend zerstören Sie die Instanz der virtuellen
	Maschine:</para>

      <screen>&prompt.root; <userinput>bhyvectl --destroy --vm=<replaceable>linuxguest</replaceable></userinput></screen>
    </sect2>

    <sect2 xml:id="virtualization-bhyve-zfs">
      <title>Verwendung von <acronym>ZFS</acronym> mit
	<application>bhyve</application>-Gastsystemen</title>

      <para>Wenn auf dem Host-Rechner <acronym>ZFS</acronym>
	eingerichtet ist, können Sie <acronym>ZFS</acronym>-Volumes
	anstelle eines Festplattenabbilds verwenden.  Dies kann
	erhebliche Leistungsvorteile für das Gastsystem mit sich
	bringen.  Ein <acronym>ZFS</acronym>-Volume kann wie folgt
	erstellt werden:</para>

      <screen>&prompt.root; <userinput>zfs create -V<replaceable>16G</replaceable> -o volmode=dev <replaceable>zroot/linuxdisk0</replaceable></userinput></screen>

      <para>Geben Sie das <acronym>ZFS</acronym>-Volume beim Start
	der virtuellen Maschine an:</para>

      <screen>&prompt.root; <userinput>bhyve -A -H -P -s 0:0,hostbridge -s 1:0,lpc -s 2:0,virtio-net,<replaceable>tap1</replaceable> -s3:0,virtio-blk,<replaceable>/dev/zvol/zroot/linuxdisk0</replaceable> \
    -l com1,<replaceable>stdio</replaceable> -c <replaceable>4</replaceable> -m <replaceable>1024M</replaceable> <replaceable>linuxguest</replaceable></userinput></screen>
    </sect2>

    <sect2 xml:id="virtualization-bhyve-nmdm">
      <title>Konsolen in der virtuellen Maschine</title>

      <para>Es ist vorteilhaft, die
	<application>bhyve</application>-Konsole mit einem Werkzeug
	wie <package>sysutils/tmux</package> oder
	<package>sysutils/screen</package> zu bedienen.  Damit ist es
	leicht, die Konsole zu verbinden oder zu trennen.  Es ist auch
	möglich, die Konsole als Nullmodem-Gerät zu nutzen, auf das
	Sie mit <command>cu</command> zugreifen können.  Laden Sie
	dazu das <filename>nmdm</filename> Kernelmodul und ersetzen
	Sie <option>-l com1,stdio</option> mit <option>-l
	com1,/dev/nmdm0A</option>.  Die
	<filename>/dev/nmdm</filename>-Geräte werden bei Bedarf
	automatisch erstellt, jeweils paarweise, entsprechend den
	beiden Enden eines Nullmodemkabels
	(<filename>/dev/nmdm0A</filename> und
	<filename>/dev/nmdm0B</filename>).  Weitere Informationen
	finden Sie in &man.nmdm.4;.</para>

      <screen>&prompt.root; <userinput>kldload nmdm</userinput>
&prompt.root; <userinput>bhyve -A -H -P -s 0:0,hostbridge -s 1:0,lpc -s 2:0,virtio-net,<replaceable>tap1</replaceable> -s 3:0,virtio-blk,<replaceable>./linux.img</replaceable> \
    -l com1,<replaceable>/dev/nmdm0A</replaceable> -c <replaceable>4</replaceable> -m <replaceable>1024M</replaceable> <replaceable>linuxguest</replaceable></userinput>
&prompt.root; <userinput>cu -l <replaceable>/dev/nmdm0B</replaceable></userinput>
Connected

Ubuntu 13.10 handbook ttyS0

handbook login:</screen>
    </sect2>

    <sect2 xml:id="virtualization-bhyve-managing">
      <title>Virtuelle Maschinen verwalten</title>

      <para>Für jede virtuelle Maschine wird unterhalb von
	<filename>/dev/vmm</filename> ein Gerätename erzeugt.
	Dadurch kann der Administrator einfach feststellen, welche
	virtuellen Maschinen zur Zeit ausgeführt werden:</para>

      <screen>&prompt.root; <userinput>ls -al /dev/vmm</userinput>
total 1
dr-xr-xr-x   2 root  wheel    512 Mar 17 12:19 ./
dr-xr-xr-x  14 root  wheel    512 Mar 17 06:38 ../
crw-------   1 root  wheel  0x1a2 Mar 17 12:20 guestname
crw-------   1 root  wheel  0x19f Mar 17 12:19 linuxguest
crw-------   1 root  wheel  0x1a1 Mar 17 12:19 otherguest</screen>

      <para>Mit Hilfe von <command>bhyvectl</command> kann eine
	virtuelle Maschine zerstört werden:</para>

      <screen>&prompt.root; bhyvectl --destroy --vm=<replaceable>guestname</replaceable></screen>
    </sect2>

    <sect2 xml:id="virtualization-bhyve-onboot">
      <title>Persistente Konfiguration</title>

      <para>Um das System so zu konfigurieren, dass
	<application>bhyve</application>-Gastsysteme beim Booten
	gestartet werden, muss die folgenden Konfiguration in den
	jeweiligen Dateien vorgenommen werden:</para>

      <procedure>
	<step>
	  <title><filename>/etc/sysctl.conf</filename></title>

	  <programlisting>net.link.tap.up_on_open=1</programlisting>
	</step>

	<step>
	  <title><filename>/boot/loader.conf</filename></title>

	  <programlisting>vmm_load="YES"
nmdm_load="YES"
if_bridge_load="YES"
if_tap_load="YES"</programlisting>
	</step>

	<step>
	  <title><filename>/etc/rc.conf</filename></title>

	  <programlisting>cloned_interfaces="<replaceable>bridge0</replaceable> <replaceable>tap0</replaceable>"
ifconfig_bridge0="addm <replaceable>igb0</replaceable> addm <replaceable>tap0</replaceable>"</programlisting>
	</step>
      </procedure>
    </sect2>

<!--
    Note:  There is no working/end-user ready Xen support for FreeBSD as of 07-2010.
           Hide all information regarding Xen under FreeBSD.

    <sect2 id="virtualization-other">
      <title>Andere Virtualisierungsmöglichkeiten</title>

      <para>Zusätzlich wird
      daran gearbeitet, <application>&xen;</application> als
      funktionierende Host-Umgebung (dom0) für &os;
      verfügbar zu machen.</para>
    </sect2>
-->
  </sect1>
</chapter>
