.\"	$OpenBSD: ssh-keyscan.1,v 1.5 2001/04/18 16:21:05 ian Exp $
.\"
.\" Copyright 1995, 1996 by David Mazieres <dm@lcs.mit.edu>.
.\"
.\" Modification and redistribution in source and binary forms is
.\" permitted provided that due credit is given to the author and the
.\" OpenBSD project (for instance by leaving this copyright notice
.\" intact).
.\"
.\" %FreeBSD%
.\" $FreeBSD$
.\"
.Dd January 1, 1996
.Dt SSH-KEYSCAN 1
.Os
.Sh 名称
.Nm ssh-keyscan
.Nd ssh 公開鍵を収集する
.Sh 書式
.Nm ssh-keyscan
.Op Fl t Ar タイムアウト秒数
.Op Ar -- | ホスト名 | アドレスリスト ホスト名リスト
.Op Fl f Ar ファイル ...
.Sh 解説
.Nm
は複数のホストから ssh 用のホスト公開鍵を収集するための
ユーティリティです。これは
.Pa ssh_known_hosts
ファイルを構築し、検証するのに役立つよう作られています。
.Nm
はシェルスクリプトあるいは perl スクリプトから使うのに適した、
最小限のインターフェイスを備えています。
.Pp
.Nm
はノンブロッキング ソケット I/O を使い、なるべく多くのホストに
並列にアクセスします。そのためこれは非常に効率的です。
1000台ほどのホストから
なるドメインの鍵も数十秒で集めてしまいます、たとえいくつかのホストで
ssh が走っていなかったり、ホストがダウンしていたりしても、です。
スキャンするホストにログインできる必要はありません。また、このスキャンには
いかなる暗号化も必要ありません。
.Sh セキュリティ
.Nm
をつかって、キーを検証せずに ssh_known_hosts ファイルを
.I man in the middle
(なりすまし) 攻撃に対して無防備になります。
いっぽう、お使いのセキュリティモデルがそのような危険を
はらんでいる場合、一度こちらの ssh_known_hosts を作ってしまえば、
.Nm
はそれ以後の、改竄された鍵ファイルや man in the middle 攻撃を
検知するのに使えます。
.Sh オプション
.Bl -tag -width Ds
.It Fl t
接続要求がタイムアウトするまでの秒数を設定します。
あるホストに接続を試みてから、あるいは最後にそのホストから何か
受信してから
.Pa timeout
秒が経過するとその接続は閉じられ、問題のホストは使用不能として
認識されます。デフォルトでは 5秒です。
.It Fl f
このファイルから、1行ごとに書かれたホスト名あるいは
.Pa アドレスリスト ホスト名リスト
の組を読み込みます。引数として
.Pa -
が指定された場合、
.Nm
は標準入力からホスト名あるいは
.Pa アドレスリスト ホスト名リスト
の組を読み込みます。
.El
.Sh 使用例
.Pp
.Pa hostname
で指定されるマシンのホスト鍵を表示する:
.Bd -literal
ssh-keyscan hostname
.Ed
.Pp
ファイル
.Pa ssh_hosts
にあるホストのうち、
新しいホスト、あるいは
ソートされた
.Pa ssh_known_hosts
ファイルにあるものと鍵が違っているホストを見つける。
.Bd -literal
$ ssh-keyscan -f ssh_hosts | sort -u - ssh_known_hosts | \e\ 
	diff ssh_known_hosts -
.Ed
.Pp
.Sh 関連ファイル
.Pp
.Pa 入力形式:
1.2.3.4,1.2.4.4 name.my.domain,name,n.my.domain,n,1.2.3.4,1.2.4.4
.Pp
.Pa 出力形式:
ホストあるいはホスト名のリスト ビット数 べき指数 係数
.Pp
.Pa /etc/ssh_known_hosts
.Sh バグ
このプログラムは、スキャンしたすべてのマシンのコンソール上に
"Connection closed by remote host" のメッセージを残します。
これは、このプログラムが ssh 用のポートに接続したあと、
公開鍵を読みこんですぐに接続を切ってしまうためです。
.Sh 関連項目
.Xr ssh 1 ,
.Xr sshd 8
.Sh 作者
David Mazieres <dm@lcs.mit.edu>
.Sh 日本語訳
新山 祐介 (euske@cl.cs.titech.ac.jp) 2001/8/7
.Pp
当マニュアルページは氏のご好意により
.Fx
日本語マニュアルに収録させていただいています。
翻訳についてのご意見、ご指摘がありましたら新山氏
<euske@cl.cs.titech.ac.jp>、および
.Fx
jpman プロジェクト <man-jp@jp.FreeBSD.org> までお送りください。
