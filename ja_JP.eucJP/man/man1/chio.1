.\"	%NetBSD: %
.\"
.\" Copyright (c) 1996 Jason R. Thorpe <thorpej@and.com>
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgements:
.\"	This product includes software developed by Jason R. Thorpe
.\"	for And Communications, http://www.and.com/
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
.\" BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
.\" LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
.\" AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
.\" OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	%Id: chio.1,v 1.6 1998/06/04 21:05:19 steve Exp %
.\"
.\" jpman %Id: chio.1,v 1.3 1997/08/31 14:04:42 horikawa Stab %
.Dd April 2, 1996
.Dt CHIO 1
.Os
.Sh 名称
.Nm chio
.Nd メディアチェンジャ制御ユーティリティ
.Sh 書式
.Nm chio
.Op Fl f Ar changer
.Ar command
.Ar arg1
.Ar arg2
.Oo
.Ar arg3 Oo ...
.Oc
.Oc
.Sh 解説
.Nm chio
は、テープや光ディスクなどのジュークボックスに見られるような
メディアチェンジャの動作を制御するために使われます。
.Pp
オプションには以下のものがあります:
.Bl -tag -width indent
.It Fl f Ar changer
デフォルトの
.Pa /dev/ch0
デバイスのかわりに
.Pa changer
を使用します。
.El
.Pp
環境変数
.Ev CHANGER
にデバイス名をセットしておくと、
それをデフォルトのチェンジャとして使用することができます。
.Pp
メディアチェンジャ装置は複数の
.Em element
から成り立っています。
element には 4 種類あり、それぞれ
.Em picker
(メディア搬送)、
.Em slot
(保管)、
.Em portal
(出し入れ)、
.Em drive
(データ転送)です。このコマンドの解説では省略形
.Em ET
で element の種類を表し、
.Em EU
で element の装置番号を表します。
たとえば、チェンジャ内の一つめのロボットアームを表現する場合には、
.Em ET
は
.Dq picker
となり、
.Em EU
は
.Dq 0
となります。
.Pp
.Sh サポートされるコマンド
.Bl -tag -width indent
.It Xo Nm chio move
.Ar <from ET> <from EU> <to ET> <to EU>
.Op Ar inv
.Xc
メディアユニットを
.Pa <from ET/EU>
から
.Pa <to ET/EU>
へと移動します。
オプションの修飾子
.Pa inv
が指定された場合は、挿入前にメディアユニットが裏返されます。
.It Xo Nm chio exchange
.Ar <src ET> <src EU> <dst1 ET> <dst1 EU>
.Op Ar <dst2 ET> <dst2 ET>
.Op Ar inv1
.Op Ar inv2
.Xc
メディアユニットの交換作業をおこないます。
.Pa <src ET/EU>
にあるメディアユニットは
.Pa <dst1 ET/EU>
に移され、以前に
.Pa <dst1 ET/EU>
にあったメディアユニットは
.Pa <dst2 ET/EU>
に移されます。
単純に交換する場合には、
.Pa <dst2 ET/EU>
を省略すると
.Pa <src ET/EU>
が代りに使われます。
オプションの修飾子
.Pa inv1
や
.Pa inv2
が指定された場合には、それぞれ
.Pa <dst1 ET/EU>
や
.Pa <dst2 ET/EU>
への挿入前にメディアユニットが裏返されます。
.Pp
すべてのメディアチェンジャが
.Nm exchange
操作をサポートしているわけではないことに注意してください。
exchange 操作のためには、チェンジャが複数の空き picker を持っているか、
一時的な保管場所を用いて複数の空き picker をエミュレートする必要があります。
.Pp
.It Xo Nm chio position
.Ar <to ET> <to EU>
.Op Ar inv
.Xc
picker を
.Pa <to ET/EU>
で指定した element の前に配置します。
もしオプションの修飾子
.Pa inv
が指定された場合は、挿入前にメディアユニットが裏返されます。
.Pp
このコマンドを発行しても、すべてのチェンジャが期待通りの動作をするとは
限らないことに注意してください。
.It Nm chio params
チェンジャ内の slot, drive, picker, portal の数と、
現在どの picker が使用可能になっているかを報告します。
.It Nm chio getpicker
.Pp
現在どの picker が使用可能になっているかを報告します。
.It Xo Nm chio setpicker
.Ar <unit>
.Xc
.Pa <unit>
番の picker を使用可能にします。
.It Xo Nm chio status
.Op Ar <type>
.Xc
チェンジャ内のすべての element の状態を報告します。もし
.Pa <type>
が指定されていると、
.Pa <type>
型の elememt の状態を報告します。
.El
.Pp
ステータスビットは以下のように定義されています:
.Bl -tag -width indent
.It FULL
element にメディアユニットが入っています。
.It IMPEXP
外部の人間の操作により element にメディアが挿入されました。
.It EXCEPT
element が異常な状態になっています。
.It ACCESS
この element 内のメディアは picker でアクセス可能です。
.It EXENAB
element は外部の人間の操作によるメディアの取り出しが可能です。
.It INENAB
element は外部の人間の操作によるメディアの挿入が可能です。
.El
.Sh 使用例
.Bl -tag -width indent
.It Nm chio move slot 3 drive 0
スロット 3 (4 番目のスロット) のメディアをドライブ 0 (1 番目のドライブ) に
移動させます。
.It Nm chio setpicker 2
チェンジャが picker 2 (3 番目の picker) を作業に使用するように設定します。
.El
.Sh 関連ファイル
.Bl -tag -width /dev/ch0 -compact
.It Pa /dev/ch0
デフォルトのチェンジャデバイス
.El
.Sh 関連項目
.Xr mt 1 ,
.Xr ch 4 ,
.Xr mount 8
.Sh 作者
.Nm chio
プログラムと SCSI チェンジャドライバは
And Communications 社 (http://www.and.com/) の
.An Jason R. Thorpe Aq thorpej@and.com
によって書かれました。
