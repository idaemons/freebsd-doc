.\"  -*- nroff -*-
.\"
.\" Author: Tatu Ylonen <ylo@cs.hut.fi>
.\" Copyright (c) 1995 Tatu Ylonen <ylo@cs.hut.fi>, Espoo, Finland
.\"                    All rights reserved
.\"
.\" As far as I am concerned, the code I have written for this software
.\" can be used freely for any purpose.  Any derived versions of this
.\" software must be clearly marked as such, and if the derived work is
.\" incompatible with the protocol description in the RFC file, it must be
.\" called by a name other than "ssh" or "Secure Shell".
.\"
.\"
.\" Copyright (c) 1999,2000 Markus Friedl. All rights reserved.
.\" Copyright (c) 1999 Aaron Campbell. All rights reserved.
.\" Copyright (c) 1999 Theo de Raadt. All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" %FreeBSD%
.\" jpman %Id%
.\"
.Dd September 25, 1999
.Dt SSH-KEYGEN 1
.Os
.Sh 名前
.Nm ssh-keygen
.Nd 認証用の鍵を生成する
.Sh 書式
.Nm ssh-keygen
.Op Fl dq
.Op Fl b Ar ビット数
.Op Fl N Ar 新しいパスフレーズ
.Op Fl C Ar コメント
.Op Fl f Ar 出力する鍵ファイル
.Nm ssh-keygen
.Fl p
.Op Fl P Ar 古いパスフレーズ
.Op Fl N Ar 新しいパスフレーズ
.Op Fl f Ar 鍵ファイル
.Nm ssh-keygen
.Fl x
.Op Fl f Ar 入力する鍵ファイル
.Nm ssh-keygen
.Fl X
.Op Fl f Ar 入力する鍵ファイル
.Nm ssh-keygen
.Fl y
.Op Fl f Ar 入力する鍵ファイル
.Nm ssh-keygen
.Fl c
.Op Fl P Ar パスフレーズ
.Op Fl C Ar コメント
.Op Fl f Ar 鍵ファイル
.Nm ssh-keygen
.Fl l
.Op Fl f Ar 入力する鍵ファイル
.Nm ssh-keygen
.Fl R
.Sh 説明
.Nm
は
.Xr ssh 1
の認証用の鍵を生成し、管理します。デフォルトでは
.Nm
はプロトコル 1.3 および 1.5 で使われる RSA 鍵を生成する
ようになっていますが、
.Fl d
フラグを指定することによりプロトコル 2.0 で
使われる DSA 鍵を生成することもできます。
.Pp
ふつう RSA認証 または DSA認証で SSH を使いたいユーザは、一度これを
実行すれば
.Pa $HOME/.ssh/identity
または
.Pa $HOME/.ssh/id_dsa .
に鍵を作ることができます。また
.Pa /etc/rc .
などで見れらるように、
システム管理者がホスト鍵生成のためにこれを使うこともできます。
.Pp
このプログラムはふつう鍵を生成して、その秘密鍵をどのファイルに格納すれば
よいのかを訊いてきます。公開鍵は秘密鍵のファイル名に
.Dq .pub
をつけたファイル名に格納されます。またこのプログラムは
パスフレーズも訊いてきます。
パスフレーズをつけないときは空でもかまいません (ホスト鍵のパスフレーズは
必ず空でなければいけません) し、任意の長さの文字列をパスフレーズとして
使用することもできます。よいパスフレーズは 10〜30文字程度の長さをもち、
簡単な文章や容易に推測できるものであってはいけません (英語の散文は
単語ごとにわずか 1〜2 ビットのエントロピーしかなく、これは非常に悪い
パスフレーズの例です)。パスフレーズは
.Fl p
オプションを使うことに
よって後からでも変更できます。
.Pp
失われてしまったパスフレーズをもとに戻すすべはありません。もし
パスフレーズを忘れてしまったり、それをなくしてしまったときには、
新しい鍵を生成してその公開鍵を別のマシンにコピーしなくてはならない
でしょう。
.Pp
RSA の場合、鍵のファイルにはコメントフィールドもあり、これはユーザが
鍵を区別する便宜をはかるだめだけに存在します。このコメントには
その鍵が何のためであるかとか、その他有用な情報を書いておくことが
できます。コメントは最初に鍵が作られたとき
.Dq user@host
の形になっていますが、
.Fl c
オプションを使えば変更することができます。
.Pp
鍵を生成したあと、それをどこに置けば使用可能になるのかは
以下の解説を読んでください。
.Pp
オプションには次のようなものがあります:
.Bl -tag -width Ds
.It Fl b Ar ビット数
作成する鍵のビット数を指定します。最小値は 512 ビットです。
ふつう 1024 ビットの鍵で充分だと考えられており、これ以上鍵を
長くしてもセキュリティの向上には役に立たず、遅くなるだけです。
デフォルトは 1024 ビットになっています。
.It Fl c
秘密鍵ファイルおよび公開鍵ファイルのコメントを変更します。
まず秘密鍵の入っているファイルを訊かれ、パスフレーズがあれば
それを入力したあと、新しいコメントを入力します。
.It Fl f
鍵を入れるファイルのファイル名を指定します。
.It Fl l
指定された秘密鍵あるいは公開鍵の指紋 (fingerprint) を表示します。
.It Fl p
新しく秘密鍵をつくるのではなく、すでにある秘密鍵ファイルのパス
フレーズを変更します。まず秘密鍵の入っているファイルを訊かれ、
古いパスフレーズを入力したあと、新しいパスワードを 2回入力します。
.It Fl q
静かな
.Nm ssh-keygen 
。
.Pa /etc/rc
で新しい鍵をつくるときに使われます。
.It Fl C Ar コメント
新規のコメントを指定します。
.It Fl N Ar 新しいパスフレーズ
新規のパスフレーズを指定します。
.It Fl P Ar パスフレーズ
(古い) パスフレーズを指定します。
.It Fl R
RSA サポートが機能していれば、これは終了状態 0 を返して
すぐに終了します。もし RSA サポートが機能していなければ、終了
状態として 1 を返します。このフラグは RSA の特許が切れたので
なくなります。
.It Fl x
このオプションはプライベートな OpenSSH DSA 形式の鍵ファイルを読み
SSH2 互換な公開鍵を標準出力に表示します。
.It Fl X
このオプションは暗号化されていない SSH2 互換の秘密鍵 (または
公開鍵) ファイルを読み、OpenSSH 互換の秘密鍵 (あるいは公開鍵) を
標準出力に表示します。
.It Fl y
このオプションはプライベートな OpenSSH DSA 形式の鍵ファイルを読み
OpenSSH DSA 公開鍵を標準出力に表示します。
.El
.Sh ファイル
.Bl -tag -width Ds
.It Pa $HOME/.ssh/identity
そのユーザの RSA 認証用 秘密鍵を格納します。このファイルはその
ユーザ以外の誰にも読ませるべきではありません。この鍵を生成する
際にパスフレーズを指定するこもできます。これはファイル中の
秘密鍵を 3DES を使って暗号化するのに用いられます。このファイルは
.Nm
が自動的にアクセスするわけではありませんが、
秘密鍵ファイルのデフォルトの名前としてこれが提案されます。
.Xr sshd 8
はログイン要求があった際にこのファイルを読み込みます。
.It Pa $HOME/.ssh/identity.pub
認証用の公開鍵を格納します。このファイルの内容を、RSA 認証を使って
ログインしたいすべてのマシンの
.Pa $HOME/.ssh/authorized_keys
に付け加えておいてください。このファイルを秘密にしておく必要は
ありません。
.It Pa $HOME/.ssh/id_dsa
そのユーザの DSA 認証用 秘密鍵を格納します。このファイルはその
ユーザ以外の誰にも読ませるべきではありません。この鍵を生成する
際にパスフレーズを指定するこもできます。これはファイル中の
秘密鍵を 3DES を使って暗号化するのに用いられます。このファイルは
.Nm
によって自動的にアクセスされるわけではありませんが、
秘密鍵ファイルのデフォルトの名前としてこれが提案されます。
.Xr sshd 8
はログイン要求があった際にこのファイルを読み込みます。
.It Pa $HOME/.ssh/id_dsa.pub
認証用の公開鍵を格納します。このファイルの内容を、DSA 認証を使って
ログインしたいすべてのマシンの
.Pa $HOME/.ssh/authorized_keys2
に付け加えておいてください。このファイルを秘密にしておく必要は
ありません。
.El
.Sh 作者
Tatu Ylonen <ylo@cs.hut.fi>
.Pp
OpenSSH
は オリジナルの (フリー) ssh 1.2.12 から派生したものです。
しかしバグがとり除かれ、より新しい機能が追加されています。
1.2.12 がリリースされるとすぐに、オリジナルの ssh は
だんだんと制限されたライセンスになっていきました。
このバージョンの OpenSSH は…
.Bl -bullet
.It
何らかの制限的事項 (つまり特許など。
.Xr ssl 8 
を参照)
がついているコンポーネントはすべて、ソースコードから直接削除されて
います。かわりにライセンスあるいは特許つきのコンポーネントは、
外部ライブラリから取り込まれます。
.It
SSH プロトコル 1.5 と 2 をサポートするようにアップデートされました。
.It
.Xr kerberos 8
認証とチケットパスの追加サポートが含まれています。
.It
.Xr skey 1
を用いた、使い捨てパスワード (one-time password)
認証をサポートしています。
.El
.Sh 日本語訳
新山 祐介 (euske@cl.cs.titech.ac.jp) 2000/11/23
.Pp
当マニュアルページは氏のご好意により
.Fx
日本語マニュアルに収録させていただいています。
翻訳についてのご意見、ご指摘がありましたら新山氏
<euske@cl.cs.titech.ac.jp>、および
.Fx
jpman プロジェクト <man-jp@jp.FreeBSD.org> までお送りください。
.Sh SEE ALSO
.Xr ssh 1 ,
.Xr ssh-add 1 ,
.Xr ssh-agent 1 ,
.Xr sshd 8 ,
.Xr ssl 8
