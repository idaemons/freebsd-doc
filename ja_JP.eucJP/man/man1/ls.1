.\" Copyright (c) 1980, 1990, 1991, 1993, 1994
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" the Institute of Electrical and Electronics Engineers, Inc.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @(#)ls.1	8.6 (Berkeley) 4/18/94
.\"	%Id: ls.1,v 1.5.2.4 1997/09/19 06:18:11 charnier Exp %
.\" jpman %Id: ls.1,v 1.3 1997/05/19 17:21:06 horikawa Stab %
.\"
.Dd April 18, 1994
.Dt LS 1
.Os
.Sh 名称
.Nm ls
.Nd ディレクトリの内容のリストを表示する
.Sh 書式
.Nm ls
.Op Fl ACFLRTacdfgikloqrstu1
.Op Ar file ...
.Sh 解説
.Nm ls
は
.Ar file
で指定されたファイル名およびオプションの指定にしたがって、
ファイルに関する各種の情報を表示します。なお、
.Ar file
としてディレクトリが指定された場合は、そのディレクトリ配下のファイル
に関する情報を表示します。
.Pp
.Ar file
が指定されなかった場合は、カレントディレクトリのファイルを表示します。
表示はファイル名のアルファベット順にソートされます。ただし、
.Ar file
としてディレクトリファイルとそれ以外のファイルを混在して指定した
場合は、ディレクトリ以外のファイルが先に表示され、その後
ディレクトリ配下のファイルが表示されます。
.Pp
オプションとしては、以下のものがあります。
.Bl -tag -width indent
.It Fl A
.Ql \&.
と
.Ql \&.. 
を除く全てのエントリを表示します。スーパーユーザの場合は、通常
このオプションがセットされています。
.It Fl C
マルチカラム形式で出力します。端末への出力の場合は、
これがデフォルトになります。
.It Fl F
それぞれのパス名の最後に、ディレクトリならばスラッシュ (/)、
実行可能ファイルならばアスタリスク (*)、
シンボリックリンクならばアットマーク (@)、ソケットファイルならば等号 (=)、
.Tn FIFO
ならば縦棒 (|) をつけて表示します。
.It Fl L
引数がシンボリックリンクファイルの場合、リンクファイル自体ではなく、
リンク先のファイルやディレクトリを表示します。
.It Fl R
サブディレクトリを再帰的に表示します。
.It Fl T
ファイルの日付と時間に関する詳細情報(月・日・時・分・秒・年)を表示します。
.It Fl a
ドット (.) で始まるファイルも含めて表示します。
.It Fl c
ファイルソートや時刻出力の際、ファイルステータスの最終変更日付を使用します。
.It Fl d
引数がディレクトリの場合、再帰的に表示せず、ディレクトリそのものの
情報について表示します。また引数がシンボリックリンクファイルの場合、
リンク先ではなく、リンクファイル自体についての情報を表示します。
.It Fl f
ソートせずに表示します
.It Fl g
このオプションは、
.Bx 4.3 
との互換性のためにだけ利用すべきです。
これは、
ロングフォーマットオプション
.Pq Fl l
を使ってグループの名前を表示したい時に使います。
.It Fl i
各ファイルについて、iノード番号を表示します。
.It Fl k
.Fl s
オプションとともに使用し、ファイルサイズを
ブロック単位ではなく Kバイト単位で表示します。
.It Fl l
(``エル(L)''の小文字)。ファイルの詳細情報をロングフォーマットで
表示します(下記参照)。
端末に出力している場合、ロングフォーマットの前の行に、全ファイル
のサイズの合計値を表示します。
.It Fl o
.Pq Fl l
オプションによる詳細情報に、ファイルフラグも含めて表示します。
.It Fl q
ファイル名に表示できない文字が使われていたとき、`?' として表示します。
端末に表示するときは、デフォルトでこの指定になります。
.It Fl r
辞書式順序で逆順または時刻の古い順にソートします。
.It Fl s
各ファイルがファイルシステム上で実際に占有している
ブロック数(512バイト単位)を表示します。
ブロックの一部だけ占有しているものも整数値に切り上げられます。
端末に表示するときは、表示の先頭行に、全ファイルのサイズの合計値
を表示します。
.It Fl t
ファイルをアルファベット順に表示する前に、ファイルの最終修正日時の順
(新しいものほど先にくる)にソートします。
.It Fl u
.Pq Fl t
オプションや
.Pq Fl l
オプションで、ファイルの最終修正日時の代わりに、ファイルの最終アクセ
ス日時を使用します。
.It Fl \&1
(数字の ``1'')。 1行につき 1エントリの形式で表示します。
端末への出力でない場合には、これがデフォルトです。
.El
.Pp
.Fl 1 ,
.Fl C ,
.Fl l
オプションは、互いに他を上書きします。最後に指定されたオプションが有
効となります。
.Pp
.Fl c
と
.Fl u
オプションは、互いに他を上書きします。最後に指定されたオプションが有
効となります。
.Pp
デフォルトでは
.Nm ls
は標準出力に1行1エントリずつ表示します。
ただし、出力先が端末である場合および
.Fl C
オプションが指定された場合は別です。
.Pp
.Fl i ,
.Fl s ,
.Fl l
オプションが指定された場合、関連するファイルの情報は 1個以上の空白
をあけて表示されます。 
.Ss ロングフォーマット
.Fl l
オプションがつけられた場合、それぞれのファイルに対して以下に示す情
報が表示されます:
ファイルモード・
リンク数・所有者名・所有グループ名・
ファイルのバイト数・月の短縮形・最終更新が行なわれた際の日付・時・分・
パス名。
さらに、各ディレクトリに対して、
ディレクトリ内のファイル情報が表示される直前に、
ファイルサイズの合計値が 512 バイトブロック単位で表示されます。
.Pp
所有者または所有グループ名が不明の場合、
ID 番号で表示されます。
.Pp
ファイルがキャラクタ型もしくはブロック型スペシャルファイルである場合、
ファイルサイズフィールドには
ファイルのメジャー番号とマイナー番号が表示されます。
ファイルがシンボリックリンクファイルである場合、
リンク先ファイルのパス名が 
.Dq \-> 
によって表示されます。
.Pp
.Fl l
オプションのもとで表示されるファイルモードは、エントリタイプ、
所有者アクセス許可、所有グループアクセス許可などで成り立っています。
エントリタイプの文字はファイルのタイプを表しており、
各文字の意味は次のとおりです:
.Pp
.Bl -tag -width 4n -offset indent -compact
.It Sy b
ブロック型スペシャルファイル
.It Sy c
キャラクタ型スペシャルファイル
.It Sy d
ディレクトリ
.It Sy l
シンボリックリンクファイル
.It Sy s
ソケットファイル
.It Sy p
.Tn FIFO
.It Sy \-
通常ファイル
.El
.Pp
次の 3つのフィールドは、それぞれ 3つの文字からなっています:
所有者に対するアクセス許可・
グループに属するユーザに対するアクセス許可・
他のユーザに対するアクセス許可。
これらのフィールドはそれぞれ 3つの文字からなっています:
.Bl -enum -offset indent
.It
もし
.Sy r 
ならば読みだし可能。もし
.Sy \- 
ならば読みだし不能。
.It
もし
.Sy w 
ならば書き込み可能。もし
.Sy \- 
ならば書き込み不能。
.It
その他の場合: 以下のうち最初に該当するものが用いられる。
.Bl -tag -width 4n -offset indent
.It Sy S
所有者に対するアクセス許可において、ファイルが実行可能ではなく、かつ、
実効ユーザ ID (set-user-ID) モードがセットされている場合。
所有グループに対するアクセス許可において、ファイルが実行可能ではなく、
かつ、実効グループ ID (set-group-ID) モードがセットされている場合。
.It Sy s
所有者に対するアクセス許可において、ファイルが実行可能で、かつ、
実効ユーザ ID モードがセットされている場合。
所有グループに対するアクセス許可の中で、ファイルが実行可能で、
かつ、実効グループ ID モードがセットされている場合。 
.It Sy x
ファイルが実効可能またはディレクトリが検索可能である場合。
.It Sy \-
ファイルは、読み出し、書き込み、実行のいずれも許可されておらず、
実効ユーザ ID も実効グループ ID もスティッキービットも設定されていない場合
(以下参照)。
.El
.Pp
次の2つは他のユーザに対するアクセス許可の三番目の文字に使用されます。
.Bl -tag -width 4n -offset indent
.It Sy T
スティッキービットがセットされている(モード
.Li 1000 ) が、
実行不能あるいは検索不能である場合(
.Xr chmod 1
または
.Xr sticky 8
参照)。
.It Sy t
スティッキービットがセットされており(モード
.Li 1000 ) 、
かつ、検索可能または実行可能である場合
(
.Xr chmod 1
または
.Xr sticky 8
参照)。
.El
.El
.Pp
.Nm ls
ユーティリティは、成功時には 0 を、エラー発生時には 0 より大きい値を
返します。
.Sh 環境変数
以下の環境変数は
.Nm ls
の動作に影響を与えます:
.Bl -tag -width BLOCKSIZE
.It Ev BLOCKSIZE
ブロック数の表示を行う際、1ブロックのサイズとして環境変数
.Ev BLOCKSIZE
で指定された値が使用されます
(
.Fl s
オプション参照)。
.It COLUMNS
ターミナルのカラム幅を指定します。マルチカラム表示の際、
1 行あたりいくつのファイル名を表示できるかを算出するために参照されます
(
.Fl C
参照)。
.It Ev TZ
日時を表示するときに使われるタイムゾーンを指定します。
詳細は
.Xr environ 7
を参照してください。
.El
.Sh 互換性
.St -p1003.2
互換とするため、
ロングフォーマット形式の出力には所有グループ名フィールドが自動的に
含められます。
.Sh 関連項目
.Xr chmod 1 ,
.Xr symlink 7 ,
.Xr sticky 8
.Sh 歴史
.Nm ls
コマンドは
.At v1 
から登場しました。
.Sh 規格
.Nm ls
コマンドの機能は
.St -p1003.2
のスーパーセットであると想定しています。
