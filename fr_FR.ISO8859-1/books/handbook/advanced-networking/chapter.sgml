<!--
     The FreeBSD Documentation Project
     The FreeBSD French Documentation Project

     $FreeBSD$
     Original revision: 1.273
-->

<chapter id="advanced-networking">
  <title>Advanced Networking ** Traduction en Cours **</title>
  &trans.a.fonvieille;

  <sect1 id="advanced-networking-synopsis">
    <title>Synopsis</title>

    <para>Ce chapitre abordera certains des services r&eacute;seaux
      les plus fr&eacute;quemment utilis&eacute;s sur les
      syst&egrave;mes &unix;.  Nous verrons comment d&eacute;finir,
      mettre en place, tester et maintenir tous les services
      r&eacute;seaux qu'utilise &os;.  De plus, des exemples de
      fichier de configuration ont &eacute;t&eacute; inclus tout au
      long de ce chapitre pour que vous puissiez en
      b&eacute;n&eacute;ficier.</para>

    <para>Apr&egrave;s la lecture de ce chapitre, vous
      conna&icirc;trez:</para>

    <itemizedlist>
      <listitem>
	<para>Les bases sur les passerelles et les routes.</para>
      </listitem>

      <listitem>
	<para>Comment utiliser &os; en tant que pont
	  (&ldquo;bridge&rdquo;).</para>
      </listitem>

      <listitem>
	<para>Comment configurer le syst&egrave;me de fichiers
	  r&eacute;seau.</para>
      </listitem>

      <listitem>
	<para>Comment configurer le d&eacute;marrage via le
	  r&eacute;seau pour une machine sans disque dur.</para>
      </listitem>

      <listitem>
	<para>Comment mettre en place un serveur d'information sur le
	  r&eacute;seau pour partager les comptes utilisateurs.</para>
      </listitem>

      <listitem>
	<para>Comment configurer le param&eacute;trage r&eacute;seau
	  automatique en utilisant DHCP.</para>
      </listitem>

      <listitem>
	<para>Comment configurer un serveur de noms de domaine.</para>
      </listitem>

      <listitem>
	<para>Comment synchroniser l'heure et la date, et mettre en
	  place en serveur de temps, avec le protocole NTP.</para>
      </listitem>

      <listitem>
	<para>Comment configurer la translation d'adresse
	  r&eacute;seau.</para>
      </listitem>

      <listitem>
	<para>Comment g&eacute;rer le &ldquo;daemon&rdquo;
	  <application>inetd</application>.</para>
      </listitem>

      <listitem>
	<para>Comment connecter deux ordinateurs via PLIP.</para>
      </listitem>

      <listitem>
	<para>Comment configurer l'IPv6 sur une machine &os;.</para>
      </listitem>
    </itemizedlist>

    <para>Avant de lire ce chapitre, vous devrez:</para>

    <itemizedlist>
      <listitem>
	<para>Comprendre les bases des proc&eacute;dures
	  <filename>/etc/rc</filename>.</para>
      </listitem>

      <listitem>
	<para>Etre familier avec la terminologie r&eacute;seau de
	  base.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="network-routing">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Coranth</firstname>
	  <surname>Gryphon</surname>
	  <contrib>Contribution de </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>Passerelles et routes</title>

    <indexterm><primary>routage</primary></indexterm>
    <indexterm><primary>passerelles</primary></indexterm>
    <indexterm><primary>sous-r&eacute;seau</primary></indexterm>
    <para>Pour qu'une machine soit en mesure d'en contacter une autre,
      il faut que soit mis en place un m&eacute;canisme qui
      d&eacute;crive comment aller de l'une &agrave; l'autre.  C'est ce
      que l'on appelle le <firstterm>routage</firstterm>.  Une
      &ldquo;route&rdquo; est d&eacute;finie par une paire d'adresses:
      une &ldquo;destination&rdquo; et une &ldquo;passerelle&rdquo;.
      Cette paire signifie que pour atteindre cette
      <emphasis>destination</emphasis>, vous devez passer par cette
      <emphasis>passerelle</emphasis>.  Il y a trois sortes de
      destination: les machines individuelles, les sous-r&eacute;seaux,
      et &ldquo;default&rdquo;&mdash;la destination par d&eacute;faut.
      La route par d&eacute;faut (&ldquo;default route&rdquo;) est
      utilis&eacute;e lorsqu'aucune autre route n'est applicable.  Nous
      parlerons un peu plus des routes par d&eacute;faut par la suite.
      Il existe &eacute;galement trois sortes de passerelles: les
      machines individuelles, les interfaces (aussi appel&eacute;es
      &ldquo;liens&rdquo;), et les adresses Ethernet mat&eacute;rielles
      (adresses MAC).</para>

    <sect2>
      <title>Un exemple</title>

      <para>Pour illustrer diff&eacute;rents aspects du routage,
	nous utiliserons l'exemple suivant, qui est produit par la
	commande <command>netstat</command>:</para>

      <screen>&prompt.user; <userinput>netstat -r</userinput>
Routing tables

Destination      Gateway            Flags     Refs     Use     Netif Expire

default          outside-gw         UGSc       37      418      ppp0
localhost        localhost          UH          0      181       lo0
test0            0:e0:b5:36:cf:4f   UHLW        5    63288       ed0     77
10.20.30.255     link#1             UHLW        1     2421
example.com      link#1             UC          0        0
host1            0:e0:a8:37:8:1e    UHLW        3     4601       lo0
host2            0:e0:a8:37:8:1e    UHLW        0        5       lo0 =>
host2.example.com link#1             UC          0        0
224              link#1             UC          0        0</screen>

      <indexterm><primary>route par d&eacute;faut</primary></indexterm>
      <para>Les deux premi&egrave;res lignes d&eacute;finissent la
	route par d&eacute;faut (dont nous parlerons dans la <link
	linkend="network-routing-default">section suivante</link>) et la
	route <hostid>localhost</hostid>.</para>

      <indexterm><primary>interface en boucle</primary></indexterm>
      <para>L'interface (colonne <literal>Netif</literal>) qu'il est
	indiqu&eacute; d'utiliser pour <literal>localhost</literal> est
	<devicename>lo0</devicename>, aussi appel&eacute;e interface
	&ldquo;loopback&rdquo;&mdash;en boucle.  Ce qui veut dire que
	tout le trafic vers cette destination doit rester interne, au
	lieu d'&ecirc;tre envoy&eacute; sur le r&eacute;seau local,
	puisqu'il reviendra de toute fa&ccedil;on &agrave; son point de
	d&eacute;part.</para>

      <indexterm>
	<primary>Ethernet</primary>
	<secondary>adresse MAC</secondary>
      </indexterm>
      <para>Ce qui se remarque ensuite, ce sont les adresses
	commen&ccedil;ant par <hostid role="mac">0:e0:</hostid>.  Ce
	sont les adresses Ethernet mat&eacute;rielles, qui sont
	&eacute;galement connues sous le nom d'adresses MAC.  &os;
	reconna&icirc;tra automatiquement toute machine
	(<hostid>test0</hostid> dans l'exemple) sur le r&eacute;seau
	local Ethernet et ajoutera une route vers cette machine,
	directement via l'interface Ethernet
	<devicename>ed0</devicename>.  Il y a aussi un d&eacute;lai
	(colonne <literal>Expire</literal>) associ&eacute; &agrave; ce
	type de route, qui est utilis&eacute; si l'on entend plus parler
	de cette machine pendant un laps de temps pr&eacute;cis.  Quand
	cela arrive, la route vers cette machine est automatiquement
	supprim&eacute;e.  Ces machines sont identifi&eacute;es par un
	m&eacute;canisme appel&eacute; RIP (&ldquo;Routing Information
	Protocol&rdquo;&mdash;protocole d'information de routage), qui
	met en place des routes vers les machines locales en
	d&eacute;terminant le chemin le plus court.</para>

      <indexterm><primary>sous-r&eacute;seau</primary></indexterm>
      <para>&os; ajoutera &eacute;galement des routes de
	sous-r&eacute;seau pour le sous-r&eacute;seau local (<hostid
	role="ipaddr">10.20.30.255</hostid> est l'adresse de diffusion
	pour le sous-r&eacute;seau <hostid
	role="ipaddr">10.20.30</hostid>, et <hostid
	role="domainname">example.com</hostid> est le nom de domaine
	associ&eacute; &agrave; ce sous-r&eacute;seau).  La
	d&eacute;nomination <literal>link#1</literal> fait
	r&eacute;f&eacute;rence &agrave; la premi&egrave;re carte
	Ethernet de la machine.  Vous constaterez qu'il n'y a pas
	d'autre interface associ&eacute;e &agrave; ces routes.</para>

      <para>Ces deux types de routes (vers les machines du
	r&eacute;seau local et les sous-r&eacute;seaux locaux) sont
	automatiquement configur&eacute;s par un &ldquo;daemon&rdquo;
	appel&eacute; <application>routed</application>.  S'il ne
	tourne pas, alors seules les routes d&eacute;finies comme
	statiques (i.e. explicitement d&eacute;finies)
	existeront.</para>

      <para>La ligne <literal>host1</literal> fait
	r&eacute;f&eacute;rence &agrave; votre machine, qui est
	identifi&eacute;e par l'adresse Ethernet.  Puisque nous sommes
	l'&eacute;metteur, &os; sait qu'il faut utiliser l'interface
	en &ldquo;boucle&rdquo; (<devicename>lo0</devicename>)
	plut&ocirc;t que d'envoyer les donn&eacute;es sur l'interface
	Ethernet.</para>

      <para>Les deux lignes <literal>host2</literal> montrent ce qui
	se passe quand on utilise un alias avec &man.ifconfig.8;
	(lisez la section sur l'Ethernet pour savoir pour quelles
	raisons on peut vouloir cela).  Le symbole
	<literal>=&gt;</literal> qui suit l'interface
	<devicename>lo0</devicename> indique que non seulement nous
	utilisons l'interface en &ldquo;boucle&rdquo; (puisque cette
	adresse correspond &eacute;galement &agrave; la machine
	locale), mais que c'est plus sp&eacute;cifiquement un alias.
	Ce type de route n'appara&icirc;t que sur la machine pour
	laquelle est d&eacute;fini l'alias; sur toutes les autres
	machines du r&eacute;seau local il n'y aura q'une ligne
	<literal>link#1</literal> pour cette machine.</para>

      <para>La derni&egrave;re ligne (le sous-r&eacute;seau
	destinataire <hostid role="ipaddr">224</hostid>) concerne le
	multicasting (diffusion pour plusieurs destinataires), qui
	sera abord&eacute; dans une autre section.</para>

      <para>Et enfin, diverses caract&eacute;ristiques de chaque route
	sont indiqu&eacute;es dans la colonne <literal>Flags</literal>
	(indicateurs).  Ci-dessous, une courte table pr&eacute;sente
	certains de ces indicateurs et leur signification:</para>

      <informaltable frame="none">
	<tgroup cols="2">
	  <tbody>
	    <row>
	      <entry>U</entry>
	      <entry>Active (&ldquo;Up&rdquo;): la route est
		active.</entry>
	    </row>

	    <row>
	      <entry>H</entry>
	      <entry>Machine (&ldquo;Host&rdquo;): la destination de
		la route est une machine.</entry>
	    </row>

	    <row>
	      <entry>G</entry>
	      <entry>Passerelle (&ldquo;Gateway&rdquo;): envoyer tout
		ce qui concerne cette destination sur la machine
		distante indiqu&eacute;e, qui d&eacute;terminera
		&agrave; qui transmettre ensuite.</entry>
	    </row>

	    <row>
	      <entry>S</entry>
	      <entry>Statique (&ldquo;Static&rdquo;): cette route a
		&eacute;t&eacute; configur&eacute;e manuellement et non
		pas g&eacute;n&eacute;r&eacute;e automatiquement par le
		syst&egrave;me.</entry>
	    </row>

	    <row>
	      <entry>C</entry>
	      <entry>Clone: g&eacute;n&egrave;re une nouvelle route
		sur la base de celle-ci pour les machines auxquelles
		nous nous connectons.  Ce type de route est normalement
		utilis&eacute; pour les r&eacute;seaux locaux.</entry>
	    </row>

	    <row>
	      <entry>W</entry>
	      <entry>Clon&eacute;e (&ldquo;WasCloned&rdquo;): cette
		route a &eacute;t&eacute; auto-configur&eacute;e (Clone)
		&agrave; partir d'une route pour le r&eacute;seau
		local.</entry>
	    </row>

	    <row>
	      <entry>L</entry>
	      <entry>Lien (&ldquo;Link&rdquo;): la route fait
		r&eacute;f&eacute;rence &agrave; une adresse
		mat&eacute;rielle Ethernet.</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>
    </sect2>

    <sect2 id="network-routing-default">
      <title>Routes par d&eacute;faut</title>

      <indexterm><primary>route par d&eacute;faut</primary></indexterm>
      <para>Quand le syst&egrave;me local doit &eacute;tablir une
	connexion avec une machine distante, il consulte la table de
	routage pour voir s'il existe d&eacute;j&agrave; une route
	connue.  Si la machine distante appartient &agrave; un
	sous-r&eacute;seau auquel le syst&egrave;me sait se connecter
	(routes clon&eacute;es), alors le syst&egrave;me v&eacute;rifie
	s'il peut se connecter via cette interface.</para>

      <para>Si toutes les routes connues &eacute;chouent, il reste
	alors au syst&egrave;me une derni&egrave;re option: la route
	par &ldquo;d&eacute;faut&rdquo;.  Cette route est un type
	particulier de route passerelle (c'est
	g&eacute;n&eacute;ralement la seule du syst&egrave;me), et est
	toujours marqu&eacute;e avec un <literal>c</literal> dans le
	champ des indicateurs.  Pour les machines du r&eacute;seau
	local, cette passerelle est d&eacute;finie avec la machine qui
	est directement connect&eacute;e au monde ext&eacute;rieur
	(que ce soit par une liaison PPP, DSL, cable, T1, ou toute
	autre interface r&eacute;seau).</para>

      <para>Si vous configurez la route par d&eacute;faut sur une
	machine qui fonctionne comme passerelle vers le monde
	ext&eacute;rieur, alors la route par d&eacute;faut sera la
	passerelle de votre Fournisseur d'Acc&egrave;s &agrave;
	Internet (FAI).</para>

      <para>Examinons un exemple de route par d&eacute;faut.  Voici
	une configuration classique:</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="advanced-networking/net-routing">
	</imageobject>

	<textobject>
	  <literallayout class="monospaced">
[Local2]  &lt;--ether--&gt;  [Local1]  &lt;--PPP--&gt; [FAI-Serv]  &lt;--ether--&gt;  [T1-GW]
      </literallayout>
	</textobject>
      </mediaobject>

      <para>Les machines <hostid>Local1</hostid> et
	<hostid>Local2</hostid> sont sur votre site.
	<hostid>Local1</hostid> est connect&eacute;e au serveur du FAI
	via une liaison PPP par modem.  Ce serveur PPP est
	connect&eacute; par l'interm&eacute;diaire d'un r&eacute;seau
	local &agrave; un autre ordinateur passerelle reli&eacute; au
	point d'entr&eacute;e Internet du FAI.</para>

      <para>Les routes par d&eacute;faut sur chacune de vos machines
	seront:</para>

      <informaltable frame="none">
	<tgroup cols="3">
	  <thead>
	    <row>
	      <entry>Machine</entry>
	      <entry>Passerelle par d&eacute;faut</entry>
	      <entry>Interface</entry>
	    </row>
	  </thead>

	  <tbody>
	    <row>
	      <entry>Local2</entry>
	      <entry>Local1</entry>
	      <entry>Ethernet</entry>
	    </row>

	    <row>
	      <entry>Local1</entry>
	      <entry>T1-GW</entry>
	      <entry>PPP</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>

      <para>Une question qui revient souvent est &ldquo;Pourquoi
	(ou comment) d&eacute;finir <hostid>T1-GW</hostid> comme
	passerelle par d&eacute;faut pour <hostid>Local1</hostid>,
	plut&ocirc;t que le serveur du FAI auquel elle est
	connect&eacute;e?&ldquo;.</para>

      <para>Rappelez-vous, puisque l'interface PPP utilise, de votre
	c&ocirc;t&eacute; de la connexion, une adresse IP du
	r&eacute;seau local du FAI, les routes vers toute autre
	machine du r&eacute;seau local du FAI seront automatiquement
	g&eacute;n&eacute;r&eacute;es.  Par cons&eacute;quent vous
	savez d&eacute;j&agrave; comment atteindre la machine
	<hostid>T1-GW</hostid>, il n'y a donc pas besoin
	d'&eacute;tape interm&eacute;diaire qui passe par le serveur
	du FAI.</para>

      <para>Il est habituel d'attribuer l'adresse <hostid
	role="ipaddr">X.X.X.1</hostid> &agrave; la passerelle sur
	votre r&eacute;seau local.  Donc (dans notre exemple), si
	votre espace d'adresse de classe C local &eacute;tait <hostid
	role="ipaddr">10.20.30</hostid> et que votre FAI utilisait
	l'espace <hostid role="ipaddr">10.9.9</hostid>, alors les
	routes par d&eacute;faut seraient:</para>

      <informaltable frame="none">
	<tgroup cols="2">
	  <thead>
	    <row>
	      <entry>Machine</entry>
	      <entry>Route par d&eacute;faut</entry>
	    </row>
	  </thead>
	  <tbody>
	    <row>
	      <entry>Local2 (10.20.30.2)</entry>
	      <entry>Local1 (10.20.30.1)</entry>
	    </row>
	    <row>
	      <entry>Local1 (10.20.30.1, 10.9.9.30)</entry>
	      <entry>T1-GW (10.9.9.1)</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>

      <para>Vous pouvez ais&eacute;ment d&eacute;finir la route par
	d&eacute;faut via le fichier
	<filename>/etc/rc.conf</filename>.  Dans notre exemple, sur la
	machine <hostid>Local2</hostid>, nous avons ajout&eacute; la
	ligne suivante dans <filename>/etc/rc.conf</filename>:</para>

      <programlisting>defaultrouter="10.20.30.1"</programlisting>

      <para>Il est &eacute;galement possible de faire directement cela
	&agrave; partir de la ligne de commande avec la commande
	&man.route.8;:</para>

      <screen>&prompt.root; <userinput>route add default 10.20.30.1</userinput></screen>

      <para>Pour plus d'informations sur la manipulation &agrave; la
	main des tables de routage r&eacute;seau, consultez la page de
	manuel &man.route.8;.</para>
    </sect2>

    <sect2>
      <title>Machines sur deux r&eacute;seaux</title>

      <indexterm><primary>machines sur deux r&eacute;seaux</primary></indexterm>
      <para>Il y a un autre type de configuration dont il faut parler,
	c'est celle d'une machine qui est connect&eacute;e &agrave; deux
	r&eacute;seaux diff&eacute;rents.  Techniquement, toute machine
	servant de passerelle (comme dans l'exemple ci-dessus, en
	utilisant une connexion PPP) est une machine sur deux
	r&eacute;seaux.  Mais ce terme n'est normalement utilis&eacute;
	que pour faire r&eacute;f&eacute;rence &agrave; une machine qui
	est sur deux r&eacute;seaux locaux diff&eacute;rents.</para>

      <para>Selon le cas, la machine dispose de deux cartes Ethernet,
	ayant chacune une adresse sur des sous-r&eacute;seaux
	s&eacute;par&eacute;s.  Alternativement, la machine peut ne
	disposer que d'une seule carte Ethernet, et utiliser des alias
	avec &man.ifconfig.8;.  Le permier cas correspond &agrave;
	l'utilisation de deux r&eacute;seaux Ethernet physiquement
	s&eacute;par&eacute;s, le deuxi&egrave;me cas est
	employ&eacute; s'il n'y a qu'un seul r&eacute;seau physique
	mais deux sous-r&eacute;seaux logiquement distincts.</para>

      <para>Dans les deux cas, les tables de routage sont
	d&eacute;finies de telle sorte que chaque sous-r&eacute;seau
	sache que cette machine est la passerelle (route entrante)
	vers l'autre sous-r&eacute;seau.  Cette configuration,
	o&ugrave; la machine sert de routeur entre les deux
	sous-r&eacute;seaux, est souvent utilis&eacute;e quand il faut
	mettre en place un dispositif de s&eacute;curit&eacute;:
	filtrage de paquets ou coupe-feu, dans l'une ou dans les deux
	directions.</para>

      <para>Si vous voulez que cette machine transmette
	r&eacute;ellement les paquets entre les deux interfaces, vous
	devez demander &agrave; &os; d'activer cette
	fonctionnalit&eacute;.  Lisez la section suivante pour plus de
	d&eacute;tails sur comment faire cela.</para>
    </sect2>

    <sect2 id="network-dedicated-router">
      <title>Mettre en place un routeur</title>

      <indexterm><primary>routeur</primary></indexterm>

      <para>Un routeur est un syst&egrave;me qui transmet les paquets
	d'une interface &agrave; une autre.  Les standards de
	l'Internet et de bons principes d'ing&eacute;nierie
	emp&ecirc;chent le projet &os; d'activer cette fonction par
	d&eacute;faut sous &os;.  Vous pouvez l'activer en
	positionnant &agrave; <literal>YES</literal> la variable
	suivante du fichier &man.rc.conf.5;:</para>

      <programlisting>gateway_enable=YES          # Set to YES if this host will be a gateway</programlisting>

      <para>Cette option fixera la variable &man.sysctl.8;
	<varname>net.inet.ip.forwarding</varname> &agrave; la valeur
	<literal>1</literal>.  Si vous devez arr&ecirc;ter
	temporairement le routage, vous pouvez positionner la variable
	momentan&eacute;ment &agrave; <literal>0</literal>.</para>

      <para>Votre nouveau routeur aura besoin de route pour savoir
	o&ugrave; envoyer le trafic.  Si votre r&eacute;seau est
	suffisamment simple vous pouvez utiliser des routes statiques.
	&os; est &eacute;galement fourni avec le &ldquo;daemon&rdquo;
	de routage BSD standard &man.routed.8;, qui comprend et
	utilise les protocoles RIP (version 1 est 2) et IRDP.  Le
	support de BGP v4, OSPF v2, et d'autres protocoles de routage
	sophistiqu&eacute; est disponible avec le logiciel <filename
	role="package">net/zebra</filename>.  Des produits commerciaux
	comme <application>&gated;</application> sont &eacute;galement
	disponibles comme solutions avanc&eacute;es de routage.</para>

<indexterm><primary>BGP</primary></indexterm>
<indexterm><primary>RIP</primary></indexterm>
<indexterm><primary>OSPF</primary></indexterm>

      <para>M&ecirc;me quand &os; est configur&eacute; de cette
	mani&egrave;re, il ne respecte pas compl&egrave;tement les
	standards Internet en mati&egrave;re de routeur.  Il en est
	cependant suffisamment proche pour une utilisation
	ordinaire.</para>
    </sect2>

    <sect2>
      <title>Propagation de route</title>
      <indexterm><primary>propagation de route</primary></indexterm>

      <para>Nous avons d&eacute;j&agrave; expliqu&eacute; comment
	d&eacute;finir nos routes vers le monde ext&eacute;rieur, mais
	pas comment le monde ext&eacute;rieur apprend &agrave; nous
	localiser.</para>

      <para>Nous savons d&eacute;j&agrave; que les tables de routages
	peuvent &ecirc;tre renseign&eacute;es pour que tout le trafic
	pour un espace d'adresses donn&eacute; (dans nos exemples, un
	sous-r&eacute;seau de classe C) soit envoy&eacute; &agrave;
	une machine pr&eacute;cise de ce r&eacute;seau, qui
	transmettra les paquets entrants.</para>

      <para>Lorsqu'il attribue un espace d'adresses &agrave; votre
	site, votre fournisseur d'acc&egrave;s d&eacute;finira ses
	tables de routage de sorte que tout le trafic destin&eacute;
	&agrave; votre sous-r&eacute;seau vous soit envoy&eacute; sur
	votre liaison PPP.  Mais comment les sites &agrave; l'autre
	bout du pays savent-ils qu'ils doivent passer par votre
	fournisseur d'acc&egrave;s?</para>

      <para>Il existe un m&eacute;canisme (assez semblable au
	syst&egrave;me d'information distribu&eacute; du DNS) qui
	conserve un enregistrement de tous les espaces d'adresses
	affect&eacute;s, et d&eacute;finit leur point de connexion
	&agrave; la dorsale Internet (&ldquo;backbone&rdquo;).  La
	&ldquo;dorsale&rdquo; comprend les liaisons principales qui
	v&eacute;hiculent le trafic Internet &agrave; travers le pays
	et le monde entier.  Chaque machine de la dorsale dispose
	d'une copie de l'ensemble des tables ma&icirc;tresses qui
	aiguillent le trafic pour un r&eacute;seau donn&eacute; vers
	le transporteur correspondant de la dorsale, et de l&agrave;
	par l'interm&eacute;diaire de fournisseurs d'acc&egrave;s
	successifs, jusqu'&agrave; atteindre votre
	r&eacute;seau.</para>

      <para>C'est le r&ocirc;le de votre fournisseur d'acc&egrave;s
	d'annoncer aux sites de la dorsale qu'il est le point de
	connexion (et par cons&eacute;quent la route entrante) pour
	votre site.  C'est ce que l'on appelle la propagation de
	route.</para>
    </sect2>

    <sect2>
      <title>En cas de probl&egrave;me</title>
      <indexterm>
	<primary><command>traceroute</command></primary>
      </indexterm>
      <para>Il se peut qu'il y ait parfois un probl&egrave;me avec la
	propagation de route et que certains sites ne puissent vous
	atteindre.  La commande probablement la plus utile pour
	d&eacute;terminer o&ugrave; une route est d&eacute;faillante est
	la commande &man.traceroute.8;.  Elle est &eacute;galement utile
	si vous n'arrivez pas &agrave; vous connecter &agrave; une
	machine distante (i.e.  lorsque &man.ping.8;
	&eacute;choue).</para>

      <para>La commande &man.traceroute.8; prend comme
	param&egrave;tre le nom de la machine distante avec laquelle
	vous essayez d'&eacute;tablir une connexion.  Elle vous
	donnera la liste de passerelles interm&eacute;diaires
	jusqu'&agrave; la machine cible, ou jusqu'&agrave; ce qu'il
	n'y ait plus de connexion.</para>

      <para>Pour plus d'informations, consultez la page de manuel de
	&man.traceroute.8;.</para>
    </sect2>

    <sect2>
      <title>Routage multicast</title>
      <indexterm>
	<primary>multicast</primary>
	<secondary>options MROUTING</secondary>
      </indexterm>
      <para>&os; supporte nativement les applications et le routage
	multicast (diffusion pour plusieurs destinataires).  Les
	applications multicast ne n&eacute;cessitent pas de
	configuration sp&eacute;cifique de &os;,
	g&eacute;n&eacute;ralement, elles fonctionneront directement.
	Le routage multicast demande &agrave; ce que le support soit
	compil&eacute; dans le noyau:</para>

      <programlisting>options MROUTING</programlisting>

      <para>De plus, le &ldquo;daemon&rdquo; de routage multicast,
	&man.mrouted.8; doit &ecirc;tre configur&eacute; par
	l'interm&eacute;diaire du fichier
	<filename>/etc/mrouted.conf</filename> pour mettre en place
	des tunnels et le protocole DVMRP.  Plus de d&eacute;tails sur
	la configuration du routage multicast peuvent &ecirc;tre
	trouv&eacute;s dans la page de manuel de
	&man.mrouted.8;.</para>
    </sect2>
  </sect1>

  <sect1 id="network-wireless">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Eric</firstname>
	  <surname>Anderson</surname>
	  <contrib>Ecrit par </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>R&eacute;seau sans fil</title>

    <indexterm><primary>r&eacute;seau sans fil</primary></indexterm>
    <indexterm>
      <primary>802.11</primary>
      <see>r&eacute;seau sans fil</see>
    </indexterm>

    <sect2>
      <title>Introduction</title>

      <para>Il peut &ecirc;tre tr&egrave;s utile de pouvoir utiliser
	un micro-ordinateur sans le d&eacute;sagr&eacute;ment
	d'&ecirc;tre constamment reli&eacute; &agrave; un c&acirc;ble
	r&eacute;seau.  &os; peut &ecirc;tre utilis&eacute; comme
	client sans fil, et m&ecirc;me comme &ldquo;point
	d'acc&egrave;s&rdquo; sans fil.</para>
    </sect2>

    <sect2>
      <title>Modes de fonctionnement des syst&egrave;mes sans
	fils</title>

      <para>Il existe deux mani&egrave;res diff&eacute;rentes de
	configurer les p&eacute;riph&eacute;riques sans fil 802.11:
	les modes BSS et IBSS.</para>

      <sect3>
	<title>Mode BSS</title>

	<para>Le mode BSS est le mode g&eacute;n&eacute;ralement
	  utilis&eacute;.  Le mode BSS est &eacute;galement
	  appel&eacute; mode infrastructure.  Dans ce mode, plusieurs
	  points d'acc&egrave;s sans fils sont connect&eacute;s
	  &agrave; un r&eacute;seau c&acirc;bl&eacute;.  Chaque
	  r&eacute;seau sans fil poss&egrave;de son propre nom.  Ce
	  nom est ce que l'on appelle le &ldquo;SSID&rdquo; du
	  r&eacute;seau.</para>

	<para>Les clients sans fils se connectent &agrave; ces points
	  d'acc&egrave;s sans fils.  La norme IEEE 802.11
	  d&eacute;finie le protocole que les r&eacute;seaux sans fils
	  utilisent pour les connexions.  Un client sans fil peut
	  &ecirc;tre attach&eacute; &agrave; un r&eacute;seau
	  particulier quand un SSID est fix&eacute;.  Un client peut
	  s'attacher &agrave; n'importe quel r&eacute;seau en ne
	  d&eacute;finissant pas explicitement de SSID.</para>
      </sect3>

      <sect3>
	<title>Mode IBSS</title>

	<para>Le mode IBSS, &eacute;galement appel&eacute; mode
	  &ldquo;ad-hoc&rdquo;, est con&ccedil;u pour les connexions
	  point &agrave; point.  Il existe en fait deux types de mode
	  ad-hoc.  Le premier est le mode IBSS, &eacute;galement
	  appel&eacute; mode ad-hoc ou IEEE ad-hoc.  Ce mode est
	  d&eacute;fini par les normes IEEE 802.11.  Le
	  deuxi&egrave;me mode est appel&eacute; ad-hoc d&eacute;mo ou
	  encore mode ad-hoc Lucent (et parfois, ce qui pr&ecirc;te
	  &agrave; confusion, mode ad-hoc).  C'est l'ancien mode
	  ad-hoc pr&eacute;-standard 802.11 et ne devrait &ecirc;tre
	  utilis&eacute; qu'avec d'anciennes installations.  Nous ne
	  parlerons pas des modes ad-hoc dans ce qui suit.</para>
      </sect3>
    </sect2>

    <sect2>
      <title>Mode infrastructure</title>

      <sect3>
	<title>Points d'acc&egrave;s</title>

	<para>Un point d'acc&egrave;s est un
	  p&eacute;riph&eacute;rique sans fil qui permet &agrave; un
	  ou plusieurs clients sans fils d'utiliser ce
	  p&eacute;riph&eacute;rique comme un hub.  Quand ils
	  utilisent un point d'acc&egrave;s, tous les clients
	  communiquent par l'interm&eacute;diaire de ce point
	  d'acc&egrave;s.  Plusieurs points d'acc&egrave;s sont
	  souvent utilis&eacute;s pour couvrir
	  l'int&eacute;gralit&eacute; d'une zone g&eacute;ographique
	  comme une maison, une entreprise, ou un parc avec un
	  r&eacute;seau sans fil.</para>

	<para>Les points d'acc&egrave;s ont g&eacute;n&eacute;ralement
	  plusieurs connexions r&eacute;seaux: la carte r&eacute;seaux
	  sans fil, et une ou plusieurs cartes r&eacute;seaux Ethernet
	  pour les connexions avec le reste du r&eacute;seau.</para>

	<para>Les points d'acc&egrave;s peuvent &ecirc;tre
	  achet&eacute;s tout fait, ou vous pouvez construire le votre
	  avec &os; et une carte r&eacute;seau sans fil
	  support&eacute;e.  De nombreux constructeurs proposent des
	  points d'acc&egrave;s et des cartes r&eacute;seaux sans fils
	  avec diverses fonctionnalit&eacute;s.</para>
      </sect3>

      <sect3>
	<title>Construire un point d'acc&egrave;s avec &os;</title>
	<indexterm>
	  <primary>r&eacute;seau sans fil</primary>
	  <secondary>point d'acc&egrave;s</secondary>
	</indexterm>

	<sect4>
	  <title>Pr&eacute;-requis</title>

	  <para>En vue de mettre en place un point d'acc&egrave;s sans
	    fil sous &os;, vous avez besoin d'une carte r&eacute;seau
	    sans fil compatible.  Actuellement seule les cartes
	    bas&eacute;es sur le circuit Prism sont support&eacute;es.
	    Vous aurez &eacute;galement besoin d'une carte
	    r&eacute;seau c&acirc;bl&eacute;e support&eacute;e par
	    &os; (cela ne devrait pas &ecirc;tre difficile &agrave;
	    trouver, &os; supporte de nombreuses cartes).  Dans le
	    cadre de cette section, nous supposerons que le trafic
	    passera par un pont entre la carte sans fil et le
	    r&eacute;seau reli&eacute; &agrave; la carte r&eacute;seau
	    classique.</para>

	  <para>Le mode point d'acc&egrave;s impl&eacute;ment&eacute;
	    par &os; fonctionne mieux avec certaines versions de
	    firmware.  Les cartes utilisant un circuit Prism 2
	    devraient utiliser un firmware 1.3.4 ou plus
	    r&eacute;cent.  Les cartes Prism 2.5 et Prism 3 devraient
	    utiliser la version 1.4.9.  Des versions de firmware plus
	    anciennes pourront ne pas fonctionner correctement.
	    Actuellement, la seule mani&egrave;re de mettre &agrave;
	    jour vos cartes est d'utiliser les outils de mise &agrave;
	    jour du firmware pour &windows; disponibles aupr&egrave;s
	    du constructeur de votre carte.</para>
	</sect4>

	<sect4>
	  <title>Configuration</title>

	  <para>Assurez-vous tout d'abord que votre syst&egrave;me
	    voit la carte r&eacute;seau sans fil:</para>

	  <screen>&prompt.root; <userinput>ifconfig -a</userinput>
wi0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
	inet6 fe80::202:2dff:fe2d:c938%wi0 prefixlen 64 scopeid 0x7
	inet 0.0.0.0 netmask 0xff000000 broadcast 255.255.255.255
	ether 00:09:2d:2d:c9:50
	media: IEEE 802.11 Wireless Ethernet autoselect (DS/2Mbps)
	status: no carrier
	ssid ""
	stationname "FreeBSD Wireless node"
	channel 10 authmode OPEN powersavemode OFF powersavesleep 100
	wepmode OFF weptxkey 1</screen>

	  <para>Ne vous pr&eacute;occupez pas des d&eacute;tails,
	    verifiez juste que s'affiche quelque chose qui vous
	    indique qu'une carte r&eacute;seau sans fil est
	    install&eacute;e.  Si vous avez des probl&egrave;mes
	    &agrave; voir l'interface r&eacute;seau sans fil
	    correspondante, et que vous utilisez une carte de type PC
	    Card, vous devriez consultez les pages de manuel
	    &man.pccardc.8; et &man.pccardd.8; pour plus
	    d'information.</para>

	  <para>Ensuite, vous devrez charger un module afin de mettre
	    en place la partie de &os; faisant office de pont pour le
	    point d'acc&egrave;s.  Pour charger le module
	    &man.bridge.4;, ex&eacute;cutez la commande
	    suivante:</para>

	  <screen>&prompt.root; <userinput>kldload bridge</userinput></screen>

	  <para>Vous ne devriez pas voir appara&icirc;tre de message
	    d'erreur lors du chargement du module.  Si ce n'est pas le
	    cas, vous devrez peut-&ecirc;tre compiler le support
	    &man.bridge.4; dans votre noyau.  La section sur le <link
	    linkend="network-bridging">Bridging</link> de ce manuel
	    devrait pouvoir vous aider dans cette t&acirc;che.</para>

	  <para>Maintenant que cette partie est assur&eacute;e, nous
	    devons dire &agrave; &os; entre quelles interface le pont
	    doit &ecirc;tre install&eacute;.  Nous effectuons cette
	    configuration en utilisant &man.sysctl.8;:</para>

	  <screen>&prompt.root; <userinput>sysctl net.link.ether.bridge=1</userinput>
&prompt.root; <userinput>sysctl net.link.ether.bridge_cfg="wi0,xl0"</userinput>
&prompt.root; <userinput>sysctl net.inet.ip.forwarding=1</userinput></screen>

	  <para>Sous &os;&nbsp;5.2-RELEASE et versions suivantes, vous
	    devez utiliser &agrave; la place les options
	    suivantes:</para>

	  <screen>&prompt.root; <userinput>sysctl net.link.ether.bridge.enable=1</userinput>
&prompt.root; <userinput>sysctl net.link.ether.bridge.config="wi0,xl0"</userinput>
&prompt.root; <userinput>sysctl net.inet.ip.forwarding=1</userinput></screen>

	  <para>Il est maintenant possible de configurer la carte.  La
	    commande suivante positionnera la carte en mode point
	    d'acc&egrave;s:</para>

	  <screen>&prompt.root; <userinput>ifconfig wi0 ssid <replaceable>my_net</replaceable> channel 11 media DS/11Mbps mediaopt hostap up stationname "<replaceable>FreeBSD AP</replaceable>"</userinput></screen>

	  <para>La ligne &man.ifconfig.8; active l'interface
	    <devicename>wi0</devicename>, fixe son param&egrave;tre
	    SSID &agrave; la valeur <replaceable>my_net</replaceable>,
	    et fixe le nom de station &agrave; <replaceable>FreeBSD
	    AP</replaceable>.  L'option <option>media
	    DS/11Mbps</option> positionne la carte dans le mode 11Mbps
	    et est n&eacute;cessaire pour que le param&egrave;tre
	    <option>mediaopt</option> soit pris en compte.  L'option
	    <option>mediaopt hostap</option> place l'interface dans le
	    mode point d'acc&egrave;s.  L'option <option>channel
	    11</option> fixe le canal 802.11b &agrave; employer.  La
	    page de manuel &man.wicontrol.8; donne les options de
	    canaux valides en fonction de votre zone
	    g&eacute;ographique.</para>

	  <para>Vous devez maintenant disposer d'un point
	    d'acc&egrave;s op&eacute;rationnel et en fonctionnement.
	    Vous &ecirc;tes encourag&eacute;s &agrave; lire les pages
	    de manuel &man.wicontrol.8;, &man.ifconfig.8;, et
	    &man.wi.4; pour plus d'amples informations.</para>

	  <para>Il est &eacute;galement conseill&eacute; de lire la
	    section qui suit sur le chiffrage.</para>
	</sect4>

	<sect4>
	  <title>Information d'&eacute;tat</title>

	  <para>Une fois que le point d'acc&egrave;s est
	    configur&eacute; et op&eacute;rationnel, les
	    op&eacute;rateurs voudront voir quels clients sont
	    associ&eacute;s avec le point d'acc&egrave;s.  A n'importe
	    quel instant, l'op&eacute;rateur pourra taper:</para>

	  <screen>&prompt.root; <userinput>wicontrol -l</userinput>
1 station:
00:09:b7:7b:9d:16  asid=04c0, flags=3&lt;ASSOC,AUTH&gt;, caps=1&lt;ESS&gt;, rates=f&lt;1M,2M,5.5M,11M&gt;, sig=38/15</screen>

	  <para>Ceci nous montre qu'une station est associ&eacute;e,
	    ainsi que son param&eacute;trage.  Les informations
	    indiqu&eacute;es concernant le signal devraient &ecirc;tre
	    utilis&eacute;es uniquement comme une indication relative
	    sur sa puissance.  Sa conversion en dBm ou tout autre
	    unit&eacute; varie en fonction des diff&eacute;rentes
	    versions de firmware.</para>
	</sect4>
      </sect3>

      <sect3>
	<title>Clients</title>

	<para>Un client sans fil est un syst&egrave;me qui se connecte
	  &agrave; un point d'acc&egrave;s ou un autre client
	  directement.</para>

	<para>Typiquement, les clients sans fils disposent d'une seule
	  interface r&eacute;seau, la carte r&eacute;seau sans
	  fil.</para>

	<para>Il existe quelques mani&egrave;res diff&eacute;rentes de
	  configurer un client sans fil.  Elles sont bas&eacute;es sur
	  les diff&eacute;rents modes sans fils,
	  g&eacute;n&eacute;ralement les modes BSS (mode
	  infrastructure, qui n&eacute;cessite un point
	  d'acc&egrave;s), et IBSS (mode ad-hoc, ou mode point
	  &agrave; point).  Dans notre exemple, nous utiliserons le
	  plus populaire des deux, le mode BSS, pour discuter avec un
	  point d'acc&egrave;s.</para>

	<sect4>
	  <title>Pr&eacute;-requis</title>

	  <para>Il n'y a qu'un seul pr&eacute;-requis pour configurer
	    &os; comme client sans fil.  Vous aurez besoin d'une carte
	    sans fil support&eacute;e par &os;.</para>
	</sect4>

	<sect4>
	  <title>Configurer un client sans fil &os;</title>

	  <para>Avant de commencer, vous aurez besoin de
	    conna&icirc;tre certaines choses concernant le
	    r&eacute;seau sans fil auquel vous d&eacute;sirez vous
	    connecter.  Dans cet exemple, nous rejoignons un
	    r&eacute;seau ayant pour nom
	    <replaceable>my_net</replaceable>, et avec le chiffrage
	    des liaisons d&eacute;sactiv&eacute;.</para>

	  <note>
	    <para>Dans cet exemple, nous n'utilisons pas le chiffrage
	      des liaisons, ce qui est une situation dangereuse.  Dans
	      la section suivante, nous verrons comment activer le
	      chiffrage, pourquoi il est important de le faire, et
	      pourquoi certaines technologies de chiffrage ne vous
	      prot&eacute;gerons pas compl&egrave;tement.</para>
	  </note>

	  <para>Assurez-vous que votre carte est reconnue par
	    &os;:</para>

	  <screen>&prompt.root; <userinput>ifconfig -a</userinput>
wi0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
	inet6 fe80::202:2dff:fe2d:c938%wi0 prefixlen 64 scopeid 0x7
	inet 0.0.0.0 netmask 0xff000000 broadcast 255.255.255.255
	ether 00:09:2d:2d:c9:50
	media: IEEE 802.11 Wireless Ethernet autoselect (DS/2Mbps)
	status: no carrier
	ssid ""
	stationname "FreeBSD Wireless node"
	channel 10 authmode OPEN powersavemode OFF powersavesleep 100
	wepmode OFF weptxkey 1</screen>

	  <para>Maintenant, nous pouvons configurer la carte suivant
	    les param&egrave;tres de notre r&eacute;seau:</para>

	  <screen>&prompt.root; <userinput>ifconfig wi0 inet <replaceable>192.168.0.20</replaceable> netmask <replaceable>255.255.255.0</replaceable> ssid <replaceable>my_net</replaceable></userinput></screen>

	  <para>Remplacez <hostid role="ipaddr">192.168.0.20</hostid>
	    et <hostid role="netmask">255.255.255.0</hostid> avec une
	    adresse IP ainsi qu'un masque de sous-r&eacute;seau
	    valides de votre r&eacute;seau c&acirc;bl&eacute;.
	    Rappelez-vous, notre point d'acc&egrave;s joue le
	    r&ocirc;le de pont entre le r&eacute;seau sans fil et le
	    r&eacute;seau c&acirc;bl&eacute;, il appara&icirc;tra aux
	    autres cartes sur votre r&eacute;seau que vous &ecirc;tes
	    sur le m&ecirc;me r&eacute;seau c&acirc;bl&eacute;.</para>

	  <para>Une fois cela effectu&eacute;, vous devriez &ecirc;tre
	    en mesure d'utiliser &man.ping.8; pour atteindre les
	    machines sur le r&eacute;seau c&acirc;bl&eacute; de la
	    m&ecirc;me fa&ccedil;on que si vous &eacute;tiez
	    connect&eacute; en utilisant un c&acirc;ble r&eacute;seau
	    standard.</para>

	  <para>Si vous rencontrez des probl&egrave;mes avec votre
	    connexion sans fil, v&eacute;rifiez que vous &ecirc;tes
	    associ&eacute;&mdash;&ldquo;associated&rdquo;
	    (connect&eacute;) avec le point d'acc&egrave;s:</para>

	  <screen>&prompt.root; <userinput>ifconfig wi0</userinput></screen>

	  <para>devrait retourner un certain nombre d'information; et
	    vous devriez voir s'afficher:</para>

	  <screen>status: associated</screen>

	  <para>Si <literal>associated</literal> n'est pas
	    affich&eacute;, alors il se peut que vous soyez hors de
	    port&eacute;e du point d'acc&egrave;s, que vous ayez le
	    chiffrage activ&eacute;, ou peut-&ecirc;tre que vous ayez
	    un probl&egrave;me de configuration.</para>
	</sect4>
      </sect3>

      <sect3>
	<title>Chiffrement</title>
	<indexterm>
	  <primary>r&eacute;seau sans fil</primary>
	  <secondary>chiffrement</secondary>
	</indexterm>

	<para>L'utilisation du chiffrement sur un r&eacute;seau sans
	  fil est important parce que vous n'avez plus la
	  possibilit&eacute; de conserver le r&eacute;seau dans une
	  zone prot&eacute;g&eacute;e.  Vos donn&eacute;es sans fil
	  seront diffus&eacute;es dans tout le voisinnage, et toute
	  personne d&eacute;sirant y acc&eacute;der pourra le faire.
	  C'est ici que le chiffrement entre en jeu.  En chiffrant les
	  donn&eacute;es qui sont envoy&eacute;es par les ondes, vous
	  rendez plus difficile l'interception de celles-ci par
	  quiconque d'int&eacute;ress&eacute;.</para>

	<para>Les deux m&eacute;thodes les plus courantes de chiffrage
	  des donn&eacute;es entre un client et un point
	  d'acc&egrave;s sont le protocol WEP et &man.ipsec.4;.</para>

	<sect4>
	  <title>WEP</title>
	  <indexterm><primary>WEP</primary></indexterm>

	  <para>WEP est l'abbr&eacute;vation de &ldquo;Wired
	    Equivalency Protocol&ldquo;.  Le protocole de chiffrage
	    WEP est une tentive de rendre les r&eacute;seaux sans fils
	    aussi s&ucirc;rs et s&eacute;curis&eacute;s qu'un
	    r&eacute;seau filaire.  Malheureusement, il a
	    &eacute;t&eacute; craqu&eacute;, et est relativement
	    simple &agrave; d&eacute;jouer.  Cela signifie que l'on ne
	    doit pas lui faire confiance quand il est
	    n&eacute;cessaire de chiffrer des donn&eacute;es
	    sensibles.</para>

	  <para>Cela reste mieux que rien du tout, utilisez ce qui
	    suit pour activer WEP sur votre nouveau point
	    d'acc&egrave;s &os;:</para>

	  <screen>&prompt.root; <userinput>ifconfig wi0 inet up ssid <replaceable>my_net</replaceable> wepmode on wepkey <replaceable>0x1234567890</replaceable> media DS/11Mbps mediaopt hostap</userinput></screen>

	  <para>Et vous pouvez activer WEP sur un client avec la
	    commande:</para>

	  <screen>&prompt.root; <userinput>ifconfig wi0 inet <replaceable>192.168.0.20</replaceable> netmask <replaceable>255.255.255.0</replaceable> ssid <replaceable>my_net</replaceable> wepmode on wepkey <replaceable>0x1234567890</replaceable></userinput></screen>

	  <para>Notez que vous devriez remplacer
	    <replaceable>0x1234567890</replaceable> par une cl&eacute;
	    plus personnelle.</para>
	</sect4>

	<sect4>
	  <title>IPsec</title>

	  <para>&man.ipsec.4; est un outil bien plus puissant et
	    robuste pour chiffer des donn&eacute;es sur un
	    r&eacute;seau.  C'est la m&eacute;thode &agrave;
	    pr&eacute;ferer pour chiffrer les donn&eacute;es sur un
	    r&eacute;seau sans fil.  Vous pouvez obtenir plus de
	    d&eacute;tails concernant &man.ipsec.4; et comment
	    l'impl&eacute;menter dans la section <link
	    linkend="ipsec">IPsec</link> de ce manuel.</para>
	</sect4>
      </sect3>

      <sect3>
	<title>Outils</title>

	<para>Il existe un petit nombre d'outils disponibles pour le
	  d&eacute;bogage et la configuration d'un r&eacute;seau sans
	  fil, et nous tenterons ici d'en d&eacute;crire certains
	  ainsi que leurs fonctionnalit&eacute;s.</para>

	<sect4>
	  <title>La suite
	    <application>bsd-airtools</application></title>

	  <para>La suite <application>bsd-airtools</application> est
	    une trousse &agrave; outils compl&egrave;te qui comprend
	    des outils d'audit sans fil pour le craquage du
	    syst&egrave;me WEP, la d&eacute;tection de points
	    d'acc&egrave;s, etc.</para>

	  <para>Les utilitaires
	    <application>bsd-airtools</application> peuvent &ecirc;tre
	    install&eacute;s &agrave; partir du logiciel port&eacute;
	    <filename role="package">net/bsd-airtools</filename>.  Des
	    instructions sur l'installation des logiciels
	    port&eacute;s peuvent &ecirc;tre trouv&eacute;es dans le
	    <xref linkend="ports"> de ce manuel.</para>

	  <para>Le programme <command>dstumbler</command> est l'outil
	    qui permet la recherche de points d'acc&egrave;s et la
	    mesure du rapport signal sur bruit.  Si vous avez des
	    difficult&eacute;s &agrave; mettre en place et &agrave;
	    faire fonctionner votre point d'acc&egrave;s,
	    <command>dstumbler</command> pourra vous aider dans ce
	    sens.</para>

	  <para>Pour tester la s&eacute;curit&eacute; de votre
	    r&eacute;seau sans fil, vous pouvez choisir d'employer les
	    outils &ldquo;dweputils&rdquo;
	    (<command>dwepcrack</command>, <command>dwepdump</command>
	    et <command>dwepkeygen</command>) pour vous aider &agrave;
	    d&eacute;terminer si WEP r&eacute;pond &agrave; vos
	    besoins en mati&egrave;re de s&eacute;curit&eacute; au
	    niveau de votre r&eacute;seau sans fil.</para>
	</sect4>

	<sect4>
	  <title>Les utilitaires <command>wicontrol</command>,
	    <command>ancontrol</command> et
	    <command>raycontrol</command></title>

	  <para>Il existe des outils que vous pouvez utiliser pour
	    contr&ocirc;ler le comportement de votre carte
	    r&eacute;seau sans fil sur le r&eacute;seau sans fil.
	    Dans les exemples pr&eacute;c&eacute;dents, nous avons
	    choisi d'employer &man.wicontrol.8; puisque notre carte
	    sans fil utilise l'interface <devicename>wi0</devicename>.
	    Si vous avez une carte sans fil Cisco, elle
	    appara&icirc;trait comme <devicename>an0</devicename>, et
	    vous utiliseriez alors le programme
	    &man.ancontrol.8;.</para>
	</sect4>

	<sect4>
	  <title>La commande <command>ifconfig</command></title>
	  <indexterm><primary>ifconfig</primary></indexterm>

	  <para>La commande &man.ifconfig.8; propose plusieurs options
	    identiques &agrave; celles de &man.wicontrol.8;, cependant
	    il manque quelques options.  Consultez la page de manuel
	    d'&man.ifconfig.8; pour les diff&eacute;rents
	    param&egrave;tres et options en ligne de commande.</para>
	</sect4>
      </sect3>

      <sect3>
	<title>Cartes support&eacute;es</title>

	<sect4>
	  <title>Points d'acc&egrave;s</title>

	  <para>Les seules cartes actuellement support&eacute;es pour
	    le mode BSS (points d'acc&egrave;s) sont celles
	    bas&eacute;es sur les circuits Prism 2, 2.5, ou 3.  Pour
	    une liste compl&egrave;te, consultez la page de manuel de
	    &man.wi.4;.</para>
	</sect4>

	<sect4>
	  <title>Clients</title>

	  <para>Presque toutes les cartes r&eacute;seaux sans fil
	    802.11b sont support&eacute;es sous &os;.  La plupart des
	    cartes bas&eacute;es sur les circuits Prism, Spectrum24,
	    Hermes, Aironet, et Raylink fonctionneront dans le mode
	    IBSS (ad-hoc, point &agrave; point, et BSS).</para>
	</sect4>
      </sect3>
    </sect2>
  </sect1>


  <sect1 id="network-bluetooth">
    <title>Bluetooth ** Traduction en Cours **</title>
    <para></para>
  </sect1>

  <sect1 id="network-bridging">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Steve</firstname>
	  <surname>Peterson</surname>
	  <contrib>Ecrit par </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>Bridging</title>

    <sect2>
      <title>Introduction</title>
      <indexterm><primary>sous-r&eacute;seau IP</primary></indexterm>
      <indexterm><primary>bridge/pont</primary></indexterm>
      <para>Il est parfois utile de diviser un r&eacute;seau physique
	(comme un r&eacute;seau Ethernet) en deux r&eacute;seaux
	s&eacute;par&eacute;s sans avoir &agrave; cr&eacute;er de
	sous-r&eacute;seaux IPs et &agrave; utiliser un routeur pour
	connecter ces r&eacute;seaux entre eux.  Le
	p&eacute;riph&eacute;rique qui connecte ensemble deux
	r&eacute;seaux de cette mani&egrave;re est appel&eacute;
	&ldquo;bridge&rdquo;&mdash;pont.  Un syst&egrave;me &os; avec
	deux cartes r&eacute;seaux peut faire fonction de pont.</para>

      <para>Le pont apprend les adresses MAC (adresses Ethernet) des
	p&eacute;riph&eacute;riques branch&eacute;s sur chacune de ses
	interfaces r&eacute;seaux.  Il transmet le trafic entre deux
	r&eacute;seaux uniquement quand la source et la destination
	sont sur des r&eacute;seaux diff&eacute;rents.</para>

      <para>Sous de nombreux aspects, un pont ressemble &agrave; un
	switch (commutateur) Ethernet avec tr&egrave;s peu de
	ports.</para>
    </sect2>

    <sect2>
      <title>Situations o&ugrave; l'utilisation d'un pont est
	appropri&eacute;e</title>

      <para>Il existe deux situations dans lesquelles un pont est de
	nos jours utilis&eacute;.</para>

      <sect3>
	<title>Trafic important sur un segment</title>

	<para>La premi&egrave;re situation appara&icirc;t quand un
	  segment physique d'un r&eacute;seau est submerg&eacute; par
	  le trafic, mais vous ne voulez pas, pour diff&eacute;rentes
	  raisons, subdiviser le r&eacute;seau et interconnecter les
	  sous-r&eacute;seaux &agrave; l'aide d'un routeur.</para>

	<para>Prenons comme exemple un journal o&ugrave; les bureaux
	  de la r&eacute;daction et de la production sont sur le
	  m&ecirc;me sous-r&eacute;seau.  Les utilisateurs de la
	  r&eacute;daction utilisent tous le serveur de fichiers
	  <hostid>A</hostid>, et les utilisateurs de la production le
	  serveur <hostid>B</hostid>.  Un r&eacute;seau Ethernet est
	  utilis&eacute; pour connecter ensemble les utilisateurs, et
	  des surcharges du r&eacute;seau ralentissent les
	  &eacute;changes.</para>

	<para>Si les utilisateurs de la r&eacute;daction peuvent
	  &ecirc;tre cantonn&eacute; sur un segment, et les
	  utilisateurs de la production sur un autre, les deux
	  r&eacute;seaux pourront &ecirc;tre connect&eacute;s par un
	  pont.  Seul le trafic r&eacute;seau destin&eacute; aux
	  interfaces r&eacute;seaux situ&eacute;es de
	  l'&ldquo;autre&rdquo; c&ocirc;t&eacute; du pont sera
	  transmis &agrave; l'autre r&eacute;seau, r&eacute;duisant
	  ainsi les congestions sur chaque segment.</para>
      </sect3>

      <sect3>
	<title>Coupe-feu filtrant/r&eacute;gulant le trafic</title>
	<indexterm><primary>coupe-feu</primary></indexterm>
	<indexterm><primary>translation
	  d'adresses</primary></indexterm>

	<para>La deuxi&egrave;me situation est quand un coupe-feu est
	  n&eacute;cessaire mais sans translation d'adresses
	  (NAT).</para>

	<para>Un exemple est une compagnie qui est connect&eacute;e
	  &agrave; son fournisseur d'acc&egrave;s internet par
	  l'interm&eacute;diaire d'une connexion ISDN ou DSL.  Elle
	  dispose de 13 adresses IP routables fournies par le
	  fournisseur d'acc&egrave;s et dispose de 10 PCs sur son
	  r&eacute;seau.  Dans cette situation, utiliser un
	  coupe-feu/routeur est complexe en raison des
	  probl&egrave;mes de sous-r&eacute;seaux.</para>

	<indexterm><primary>routeur</primary></indexterm>
	<indexterm><primary>DSL</primary></indexterm>
	<indexterm><primary>ISDN</primary></indexterm>
	<para>Un coupe-feu bas&eacute; sur un pont peut &ecirc;tre
	  configur&eacute; et positionn&eacute; dans le flux juste en
	  aval de leur routeur DSL/ISDN sans aucun probl&egrave;me
	  d'adressage IP.</para>
      </sect3>
    </sect2>

    <sect2>
      <title>Configuration d'un pont</title>

      <sect3>
	<title>Choix des cartes r&eacute;seaux</title>

	<para>Un pont n&eacute;cessite au moins deux cartes
	  r&eacute;seaux pour fonctionner.  Malheureusement toutes les
	  cartes r&eacute;seaux ne supportent pas le mode bridging.
	  Lisez la page de manuel &man.bridge.4; pour des
	  d&eacute;tails sur les cartes support&eacute;es.</para>

	<para>Installez et testez les deux cartes r&eacute;seaux avant
	  de poursuivre.</para>
      </sect3>

      <sect3>
	<title>Modification de la configuration du noyau</title>
	<indexterm>
	  <primary>options du noyau</primary>
	  <secondary>options BRIDGE</secondary>
	</indexterm>

	<para>Pour activer le support n&eacute;cessaire pour mettre en
	  place un pont ajouter la ligne suivante:</para>

	<programlisting>options BRIDGE</programlisting>

	<para>&agrave; votre fichier de configuration du noyau, et
	  recompilez votre noyau.</para>
      </sect3>

      <sect3>
	<title>Support du coupe-feu</title>

	<indexterm><primary>coupe-feu</primary></indexterm>
	<para>Si vous projetez d'utiliser un pont en tant que
	  coupe-feu, vous devrez &eacute;galement ajouter l'option
	  <literal>IPFIREWALL</literal>.  Lisez la <xref
	  linkend="firewalls"> pour des informations
	  g&eacute;n&eacute;rales sur la configuration d'un pont en tant
	  que coupe-feu.</para>

	<para>Si vous avez besoin de permettre le passage &agrave;
	  travers le pont des paquets non-IP (comme ARP), il existe
	  une option du coupe-feu qui doit &ecirc;tre activ&eacute;e.
	  Cette option est
	  <literal>IPFIREWALL_DEFAULT_TO_ACCEPT</literal>.  Prennez
	  note que cela modifie le fonctionnement par d&eacute;faut du
	  coupe-feu, ce dernier acceptera alors tous les paquets.
	  Assurez-vous de savoir ce que ce changement signifie pour
	  votre ensemble de r&egrave;gles de filtrage avant de
	  l'effectuer.</para>
      </sect3>

      <sect3>
	<title>Support de la r&eacute;gulation du trafic</title>

	<para>Si vous d&eacute;sirez utiliser le pont comme
	  r&eacute;gulateur de trafic, vous devrez ajouter l'option
	  <literal>DUMMYNET</literal> &agrave; votre fichier de
	  configuration du noyau.  Consultez la page de manuel
	  &man.dummynet.4; pour plus d'information.</para>
      </sect3>
    </sect2>

    <sect2>
      <title>Activer le pont</title>

      <para>Ajoutez la ligne:</para>

      <programlisting>net.link.ether.bridge=1</programlisting>

      <para>au fichier <filename>/etc/sysctl.conf</filename> pour
	activer le pont au d&eacute;marrage, et la ligne:</para>

      <programlisting>net.link.ether.bridge_cfg=<replaceable>if1</replaceable>,<replaceable>if2</replaceable></programlisting>

      <para>pour activer le mode bridging sur les interfaces
	sp&eacute;cifi&eacute;es (remplacez
	<replaceable>if1</replaceable> et
	<replaceable>if2</replaceable> par les noms de vos interfaces
	r&eacute;seaux).  Si vous d&eacute;sirez que les paquets
	traversant le pont soient filtr&eacute;s par &man.ipfw.8;,
	vous devrez ajouter &eacute;galement la ligne:</para>

      <programlisting>net.link.ether.bridge_ipfw=1</programlisting>

      <para>Pour &os;&nbsp;5.2-RELEASE et versions suivantes, utilisez
	les lignes suivantes:</para>

      <programlisting>net.link.ether.bridge.enable=1
net.link.ether.bridge.config=<replaceable>if1</replaceable>,<replaceable>if2</replaceable>
net.link.ether.bridge.ipfw=1</programlisting>
    </sect2>

    <sect2>
      <title>Informations suppl&eacute;mentaires</title>

      <para>Si vous d&eacute;sirez &ecirc;tre en mesure de vous
	connecter au pont par l'interm&eacute;diaire de
	&man.telnet.1;, il est correct d'ajouter &agrave; l'une des
	cartes r&eacute;seaux une adresse IP.  Il existe un consensus
	sur le fait qu'assigner une adresse aux deux cartes est une
	mauvaise id&eacute;e.</para>

      <para>Si vous avez plusieurs ponts sur votre r&eacute;seau, il
	ne peut y en avoir plus d'un sur le chemin qui sera
	emprunt&eacute; par le trafic entre deux stations de travail.
	Techniquement, cela signifie qu'il n'y a pas de support pour
	la gestion du &ldquo;spanning tree&rdquo;.</para>

      <para>Un pont peut ajouter des temps de latence lors de
	l'utilisation de &man.ping.8;, et tout particuli&egrave;rement
	dans le cas du trafic d'un segment vers un autre.</para>
    </sect2>
  </sect1>

  <sect1 id="network-nfs">
    <title>NFS ** Traduction en Cours **</title>
    <para></para>
  </sect1>

  <sect1 id="network-diskless">
    <title>Diskless Operation ** Traduction en Cours **</title>
    <para></para>
  </sect1>

  <sect1 id="network-isdn">
    <title>ISDN</title>

    <indexterm>
      <primary>ISDN&mdash;(RNIS)</primary>
    </indexterm>

    <para>Une bonne source d'information sur la technologie et le
      mat&eacute;riel ISDN (RNIS) est <ulink
      url="http://www.alumni.caltech.edu/~dank/isdn/">la page ISDN de
      Dan Kegel</ulink>.</para>

    <para>Voici un rapide aper&ccedil;u &agrave; propos de
      l'ISDN:</para>

    <itemizedlist>
      <listitem>
	<para>Si vous r&eacute;sidez en Europe, vous devriez
	  &eacute;tudier la section sur les cartes ISDN.</para>
      </listitem>

      <listitem>
	<para>Si vous envisagez d'utiliser l'ISDN avant tout pour vous
	  connecter &agrave; l'Internet par l'interm&eacute;diaire d'un
	  fournisseur d'acc&egrave;s Internet et d'une ligne
	  t&eacute;l&eacute;phoniaue non d&eacute;di&eacute;e, vous
	  devriez vous int&eacute;resser aux Adaptateurs Terminaux.
	  C'est la solution la plus souple, qui vous posera le moins de
	  probl&egrave;mes si vous changez de fournisseur
	  d'acc&egrave;s.</para>
      </listitem>

      <listitem>
	<para>Si vous interconnectez deux r&eacute;seaux locaux, ou si
	  vous vous connectez &agrave; l'Internet avec une liaison ISDN
	  d&eacute;die&eacute;, vous devriez envisager un pont/routeur
	  autonome.</para>
      </listitem>
    </itemizedlist>

    <para>Le co&ucirc;t est un facteur d&eacute;terminant de la
      solution que vous choisirez.  Les options suivantes sont
      list&eacute;es de la moins ch&egrave;re &agrave; la plus
      ch&egrave;re.</para>

    <sect2 id="network-isdn-cards">
      <sect2info>
	<authorgroup>
	  <author>
	    <firstname>Hellmuth</firstname>
	    <surname>Michaelis</surname>
	    <contrib>Contribution de </contrib>
	  </author>
	</authorgroup>
      </sect2info>
      <title>Cartes ISDN</title>

      <indexterm>
	<primary>ISDN</primary>
	<secondary>cartes</secondary>
      </indexterm>

      <para>L'impl&eacute;mentation ISDN de &os; ne supporte que la
	norme DSS1/Q.931 (ou Euro-ISDN) utilisant des cartes passives.
	Depuis &os;&nbsp;4.4, quelques cartes actives sont
	support&eacute;es o&ugrave; le firmware supporte
	&eacute;galement d'autres protocoles au niveau des signaux,
	cela inclut les premi&egrave;res cartes support&eacute;es du
	type &ldquo;Primary Rate ISDN&rdquo; (PRI).</para>

      <para>Le logiciel <application>isdn4bsd</application> vous
	permet de vous connecter &agrave; d'autres routeurs ISDN soit
	en utilisant l'IP sur de l'HDLC de base, soit en utilisant PPP
	synchrone: en employant PPP int&eacute;gr&eacute; au noyau
	avec <literal>isppp</literal>, une version modifi&eacute;e du
	pilote de p&eacute;riph&eacute;rique &man.sppp.4;, ou en
	employant &man.ppp.8; en mode utilisateur.  L'utilisation de
	&man.ppp.8; en mode utilisateur rend possible
	l'agr&eacute;gation de deux ou plus canaux ISDN de type B.
	Une application capable de r&eacute;pondre aux appels
	t&eacute;l&eacute;phoniques est &eacute;galement disponible,
	tout comme de nombreux utilitaires comme un modem logiciel 300
	bauds.</para>

      <para>Un nombre croissant de cartes ISDN pour PC sont
	support&eacute;es sous &os; et les retours montrent qu'elles
	sont utilis&eacute;es avec succ&egrave;s dans toute l'Europe
	et dans de nombreuses autres parties du monde.</para>

      <para>Les cartes ISDN passives support&eacute;es sont
	principalement celles avec le circuit ISDN ISAC/HSCX/IPAC
	d'Infineon (pr&eacute;c&eacute;demment Siemens), mais
	&eacute;galement les cartes avec des circuits en provenance de
	Cologne Chip (cartes ISA uniquement), les cartes PCI avec les
	circuits Winbond W6692, quelques cartes avec les circuits
	Tiger300/320/ISAC et quelques cartes avec des circuits
	sp&eacute;cifiques comme l'AVM Fritz!Card PCI V.1.0 de l'AVM
	Fritz!Card PnP.</para>

      <para>Actuellement les cartes ISDN actives support&eacute;es
	sont les cartes AVM B1 (ISA et PCI) BRI et les cartes PCI AVM
	T1 PRI.</para>

      <para>Pour de la documentation sur
	<application>isdn4bsd</application>, consultez le
	r&eacute;pertoire <filename
	role="directory">/usr/share/examples/isdn/</filename> sur
	votre syst&egrave;me &os; ou sur la <ulink
	url="http://www.freebsd-support.de/i4b/">page web
	d'isdn4bsd</ulink> qui propose &eacute;galement des astuces,
	des erratas et bien plus de documentation que le <ulink
	url="http://people.FreeBSD.org/~hm/">manuel
	d'isdn4bsd</ulink>.</para>

      <para>Au cas o&ugrave; vous seriez int&eacute;ress&eacute; par
	l'ajout du support pour un protocole ISDN diff&eacute;rent,
	d'une carte ISDN pour PC non encore support&eacute;e ou par
	l'am&eacute;lioration d'<application>isdn4bsd</application>,
	veuillez contacter &a.hm;.</para>

      <para>Pour les questions concernant l'installation, la
	configuration et le d&eacute;pannage
	d'<application>isdn4bsd</application>, une liste de diffusion
	&a.isdn.name; est disponible.</para>
    </sect2>

    <sect2>
      <title>Adaptateurs terminaux ISDN</title>

      <para>Les adaptateurs terminaux&mdash;&ldquo;Terminal adapters
	(TA)&rdquo;; sont l'&eacute;quivalent ISDN des modems pour les
	lignes t&eacute;l&eacute;phoniques ordinaires.</para>

      <indexterm><primary>modem</primary></indexterm>

      <para>La plupart des TA utilisent le jeu de commandes standard
	des modems Hayes, et peuvent &ecirc;tre utilis&eacute;s en
	remplacement d'un modem.</para>

      <para>Un TA fonctionne essentiellement de la m&ecirc;me
	mani&egrave;re qu'un modem &agrave; la diff&eacute;rence que
	la vitesse de la connexion sera plus &eacute;lev&eacute;e
	qu'avec votre vieux modem.  Vous devrez configurer <link
	linkend="ppp">PPP</link> de fa&ccedil;on exactement identique
	que pour un modem classique.  Assurez-vous de fixer la vitesse
	de votre port s&eacute;rie la plus haute possible.</para>

      <indexterm><primary>PPP</primary></indexterm>

      <para>Le principal avantage d'utiliser un TA pour vous connecter
	&agrave; votre fournisseur d'acc&egrave;s Internet est de
	pouvoir utiliser PPP en mode dynamic.  Comme l'espace
	d'adressage IP disponible devient de plus en plus restreint,
	la plupart des fournisseurs d'acc&egrave;s ne d&eacute;sirent
	plus vous fournir d'adresse IP statique.  La plupart des
	routeurs autonomes ne peuvent pas fonctionner avec une
	allocation dynamique d'adresse IP.</para>

      <para>Les fonctionnalit&eacute;s et la stabilit&eacute; de la
	connexion des adaptateurs terminaux reposent
	compl&egrave;tement sur le &ldquo;daemon&rdquo; PPP.  Cela
	vous permet de passer facilement d'un modem classique &agrave;
	l'ISDN sur une machine &os;, si vous avez d&eacute;j&agrave;
	configur&eacute; PPP.  Cependant, les probl&egrave;mes que
	vous avez &eacute;ventuellement rencontr&eacute;s avec PPP
	persisteront.</para>

      <para>Si vous d&eacute;sirez un maximum de stabilit&eacute;,
	utilisez <link linkend="ppp">PPP int&eacute;gr&eacute; au
	noyau</link>, &agrave; la place du <link linkend="userppp">PPP
	en mode utilisateur</link>.</para>

      <para>Les adaptateurs suivants sont connus pour fonctionner avec
	&os;:</para>

      <itemizedlist>
	<listitem>
	  <para>Motorola BitSurfer et Bitsurfer Pro</para>
	</listitem>

	<listitem>
	  <para>Adtran</para>
	</listitem>
      </itemizedlist>

      <para>La plupart des adaptateurs terminaux fonctionneront
	probablement &eacute;galement, les fabricants de TA font en
	sorte que leurs produits acceptent la plupart du jeu de
	commandes AT des modems.</para>

      <para>Le vrai probl&egrave;me avec les adaptateurs terminaux est
	que comme pour les modems, il vous faudra une bonne interface
	s&eacute;rie dans votre ordinateur.</para>

      <para>Vous devriez lire le document sur <ulink
	url="../../articles/serial-uart/index.html">les ports
	s&eacute;rie sous &os;</ulink> pour comprendre en
	d&eacute;tail le fonctionnement des
	p&eacute;riph&eacute;riques s&eacute;rie et les
	diff&eacute;rences entre les ports s&eacute;ries asynchrones
	et synchrones.</para>

      <para>Un adaptateur terminal sur un port s&eacute;rie PC
	standard (asynchrone) vous limite &agrave; 115.2&nbsp;Kbs,
	m&ecirc;me si vous disposez d'une connexion &agrave;
	128&nbsp;Kbs.  Pour utiliser compl&egrave;tement les
	128&nbsp;Kbs offert par l'ISDN, vous devez brancher
	l'adaptateur sur une carte s&eacute;rie synchrone.</para>

      <para>Ne vous imaginez pas qu'il suffit d'acheter un adaptateur
	terminal interne pour s'affranchir du probl&egrave;me
	synchrone/asynchrone.  Les adaptateurs internes disposent
	simplement d'un port s&eacute;rie PC standard.  Tout ce que
	vous y gagnerez sera d'&eacute;conomiser un c&acirc;ble
	s&eacute;rie et de lib&eacute;rer une prise
	&eacute;lectrique.</para>

      <para>Une carte synchrone avec un adaptateur terminal est au
	moins aussi rapide qu'un routeur autonome, pilot&eacute; par
	une simple machine &os;, et probablement plus souple.</para>

      <para>Le choix entre carte synchrone/adaptateur ou routeur
	autonome est une question de go&ucirc;t.  Ce sujet a
	&eacute;t&eacute; aborb&eacute; dans les listes de diffusion.
	Nous vous suggerons de chercher dans les <ulink
	url="../../../../search/index.html">archives</ulink> pour
	obtenir l'int&eacute;gralit&eacute; de la discussion.</para>
    </sect2>

    <sect2>
      <title>Ponts/Routeurs ISDN autonomes</title>
      <indexterm>
	<primary>ISDN</primary>
	<secondary>ponts/routeurs autonomes</secondary>
      </indexterm>

      <para>Les ponts ou routeurs ISDN ne sont pas sp&eacute;cifiques
	&agrave; &os; ou &agrave; tout autre syst&egrave;me
	d'exploitation.  Pour une description compl&egrave;te de la
	technologie du routage et des ponts, veuillez vous reportez
	&agrave; un ouvrage de r&eacute;f&eacute;rence sur les
	r&eacute;seaux.</para>

      <para>Dans le contexte de cette section, les termes de routeur
	et de pont seront utilis&eacute;s
	indiff&eacute;remment.</para>

      <para>Comme le prix des routeurs/ponts ISDN d'entr&eacute;e de
	gamme baissent, il est probable qu'ils deviennent un choix de
	plus en plus populaire.  Un routeur ISDN est une petite
	bo&icirc;te qui se branche directement sur votre r&eacute;seau
	Ethernet, et g&egrave;re sa propre connexion aux autres
	ponts/routeurs.  Il int&egrave;gre le logiciel
	n&eacute;cessaire au support du protocole PPP et d'autres
	protocoles.</para>

      <para>Un routeur vous offrira un d&eacute;bit plus
	&eacute;lev&eacute; qu'un adaptateur terminal standard,
	puisqu'il utilisera une connexion ISDN synchrone.</para>

      <para>Le principal probl&egrave;me avec les routeurs et ponts
	ISDN est que l'int&eacute;rop&eacute;rabilit&eacute; entre les
	mat&eacute;riels des diff&eacute;rents contructeurs n'est pas
	toujours garantie.  Si vous projetez de vous connecter
	&agrave; un fournisseur d'acc&egrave;s Internet, vous devriez
	discuter de vos besoins avec ce dernier.</para>

      <para>Si vous envisagez de connecter ensemble deux
	r&eacute;seaux locaux, comme le r&eacute;seau de votre
	domicile et celui de votre bureau, c'est la solution la plus
	simple et celle qui demande le moins de maintenance.  Etant
	donn&eacute; que vous &ecirc;tes la personne qui ach&egrave;te
	les &eacute;quipements pour les deux extr&eacute;mit&eacute;s,
	vous &ecirc;tes s&ucirc;r que cela fonctionnera.</para>

      <para>Par exemple pour connecter un ordinateur personnel
	situ&eacute; &agrave; son domicile ou le r&eacute;seau d'une
	agence &agrave; celui du si&egrave;ge social, la configuration
	suivante pourra &ecirc;tre utilis&eacute;e:</para>

      <example>
	<title>R&eacute;seau d'agence ou &agrave; domicile</title>

	<indexterm><primary>10 base 2</primary></indexterm>
	<para>Le r&eacute;seau utilise une topologie en bus avec une
	  connectique Ethernet 10 base 2 (&ldquo;thinnet&rdquo;).
	  Connectez le routeur au r&eacute;seau &agrave; l'aide d'un
	  &eacute;metteur/r&eacute;cepteur AUI/10BT si
	  n&eacute;cessaire.</para>

        <mediaobject>
	  <imageobject>
	    <imagedata fileref="advanced-networking/isdn-bus">
	  </imageobject>

	  <textobject>
	    <literallayout class="monospaced">---Station de travail Sun
|
---Machine FreeBSD
|
---Windows 95
|
Routeur autonome
   |
Liaison ISDN BRI</literallayout>
	  </textobject>

	  <textobject>
	    <phrase>Ethernet 10 Base 2</phrase>
	  </textobject>
	</mediaobject>

	<para>Si votre r&eacute;seau de domicile/d'agence n'est
	  constitu&eacute; que d'un seul ordinateur, vous pouvez
	  utiliser une paire torsad&eacute;e crois&eacute;e pour le
	  connecter directement au routeur autonome.</para>
      </example>

      <example>
	<title>Si&egrave;ge social ou autre r&eacute;seau</title>

	<indexterm><primary>10 base T</primary></indexterm>
	<para>Le r&eacute;seau utilise une topologie en &eacute;toile
	  avec une connectique Ethernet 10 base T (&ldquo;paire
	  torsad&eacute;e&rdquo;).</para>

	<mediaobject>
	  <imageobject>
	    <imagedata fileref="advanced-networking/isdn-twisted-pair">
	  </imageobject>

	  <textobject>
	    <literallayout class="monospaced">    -------Serveur Novell
    | H |
    |   ---Sun
    |   |
    | U ---FreeBSD
    |   |
    |   ---Windows 95
    | B |
    |___---Routeur autonome
                |
        Liaison ISDN BRI</literallayout>
	  </textobject>

	  <textobject>
	    <phrase>Architecture du R&eacute;seau ISDN</phrase>
	  </textobject>
	</mediaobject>
      </example>

      <para>Un des principaux avantages de la plupart des
	routeurs/ponts est le fait qu'ils permettent d'avoir deux
	connexions PPP <emphasis>s&eacute;par&eacute;es et
	ind&eacute;pendantes</emphasis> vers deux sites
	diff&eacute;rents et cela en <emphasis>m&ecirc;me</emphasis>
	temps.  Ceci n'est pas support&eacute; par la plupart des
	adaptateurs terminaux, en dehors de mod&egrave;les
	sp&eacute;cifiques (en g&eacute;n&eacute;ral co&ucirc;teux)
	qui disposent de deux ports s&eacute;rie.  Ne confondez pas
	cette possibilit&eacute; avec l'agr&eacute;gation de canaux,
	MPP, etc.</para>

      <para>Ceci peut &ecirc;tre une fonctionnalit&eacute; tr&egrave;s
	utile si, par exemple, vous disposez d'une connexion ISDN
	d&eacute;di&eacute;e au bureau et vous voudriez en profiter
	mais vous ne voulez pas acqu&eacute;rir une nouvelle ligne
	ISDN.  Un routeur au bureau peut g&eacute;rer un canal B
	d&eacute;di&eacute; (64&nbsp;Kbps) vers l'Internet et utiliser
	l'autre canal B pour une autre connexion.  Le deuxi&egrave;me
	canal B peut &ecirc;tre utilis&eacute; pour les connexions
	entrantes, sortantes ou pour l'agr&eacute;gation de canaux
	(MPP, etc.) avec le premier canal B pour augmenter la bande
	passante.</para>

      <indexterm><primary>IPX/SPX</primary></indexterm>
      <para>Un pont Ethernet vous permettra de transmettre autre chose
	que juste du trafic IP.  Vous pouvez &eacute;galement faire
	passer de l'IPX/SPX ou tout autre protocole que vous
	utilisez.</para>
    </sect2>
  </sect1>

  <sect1 id="network-nis">
    <title>NIS/YP ** Traduction en Cours **</title>
    <para></para>
  </sect1>

  <sect1 id="network-dhcp">
    <title>DHCP ** Traduction en Cours **</title>
    <para></para>
  </sect1>

  <sect1 id="network-dns">
    <title>DNS ** Traduction en Cours **</title>
    <para></para>
  </sect1>

  <sect1 id="network-ntp">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Tom</firstname>
	  <surname>Hukins</surname>
	  <contrib>Contribution de </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>NTP</title>

    <indexterm><primary>NTP</primary></indexterm>

    <sect2>
      <title>G&eacute;n&eacute;ralit&eacute;s</title>

      <para>Avec le temps, l'horloge d'un ordinateur tend &agrave;
	d&eacute;river.  Comme le temps passe, l'horloge de
	l'ordinateur devient moins pr&eacute;cise.  Le protocole NTP
	(&ldquo;Network Time Protocol&rdquo;) est une des
	mani&egrave;res pour s'assurer que votre horloge est
	correcte.</para>

      <para>De nombreux services Internet ont besoin, ou tirent
	partie, de la pr&eacute;cision des horloges des ordinateurs.
	Par exemple, un serveur Web, peut recevoir des requ&ecirc;tes
	pour n'envoyer un fichier que s'il a &eacute;t&eacute;
	modifi&eacute; depuis un certain temps.  Des services comme
	&man.cron.8; ex&eacute;cutent des commandes &agrave; des
	moments pr&eacute;cis.  Si l'horloge n'est pas pr&eacute;cise,
	ces commandes peuvent de pas fonctionner au moment
	d&eacute;sir&eacute;.</para>

      <indexterm>
	<primary>NTP</primary>
	<secondary>ntpd</secondary>
      </indexterm>
      <para>&os; est fourni avec le serveur NTP &man.ntpd.8; qui peut
	&ecirc;tre utilis&eacute; pour contacter d'autres serveurs NTP
	pour r&eacute;gler l'horloge de votre machine ou pour jouer le
	r&ocirc;le de serveur de temps pour d'autres.</para>
    </sect2>

    <sect2>
      <title>Choisir les serveurs NTP appropri&eacute;s</title>

      <indexterm>
	<primary>NTP</primary>
	<secondary>choisir les serveurs</secondary>
      </indexterm>

      <para>Afin de synchroniser votre horloge, vous devrez trouver un
	ou plusieurs serveurs NTP.  Votre administrateur r&eacute;seau
	ou votre FAI peuvent avoir mis en place un serveur NTP dans
	cet objectif&mdash;consultez leur documentation pour voir si
	c'est le cas.  Il existe une <ulink
	url="http://www.eecis.udel.edu/~mills/ntp/servers.html">liste
	de serveurs NTP accessibles par le publique</ulink> que vous
	pouvez utiliser pour trouver un serveur NTP proche de vous.
	Assurez-vous d'avoir pris connaissance de la politique
	d'utilisation des serveurs que vous choisissez, et demandez la
	permission si n&eacute;cessaire.</para>

      <para>Choisir plusieurs serveurs NTP non-connect&eacute;s entre
	eux est une bonne id&eacute;e au cas o&ugrave; un des serveurs
	que vous utilisez devient inaccessible ou que son horloge
	n'est plus fiable.  &man.ntpd.8; utilise intelligemment les
	r&eacute;ponses qu'il re&ccedil;oit d'autres serveurs&mdash;il
	favorisera les plus fiables par rapport aux moins
	fiables.</para>
    </sect2>

    <sect2>
      <title>Configuration de votre machine</title>

      <indexterm>
	<primary>NTP</primary>
	<secondary>configuration</secondary>
      </indexterm>

      <sect3>
	<title>Configuration de base</title>
	<indexterm><primary>ntpdate</primary></indexterm>

	<para>Si vous d&eacute;sirez synchroniser votre horloge
	  uniquement lors du d&eacute;marrage de la machine, vous
	  pouvez alors employer &man.ntpdate.8;.  Cela peut &ecirc;tre
	  appropri&eacute; pour certaines machines de bureau qui sont
	  fr&eacute;quemment r&eacute;d&eacute;marr&eacute;es et qui
	  ne n&eacute;cessites qu'une synchronisation
	  &eacute;pisodique, cependant la plupart des machines
	  devraient utiliser &man.ntpd.8;.</para>

	<para>Utiliser &man.ntpdate.8; au moment du d&eacute;marrage
	  est &eacute;galement une bonne id&eacute;e pour les machines
	  qui ex&eacute;cutent &man.ntpd.8;.  Le programme
	  &man.ntpd.8; modifie l'horloge graduellement, alors que
	  &man.ntpdate.8; change directement l'horloge, peu importe la
	  diff&eacute;rence entre l'heure actuelle de la machine et
	  l'heure correcte.</para>

	<para>Pour activer &man.ntpdate.8; au d&eacute;marrage,
	  ajoutez la ligne <literal>ntpdate_enable="YES"</literal> au
	  fichier <filename>/etc/rc.conf</filename>.  Vous devrez
	  &eacute;galement pr&eacute;ciser tous les serveurs avec
	  lesquels vous d&eacute;sirez vous synchroniser et tous les
	  indicateurs devant &ecirc;tre pass&eacute;s &agrave;
	  &man.ntpdate.8; avec
	  <literal>ntpdate_flags</literal>.</para>
      </sect3>

      <sect3>
	<indexterm>
	  <primary>NTP</primary>
	  <secondary>ntp.conf</secondary>
	</indexterm>

	<title>Configuration g&eacute;n&eacute;rale</title>

	<para>NTP est configur&eacute; par l'interm&eacute;diaire du
	  fichier <filename>/etc/ntp.conf</filename> suivant le format
	  d&eacute;crit dans la page de manuel &man.ntp.conf.5;.
	  Voici un exemple simple:</para>

	<programlisting>server ntplocal.example.com prefer
server timeserver.example.org
server ntp2a.example.net

driftfile /var/db/ntp.drift</programlisting>

	<para>L'option <literal>server</literal> pr&eacute;cise quels
	  serveurs doivent &ecirc;tre utilis&eacute;s, avec un serveur
	  list&eacute; par ligne.  Si un serveur est
	  sp&eacute;cifi&eacute; avec l'argument
	  <literal>prefer</literal>, comme c'est le cas pour <hostid
	  role="fqdn">ntplocal.example.com</hostid>, ce serveur est
	  pr&eacute;f&eacute;r&eacute; par rapport aux autres
	  serveurs.  Une r&eacute;ponse en provenance d'un serveur
	  <emphasis>pr&eacute;f&eacute;r&eacute;</emphasis> sera
	  ignor&eacute;e si elle diff&egrave;re de fa&ccedil;on
	  significative des r&eacute;ponses des autres serveurs, sinon
	  elle sera utilis&eacute;e sans consid&eacute;rer les autres
	  r&eacute;ponses.  L'argument <literal>prefer</literal> est
	  normalement employ&eacute; pour les serveurs NTP qui sont
	  connus pour leur grande pr&eacute;cision, comme ceux avec
	  des syst&egrave;mes sp&eacute;ciaux de contr&ocirc;le du
	  mat&eacute;riel.</para>

	<para>L'option <literal>driftfile</literal> pr&eacute;cise
	  quel fichier est utilis&eacute; pour stocker le
	  d&eacute;calage de fr&eacute;quence de l'horloge.  Le
	  programmme &man.ntpd.8; l'utilise pour compenser
	  automatiquement la d&eacute;rive naturelle de l'horloge,
	  permettant de maintenir un r&eacute;glage raisonnablement
	  correct m&ecirc;me s'il est coup&eacute; d'autres sources
	  ext&eacute;rieures de temps pendant une certaine
	  p&eacute;riode.</para>

	<para>L'option <literal>driftfile</literal> pr&eacute;cise
	  &eacute;galement quel fichier est utilis&eacute; pour
	  stocker l'information concernant les r&eacute;ponses
	  pr&eacute;c&eacute;dentes des serveurs NTP que vous
	  utilisez.  Il ne devrait pas &ecirc;tre modifi&eacute; par
	  un autre processus.</para>
      </sect3>

      <sect3>
	<title>Contr&ocirc;ler l'acc&egrave;s &agrave; votre
	  serveur</title>

	<para>Par d&eacute;faut, votre serveur NTP sera accessible par
	  toutes les machines sur l'Internet.  L'option
	  <literal>restrict</literal> du fichier
	  <filename>/etc/ntp.conf</filename> vous permet de
	  contr&ocirc;ler quelles machines peuvent acc&eacute;der
	  &agrave; votre serveur.</para>

	<para>Si vous voulez refuser &agrave; tout le monde
	  l'acc&egrave;s &agrave; votre serveur NTP, ajoutez la ligne
	  suivante au fichier
	  <filename>/etc/ntp.conf</filename>:</para>

        <programlisting>restrict default ignore</programlisting>

	<para>Si vous d&eacute;sirez autoriser uniquement
	  l'acc&egrave;s aux machines de votre r&eacute;seau pour
	  qu'elles puissent synchroniser leur horloge, tout en vous
	  assurant qu'elles ne peuvent configurer le serveur ou
	  &ecirc;tre utilis&eacute;es comme point de de
	  synchronisation, ajoutez:</para>

        <programlisting>restrict 192.168.1.0 mask 255.255.255.0 notrust nomodify notrap</programlisting>

	<para>&agrave; la place, o&ugrave; <hostid
	  role="ipaddr">192.168.1.0</hostid> est une adresse IP de
	  votre r&eacute;seau et <hostid
	  role="netmask">255.255.255.0</hostid> est votre masque de
	  sous-r&eacute;seau.</para>

	<para>Le fichier <filename>/etc/ntp.conf</filename> peut
	  contenir plusieurs options <literal>restrict</literal>.
	  Pour plus de d&eacute;tails, lisez la section
	  <literal>Access Control Support</literal> de la page de
	  manuel &man.ntp.conf.5;.</para>
      </sect3>
    </sect2>

    <sect2>
      <title>Ex&eacute;cuter le serveur NTP</title>

      <para>Pour s'assurer que le serveur NTP est lanc&eacute; au
	d&eacute;marrage, ajoutez la ligne
	<literal>xntpd_enable="YES"</literal> dans le fichier
	<filename>/etc/rc.conf</filename>.  Si vous d&eacute;sirez
	passer des indicateurs suppl&eacute;mentaires &agrave;
	&man.ntpd.8;, &eacute;ditez les param&egrave;tres de l'option
	<varname>xntpd_flags</varname> dans
	<filename>/etc/rc.conf</filename>.</para>

      <para>Pour lancer le serveur sans red&eacute;marrer votre
	machine, ex&eacute;cutez <command>ntpd</command> en
	&eacute;tant s&ucirc;r de pr&eacute;ciser tout
	param&egrave;tre suppl&eacute;mentaire de
	<varname>xntpd_flags</varname> dans
	<filename>/etc/rc.conf</filename>.  Par exemple:</para>

      <screen>&prompt.root; <userinput>ntpd -p /var/run/ntpd.pid</userinput></screen>

      <note>
	<para>Sous &os;&nbsp;5.X, diverses options du fichier
	  <filename>/etc/rc.conf</filename> ont &eacute;t&eacute;
	  renomm&eacute;es.  Ainsi, vous devez remplacer chaque
	  <literal>xntpd</literal> par <literal>ntpd</literal> dans les
	  options ci-dessus.</para></note>
    </sect2>

    <sect2>
      <title>Utiliser ntpd avec une connexion Internet
	temporaire</title>

      <para>Le programme &man.ntpd.8; n'a pas besoin d'une connexion
	permanente &agrave; l'Internet pour fonctionner correctement.
	Cependant, si vous disposez d'une connextion temporaire qui
	est configur&eacute;e de telle sorte qu'il y ait
	&eacute;tablissement de la connexion &agrave; la demande,
	c'est une bonne id&eacute;e d'emp&ecirc;cher le trafic NTP de
	d&eacute;clencher la num&eacute;rotation ou de maintenir
	constamment &eacute;tablie la connexion.  Si vous utilisez PPP
	en mode utilisateur, vous pouvez employer les directives
	<literal>filter</literal> dans le fichier
	<filename>/etc/ppp/ppp.conf</filename>.  Par exemple:</para>

      <programlisting> set filter dial 0 deny udp src eq 123
 # Emp&ecirc;che le trafic NTP de lancer une connexion
 set filter dial 1 permit 0 0
 set filter alive 0 deny udp src eq 123
 # Emp&ecirc;che le trafic NTP entrant de garder la connexion &eacute;tablie
 set filter alive 1 deny udp dst eq 123
 # Emp&ecirc;che le trafic NTP sortant de garder la connexion &eacute;tablie
 set filter alive 2 permit 0/0 0/0</programlisting>

      <para>Pour plus de d&eacute;tails lisez la section
	<literal>PACKET FILTERING</literal> de la page de manuel
	&man.ppp.8; et les exemples du r&eacute;pertoire <filename
	role="directory">/usr/share/examples/ppp/</filename>.</para>

      <note>
	<para>Certains fournisseurs d'acc&egrave;s Internet bloquent
	  les ports dont le num&eacute;ro est faible, emp&ecirc;chant
	  NTP de fonctionner puisque les r&eacute;ponses n'atteingnent
	  jamais votre machine.</para>
      </note>
    </sect2>

    <sect2>
      <title>Information suppl&eacute;mentaire</title>

      <para>La documentation pour le serveur NTP peut &ecirc;tre
	trouv&eacute; dans le r&eacute;pertoire <filename
	role="directory">/usr/share/doc/ntp/</filename> sous le format
	HTML.</para>
    </sect2>
  </sect1>

  <sect1 id="network-natd">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Chern</firstname>
	  <surname>Lee</surname>
	  <contrib>Contribution de </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>Translation d'adresses</title>

    <sect2 id="network-natoverview">
      <title>G&eacute;n&eacute;ralit&eacute;s</title>
      <indexterm>
	<primary><application>natd</application></primary>
      </indexterm>
      <para>Le &ldquo;daemon&rdquo; de translation d'adresses
	(&ldquo;Network Address Translation&rdquo;&mdash;NAT) de &os;,
	g&eacute;n&eacute;ralement connu sous le nom de &man.natd.8; est
	un &ldquo;daemon&rdquo; qui accepte les paquets IP entrants,
	change l'adresse de la source par celle de la machine locale et
	r&eacute;-injecte les paquets dans le flux sortant des paquets
	IP.  Le programme &man.natd.8; effectue cela en changeant
	l'adresse IP et le port source de sorte quand les donn&eacute;es
	r&eacute;ponse arrivent il soit en mesure de d&eacute;terminer
	la provenance des donn&eacute;es d'origine et les
	transf&eacute;rer &agrave; l'&eacute;metteur original.</para>

      <indexterm><primary>Partage de connexion Internet</primary></indexterm>
      <indexterm><primary>IP masquerading</primary></indexterm>

      <para>L'utilisation classique de NAT est le partage de connexion
	Internet.</para>
    </sect2>

    <sect2 id="network-natsetup">
      <title>Architecture du r&eacute;seau</title>

      <para>En raison de la diminution du nombre d'adresses IP libres
	sous IPv4, et de l'augmentation du nombre d'utilisateurs de
	lignes haut-d&eacute;bit comme le c&acirc;ble ou l'ADSL, le
	besoin d'utiliser une solution de partage de connexion est
	donc en constante augmentation.  La possibilit&eacute; de
	connecter plusieurs ordinateurs par l'interm&eacute;diaire
	d'une connexion et d'une adresse IP fait de &man.natd.8; une
	solution de choix.</para>

      <para>Plus g&eacute;n&eacute;ralement, un utilisateur dispose
	d'une machine connect&eacute; sur la c&acirc;ble ou une ligne
	ADSL avec une adresse IP et d&eacute;sire utiliser cet
	ordinateur connect&eacute; pour fournir un acc&egrave;s
	Internet &agrave; d'autres machines du r&eacute;seau
	local.</para>

      <para>Pour cela, la machine &os; sur Internet doit jouer le
	r&ocirc;le de passerelle.  Cette machine passerelle doit avoir
	deux cartes r&eacute;seaux&mdash;l'une pour se connecter au
	routeur Internet, l'autre est connect&eacute;e au
	r&eacute;seau local.  Toutes les machines du r&eacute;seau
	local sont connect&eacute;es par l'interm&eacute;diaire d'un
	hub ou d'un switch.</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="advanced-networking/natd">
	</imageobject>

	<textobject>
	  <literallayout class="monospaced">  _______       __________       _________
 |       |     |          |     |         |
 |  Hub  |-----| Client B |-----| Routeur |----- Internet
 |_______|     |__________|     |_________|
     |
 ____|_____
|          |
| Client A |
|__________|</literallayout>
	</textobject>

	<textobject>
	  <phrase>Organisation du r&eacute;seau</phrase>
	</textobject>
      </mediaobject>

      <para>Une telle configuration est commun&eacute;ment
	utilis&eacute;e pour partager une connexion Internet.  Une des
	machines du r&eacute;seau local est connect&eacute;e &agrave;
	Internet.  Le reste des machines acc&egrave;de &agrave;
	Internet par l'interm&eacute;diaire de cette machine
	&ldquo;passerelle&rdquo;.</para>
    </sect2>

    <sect2 id="network-natdkernconfiguration">
      <indexterm>
	<primary>noyau</primary>
	<secondary>configuration</secondary>
      </indexterm>
      <title>Configuration</title>

      <para>Les options suivantes doivent &ecirc;tre pr&eacute;sentes
	dans le fichier de configuration du noyau:</para>

      <programlisting>options IPFIREWALL
options IPDIVERT</programlisting>

      <para>De plus, les options suivantes peuvent &eacute;galement
	&ecirc;tre utiles:</para>

      <programlisting>options IPFIREWALL_DEFAULT_TO_ACCEPT
options IPFIREWALL_VERBOSE</programlisting>

      <para>Ce qui suit doit figurer dans le fichier
	<filename>/etc/rc.conf</filename>:</para>

      <programlisting>gateway_enable="YES"
firewall_enable="YES"
firewall_type="OPEN"
natd_enable="YES"
natd_interface="<replaceable>fxp0</replaceable>"
natd_flags=""</programlisting>

      <informaltable frame="none">
        <tgroup cols="2">
	  <tbody>
	    <row>
	      <entry>gateway_enable="YES"</entry>
	      <entry>Configure la machine comme passerelle.
		Ex&eacute;cuter
		<command>sysctl net.inet.ip.forwarding=1</command>
		aurait le m&ecirc;me effet.</entry>
	    </row>
	    <row><entry>firewall_enable="YES"</entry>
	      <entry>Active les r&egrave;gles du coupe-feu se
		trouvant dans le fichier
		<filename>/etc/rc.firewall</filename> au
		d&eacute;marrage.</entry>
	    </row>
	    <row><entry>firewall_type="OPEN"</entry>
	      <entry>Cela sp&eacute;cifie un ensemble de r&egrave;gles
		pr&eacute;d&eacute;finies pour le coupe-feu qui autorise
		tous les paquets entrant.  Consultez le fichier
		<filename>/etc/rc.firewall</filename> pour d'autres
		ensembles de r&eacute;gles.</entry>
	    </row>
	    <row>
	      <entry>natd_interface="fxp0"</entry>
	      <entry>Indique &agrave; travers quelle interface
		transf&eacute;rer les paquets (l'interface
		connect&eacute;e &agrave; l'Internet).</entry>
	    </row>
	    <row>
	      <entry>natd_flags=""</entry>
	      <entry>Toutes options de configuration
		suppl&eacute;mentaires pass&eacute;es &agrave;
		&man.natd.8; au d&eacute;marrage.</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>

      <para>Le fait d'avoir les options pr&eacute;c&eacute;dentes
	d&eacute;finies dans le fichier
	<filename>/etc/rc.conf</filename> lancera la commande
	<filename>/etc/rc.conf</filename> au d&eacute;marrage.  Cette
	commande peut &ecirc;tre &eacute;galement
	ex&eacute;cut&eacute;e &agrave; la main.</para>

      <note>
	<para>Il est &eacute;galement possible d'utiliser un fichier
	  de configuration pour &man.natd.8; quand il y a trop d'options
	  &agrave; passer.  Dans ce cas, le fichier de configuration
	  doit &ecirc;tre d&eacute;fini en ajoutant la ligne suivante au
	  fichier <filename>/etc/rc.conf</filename>:</para>

	<programlisting>natd_flags="-f /etc/natd.conf"</programlisting>

	<para>Le fichier <filename>/etc/natd.conf</filename>
	  contiendra une liste d'options de configuration, une par
	  ligne.  Par exemple le cas de figure de la section suivante
	  utiliserait le fichier suivant:</para>

	<programlisting>redirect_port tcp 192.168.0.2:6667 6667
redirect_port tcp 192.168.0.3:80 80</programlisting>

	<para>Pour plus d'information concernant le fichier de
	  configuration, consultez la page de manuel de &man.natd.8;
	  au sujet de l'option <option>-f</option>.</para>
      </note>

      <para>A chaque machine et interface derri&egrave;re le
	r&eacute;seau local doit &ecirc;tre assign&eacute; une adresse
	IP de l'espace d'adresses priv&eacute;es comme d&eacute;fini
	par la <ulink url="ftp://ftp.isi.edu/in-notes/rfc1918.txt">RFC
	1918</ulink> et doit disposer d'une passerelle par
	d&eacute;faut qui est l'adresse IP interne de la machine
	&man.natd.8;.</para>

      <para>Par exemple, les clients <hostid>A</hostid> et
	<hostid>B</hostid> du r&eacute;seau local ont les adresses IP
	<hostid role="ipaddr">192.168.0.2</hostid> et <hostid
	role="ipaddr">192.168.0.3</hostid>, tandis que l'interface sur
	le r&eacute;seau local de la machine
	<application>natd</application> a pour adresse IP <hostid
	role="ipaddr">192.168.0.1</hostid>.  La passerelle par
	d&eacute;faut des clients <hostid>A</hostid> et
	<hostid>B</hostid> doit &ecirc;tre l'adresse <hostid
	role="ipaddr">192.168.0.1</hostid> de la machine
	<application>natd</application>.  L'interface externe ou
	Internet de cette derni&egrave;re ne demande aucune
	modification sp&eacute;cifique pour que &man.natd.8; puisse
	fonctionner.</para>
    </sect2>

    <sect2 id="network-natdport-redirection">
      <title>Redirection de ports</title>

      <para>L'inconv&eacute;nient avec &man.natd.8; est que les
	clients du r&eacute;seau local ne sont pas accessibles depuis
	l'Internet.  Les clients sur le r&eacute;seau local peuvent
	&eacute;tablir des connexions sortantes vers le monde
	ext&eacute;rieur mais ne peuvent recevoir de connexions
	entrantes.  Cela pr&eacute;sente un probl&egrave;me si l'on
	tente de faire tourner des services Internet sur une des
	machines du r&eacute;seau local.  Une solution simple &agrave;
	ce probl&egrave;me est de rediriger les ports Internet
	s&eacute;lectionn&eacute;s de la machine
	<application>natd</application> vers le client sur le
	r&eacute;seau local.</para>

      <para>Par exemple, un serveur IRC tourne sur le client
	<hostid>A</hostid>, et un serveur web sur le client
	<hostid>B</hostid>.  Pour que cela fonctionne correctement,
	les connections re&ccedil;ues sur les ports 6667 (IRC) et 80
	(web) doivent &ecirc;tre redirig&eacute;es vers les machines
	correspondantes.</para>

      <para>L'option <option>-redirect_port</option> doit &ecirc;tre
	pass&eacute;e &agrave; &man.natd.8; avec les autres options
	ad&eacute;quates.  La syntaxe est la suivante:</para>

      <programlisting>-redirect_port proto targetIP:targetPORT[-targetPORT]
                 [aliasIP:]aliasPORT[-aliasPORT]
                 [remoteIP[:remotePORT[-remotePORT]]]</programlisting>

      <para>Dans l'exemple pr&eacute;c&eacute;dent, l'argument
	pass&eacute; &agrave; la commande devrait &ecirc;tre:</para>

      <programlisting>-redirect_port tcp 192.168.0.2:6667 6667
-redirect_port tcp 192.168.0.3:80 80</programlisting>

      <para>Cela va rediriger les ports <emphasis>tcp</emphasis>
	voulus vers les machines du r&eacute;seau local.</para>

      <para>L'option <option>-redirect_port</option> peut &ecirc;tre
	utilis&eacute;e pour indiquer une plage de ports plut&ocirc;t
	que des ports individuels.  Par exemple <replaceable>tcp
	192.168.0.2:2000-3000 2000-3000</replaceable> redirigerait
	toutes les connexions re&ccedil;ues sur les ports 2000
	&agrave; 3000 vers les ports 2000 &agrave; 3000 du client
	<hostid>A</hostid>.</para>

      <para>Ces options peuvent &ecirc;tre utilis&eacute;es quand on
	ex&eacute;cute directement &man.natd.8;, plac&eacute;es dans
	l'option <literal>natd_flags=""</literal> du fichier
	<filename>/etc/rc.conf</filename>, ou pass&eacute;es
	par l'interm&eacute;diaire d'un fichier de configuration.</para>

      <para>Pour plus d'&eacute;l&eacute;ments et d'options de
	configuration consultez la page de manuel &man.natd.8;</para>
    </sect2>

    <sect2 id="network-natdaddress-redirection">
      <title>Redirection d'adresses</title>
      <indexterm><primary>redirection d'adresses</primary></indexterm>

      <para>La redirection d'adresses est utile si plusieurs adresses
	IP sont disponibles mais doivent se trouver sur une seule
	machine.  Avec cela, &man.natd.8; peut assigner &agrave;
	chaque client du r&eacute;seau local sa propre adresse IP
	externe.  Le programme &man.natd.8; r&eacute;crit alors les
	paquets sortant des clients du r&eacute;seau local avec
	l'adresse IP externe correcte et redirige tout le trafic
	entrant sur une adresse IP particuli&egrave;re vers la machine
	du r&eacute;seau local correspondante.  Ce principe est
	&eacute;galement connu sous le nom de translation d'adresses
	statique.  Par exemple, les adresses IP <hostid
	role="ipaddr">128.1.1.1</hostid>, <hostid
	role="ipaddr">128.1.1.2</hostid>, et <hostid
	role="ipaddr">128.1.1.3</hostid> appartiennent &agrave; la
	passerelle <application>natd</application>.  L'adresse <hostid
	role="ipaddr">128.1.1.1</hostid> peut &ecirc;tre
	utilis&eacute;e comme adresse IP externe de la passerelle
	<application>natd</application>, tandis que <hostid
	role="ipaddr">128.1.1.2</hostid> et <hostid
	role="ipaddr">128.1.1.3</hostid> sont redirig&eacute;es vers
	les machines <hostid>A</hostid> et <hostid>B</hostid> du
	r&eacute;seau local.</para>

      <para>La syntaxe de l'option <option>-redirect_address</option>
	est la suivante:</para>

      <programlisting>-redirect_address localIP publicIP</programlisting>

      <informaltable frame="none">
	<tgroup cols="2">
	  <tbody>
	    <row>
	      <entry>localIP</entry>
	      <entry>L'adresse IP interne du client sur le
		r&eacute;seau local.</entry>
	    </row>
	    <row>
	      <entry>publicIP</entry>
	      <entry>L'adresse IP externe correspondant au client sur
		le r&eacute;seau local.</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>

      <para>Dans l'exemple, les arguments pass&eacute;s &agrave; la
	commande seraient:</para>

      <programlisting>-redirect_address 192.168.0.2 128.1.1.2
-redirect_address 192.168.0.3 128.1.1.3</programlisting>

      <para>Comme pour l'option <option>-redirect_port</option>, ces
	options peuvent &ecirc;tre plac&eacute;es dans l'option
	<literal>natd_flags=""</literal> du fichier
	<filename>/etc/rc.conf</filename>, ou pass&eacute;es par l'interm&eacute;diaire d'un fichier de configuration.  Avec la redirection
	d'adresse, il n'y a pas besoin de redirection de ports puisque
	toutes les donn&eacute;es re&ccedil;ues sur une IP
	particuli&egrave;re sont redirig&eacute;es.</para>

      <para>Les adresses IP sur la machine
	<application>natd</application> doivent &ecirc;tre active et
	pointer sur l'interface externe.  Consultez la page de manuel
	&man.rc.conf.5; pour cela.</para>
    </sect2>
  </sect1>

  <sect1 id="network-inetd">
    <title>inetd <quote>Super-Server</quote> ** Traduction en Cours **</title>

    <sect2 id="network-inetd-overview">
      <title>Overview</title>
      <para></para>
    </sect2>

    <sect2 id="inetd-settings">
      <title>Settings</title>
      <para></para>
    </sect2>

    <sect2 id="inetd-cmdline">
      <title>Command-Line Options</title>
      <para></para>
    </sect2>

    <sect2 id="inetd-conf">
      <title><filename>inetd.conf</filename></title>
      <para></para>
    </sect2>

    <sect2 id="inetd-security">
      <title>Security</title>
      <para></para>
    </sect2>

    <sect2 id="inetd-misc">
      <title>Miscellaneous</title>
      <para></para>
    </sect2>
  </sect1>

  <sect1 id="network-plip">
    <title>IP sur liaison parall&egrave;le (PLIP)</title>

    <indexterm><primary>PLIP</primary></indexterm>
    <indexterm><primary>IP sur liaison parall&egrave;le</primary></indexterm>

    <para>PLIP nous permet d'utiliser le protocole TCP/IP entre ports
      parall&egrave;les.  C'est utile sur des machines sans cartes
      r&eacute;seaux, ou pour effectuer une installation sur
      ordinateur portable.  Dans cette section nous aborderons:</para>

    <itemizedlist>
      <listitem>
	<para>La fabrication d'un c&acirc;ble parall&egrave;le
	  (&ldquo;laplink&rdquo;).</para>
      </listitem>

      <listitem>
	<para>La connexion de deux ordinateurs via PLIP.</para>
      </listitem>
    </itemizedlist>

    <sect2 id="network-create-parallel-cable">
      <title>Fabriquer un c&acirc;ble parall&egrave;le</title>

      <para>Vous pouvez acheter un c&acirc;ble parall&egrave;le
	aupr&egrave;s de la plupart des vendeurs de mat&eacute;riel
	informatique.  Si ce n'est pas le cas, ou d&eacute;sirez
	savoir comment est fait un tel c&acirc;ble, le tableau suivant
	montre comment en faire un &agrave; partir d'un c&acirc;ble
	parall&egrave;le d'imprimante.</para>

      <table>
	<title>C&acirc;blage d'un c&acirc;ble parall&egrave;le pour
	  r&eacute;seau</title>

	<tgroup cols="5">
	  <thead>
	    <row>
	      <entry>A-name</entry>

	      <entry>A-End</entry>

	      <entry>B-End</entry>

	      <entry>Descr.</entry>

	      <entry>Post/Bit</entry>
	    </row>
	  </thead>

	  <tbody>
	    <row>
	      <entry><literallayout>DATA0
-ERROR</literallayout></entry>

	      <entry><literallayout>2
15</literallayout></entry>

	      <entry><literallayout>15
2</literallayout></entry>

	      <entry>Data</entry>

	      <entry><literallayout>0/0x01
1/0x08</literallayout></entry>
	    </row>

	    <row>
	      <entry><literallayout>DATA1
+SLCT</literallayout></entry>

	      <entry><literallayout>3
13</literallayout></entry>

	      <entry><literallayout>13
3</literallayout></entry>

	      <entry>Data</entry>

	      <entry><literallayout>0/0x02
1/0x10</literallayout></entry>
	    </row>

	    <row>
	      <entry><literallayout>DATA2
+PE</literallayout></entry>

	      <entry><literallayout>4
12</literallayout></entry>

	      <entry><literallayout>12
4</literallayout></entry>

	      <entry>Data</entry>

	      <entry><literallayout>0/0x04
1/0x20</literallayout></entry>
	    </row>

	    <row>
	      <entry><literallayout>DATA3
-ACK</literallayout></entry>

	      <entry><literallayout>5
10</literallayout></entry>

	      <entry><literallayout>10
5</literallayout></entry>

	      <entry>Strobe</entry>

	      <entry><literallayout>0/0x08
1/0x40</literallayout></entry>
	    </row>

	    <row>
	      <entry><literallayout>DATA4
BUSY</literallayout></entry>

	      <entry><literallayout>6
11</literallayout></entry>

	      <entry><literallayout>11
6</literallayout></entry>

	      <entry>Data</entry>

	      <entry><literallayout>0/0x10
1/0x80</literallayout></entry>
	    </row>

	    <row>
	      <entry>GND</entry>

	      <entry>18-25</entry>

	      <entry>18-25</entry>

	      <entry>GND</entry>

	      <entry>-</entry>
	    </row>
	  </tbody>
	</tgroup>
      </table>
    </sect2>

    <sect2 id="network-plip-setup">
      <title>Configurer PLIP</title>

      <para>Tout d'abord procurez-vous un c&acirc;ble
	&ldquo;laplink&rdquo;.  V&eacute;rifiez ensuite que les deux
	ordinateurs disposent d'un noyau avec le support pour le
	pilote de p&eacute;riph&eacute;rique &man.lpt.4;.</para>

      <screen>&prompt.root; <userinput>grep lp /var/run/dmesg.boot</userinput>
lpt0: &lt;Printer&gt; on ppbus0
lpt0: Interrupt-driven port</screen>

      <para>Le port parall&egrave;le doit fonctionner sous interruption,
	sous &os;&nbsp;4.X vous devriez avoir une ligne semblable
	&agrave; la ligne suivante dans le fichier de configuration du
	noyau:</para>

      <programlisting>device ppc0 at isa? irq 7</programlisting>

      <para>Sous &os;&nbsp;5.X, le fichier
	<filename>/boot/device.hints</filename> devrait contenir les
	lignes suivantes:</para>

      <programlisting>hint.ppc.0.at="isa"
hint.ppc.0.irq="7"</programlisting>

      <para>Ensuite v&eacute;rifiez si le fichier de configuration du
	noyau contient une ligne <literal>device plip</literal>
	ou si le module <filename>plip.ko</filename> est charg&eacute;.
	Dans les deux cas l'interface r&eacute;seau parall&egrave;le
	devrait appara&icirc;tre quand vous utilisez directement la
	commande &man.ifconfig.8;.  Sous &os;&nbsp;4.X de cette
	mani&egrave;re:</para>

      <screen>&prompt.root; <userinput>ifconfig lp0</userinput>
lp0: flags=8810&lt;POINTOPOINT,SIMPLEX,MULTICAST&gt; mtu 1500</screen>

      <para>et sous &os;&nbsp;5.X:</para>

      <screen>&prompt.root; <userinput>ifconfig plip0</userinput>
plip0: flags=8810&lt;POINTOPOINT,SIMPLEX,MULTICAST&gt; mtu 1500</screen>

      <note><para>Le nom de p&eacute;riph&eacute;rique utilis&eacute;
	pour l'interface parall&egrave;le est diff&eacute;rent entre
	&os;&nbsp;4.X
	(<devicename>lp<replaceable>X</replaceable></devicename>)
	et &os;&nbsp;5.X
	(<devicename>plip<replaceable>X</replaceable></devicename>).</para></note>

      <para>Branchez le c&acirc;ble &ldquo;laplink&rdquo; sur les
	interfaces parall&egrave;les des deux ordinateurs.</para>

      <para>Configurez les param&egrave;tres de l'interface
	r&eacute;seau des deux c&ocirc;t&eacute;s en tant que
	<username>root</username>.  Par exemple, si vous voulez
	connecter la machine <hostid>host1</hostid> fonctionnant sous
	&os;&nbsp;4.X avec la machine <hostid>host2</hostid> tournant
	sous &os;&nbsp;5.X:</para>

      <programlisting>                 host1 &lt;-----&gt; host2
IP Address    10.0.0.1      10.0.0.2</programlisting>

      <para>Configurez l'interface sur <hostid>host1</hostid> en tapant:</para>

      <screen>&prompt.root; <userinput>ifconfig lp0 10.0.0.1 10.0.0.2</userinput></screen>

      <para>Configurez l'interface sur <hostid>host2</hostid> en tapant:</para>

      <screen>&prompt.root; <userinput>ifconfig plip0 10.0.0.2 10.0.0.1</userinput></screen>

      <para>Vous devriez avoir maintenant une connexion qui
	fonctionne.  Veuillez consulter les pages de manuel &man.lp.4;
	et &man.lpt.4; pour plus de d&eacute;tails.</para>

      <para>Vous devriez &eacute;galement ajouter les deux noms de
	machines dans le fichier
	<filename>/etc/hosts</filename>:</para>

      <programlisting>127.0.0.1               localhost.my.domain localhost
10.0.0.1                host1.my.domain host1
10.0.0.2                host2.my.domain</programlisting>

      <para>Pour v&eacute;rifier le bon fonctionnement de la connexion,
	aller sur les deux machines et effectuez un &ldquo;ping&rdquo;
	vers l'autre machine.  Par exemple, sur
	<hostid>host1</hostid>:</para>

      <screen>&prompt.root; <userinput>ifconfig lp0</userinput>
lp0: flags=8851&lt;UP,POINTOPOINT,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        inet 10.0.0.1 --&gt; 10.0.0.2 netmask 0xff000000
&prompt.root; <userinput>netstat -r</userinput>
Routing tables

Internet:
Destination        Gateway          Flags     Refs     Use      Netif Expire
host2              host1              UH          0       0       lp0
&prompt.root; <userinput>ping -c 4 host2</userinput>
PING host2 (10.0.0.2): 56 data bytes
64 bytes from 10.0.0.2: icmp_seq=0 ttl=255 time=2.774 ms
64 bytes from 10.0.0.2: icmp_seq=1 ttl=255 time=2.530 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=255 time=2.556 ms
64 bytes from 10.0.0.2: icmp_seq=3 ttl=255 time=2.714 ms

--- host2 ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev = 2.530/2.643/2.774/0.103 ms</screen>
    </sect2>
  </sect1>

  <sect1 id="network-ipv6">
    <title>IPv6 ** Traduction en Cours **</title>
    <para></para>
  </sect1>
</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
<!--  LocalWords:  config mnt www -->
