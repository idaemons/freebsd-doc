<!-- $Id: kernelconfig.sgml,v 1.2 1999-03-21 16:19:18 wosch Exp $ -->
<!-- The FreeBSD Russian Documentation Project -->

  <sect>
    <heading>Конфигурирование ядра<label id="kernelconfig"></heading>

    <sect1>
      <heading>
        Я хочу изменить настройки ядра. Это сложно?<label id="make-kernel">
      </heading>

      <p>Вовсе нет! Обратитесь к <url url="../../handbook/kernelconfig.html"
      name="соответствующему разделу"> Руководства, который посвящён этому
      вопросу.

      <p><bf/ЗАМЕЧАНИЕ:/ Рекомендуем сохранить копию вашего ядра в
      файл <tt/kernel.YYMMDD/ после того, как вы получите рабочую версию,
      для того, чтобы в следующий раз, если вы испортите что-либо в
      вашем конфигурационном файле, вы смогли загрузить это ядро, вместо того,
      чтобы начинать снова с <tt/kernel.GENERIC/.  Это, в частности, имеет
      смысл, если вы производите загрузку системы с контроллера, который
      не поддерживается в стандартном ядре GENERIC (из моего личного
      опыта).

    <sect1>
      <heading>
        Я не могу скомпилировать ядро. Отсутствует
        <tt/&lowbar;hw&lowbar;float/.
      </heading>

      <p>Позвольте мне угадать.  Вы, наверное, удалили <htmlurl 
      url="http://www.freebsd.org/cgi/man.cgi?npx(4)" name="npx0"> из вашего
      файла конфигурации ядра, потому что у вас нет сопроцессора, да?
      Неправильно! :-)   Строка <tt/npx0/ <bf/ОБЯЗАТЕЛЬНА/.  Даже если у
      вас нет математического сопроцессора, вы <bf/должны/ включить
      поддержку <tt/npx0/.

    <sect1>
      <heading>
        Конфликты прерываний при включении поддержки многопортовыx
        коммуникационных адаптеров.
      </heading>

      <p><bf/Q./ Когда я компилирую ядро с поддержкой многопортовых
      коммуникационных адаптеров, сообщается, что только первый порт будет
      тестироваться, а все остальные пропускаются из-за конфликтов
      прерываний.  Как это исправить?

      <p><bf/A./ Проблема состоит в том, что во FreeBSD встроен код,
      предохраняющий ядро от аппаратных и программных конфликтов. Вам нужно
      убрать указания IRQ на всех портах, кроме одного. Например:

      <verb>
        #
        # Высокоскоростной коммуникационный адаптер - 16550 UARTS
        #
        device sio2 at isa? port 0x2a0 tty irq 5 flags 0x501 vector siointr
        device sio3 at isa? port 0x2a8 tty flags 0x501 vector siointr
        device sio4 at isa? port 0x2b0 tty flags 0x501 vector siointr
        device sio5 at isa? port 0x2b8 tty flags 0x501 vector siointr
      </verb>

    <sect1>
      <heading>Как включить поддержку накопителей QIC-40/80?</heading>

      <p>Раскомментируйте следующую строку в файле конфигурации стандартного
      ядра (или добавьте ее в конфигурационный файл вашего ядра), добавьте
      ``<tt/flags 0x1/'' к строке, содержащей
      <htmlurl url="http://www.freebsd.org/cgi/man.cgi?fdc(4)"
      name="fdc"> и перекомпилируйте ядро.

      <verb>
controller  fdc0  at isa? port "IO_FD1" bio irq 6 drq 2 flags 0x1 vector fdintr
disk        fd0   at fdc0 drive 0                       ^^^^^^^^^
disk        fd1   at fdc0 drive 1
#tape       ft0   at fdc0 drive 2
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      </verb>

      <p>Затем создайте устройство с именем <tt>/dev/ft0</tt>, перейдя в
      каталог <tt>/dev</tt> и запустив команду

      <verb>
        sh ./MAKEDEV ft0
      </verb>

      <p>для первого устройства, <tt/ft1/ для второго и так далее.

      <p>У вас появится устройство с именем <tt>/dev/ft0</tt>, на которое
      вы можете производить запись с помощью специальной программы управления,
      называющейся ``<tt/ft/'' - за дополнительной информацией обратитесь к
      странице справочника по <htmlurl 
      url="http://www.freebsd.org/cgi/man.cgi?ft" name="ft">.

      <p>Версии операционной системы, предшествующие <tt/-current/,
      имеют огрехи, связанные с качеством носителя. Если у вас появились
      проблема, когда <tt/ft/ прокручивает ленту туда-сюда на одном и том
      же месте, попробуйте взять последнюю версию программы <tt/ft/ с
      <tt>/usr/src/sbin/ft</tt> из <tt/-current/ и попробовать её.

  </sect>

